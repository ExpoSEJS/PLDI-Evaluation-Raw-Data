{"8":[9,13,9,22],"9":[1,20,1,27],"10":[7,28,7,46],"16":[7,28,7,46],"17":[1,28,1,32],"18":[7,48,7,51],"24":[19,9,19,15],"25":[1,20,1,33],"32":[28,25,28,50],"33":[1,20,1,33],"34":[7,48,7,51],"40":[28,25,28,85],"41":[1,20,1,33],"42":[10,21,10,24],"48":[28,25,28,85],"49":[2,26,2,38],"56":[31,13,31,29],"57":[2,26,2,45],"58":[10,21,10,24],"64":[22,9,22,17],"65":[2,26,2,45],"66":[19,9,19,15],"72":[53,22,53,64],"73":[2,26,2,45],"74":[21,53,21,62],"80":[53,22,53,87],"81":[3,1,3,7],"82":[21,53,21,68],"88":[53,13,53,92],"89":[3,18,3,37],"90":[21,53,21,78],"96":[53,13,53,92],"97":[3,1,3,37],"98":[28,34,28,50],"104":[51,21,51,40],"105":[3,1,3,38],"106":[28,60,28,76],"112":[62,9,62,11],"113":[4,1,4,20],"114":[28,54,28,85],"120":[67,16,67,32],"121":[4,43,4,62],"122":[28,104,28,120],"128":[65,9,65,56],"129":[4,1,4,62],"130":[31,13,31,29],"136":[72,16,72,35],"137":[4,1,4,63],"138":[33,13,33,28],"144":[70,9,70,62],"145":[6,19,6,34],"146":[47,12,47,14],"152":[78,50,78,70],"153":[6,35,6,41],"154":[51,21,51,40],"160":[78,90,78,107],"161":[6,19,6,42],"162":[51,42,51,45],"168":[78,24,78,122],"169":[6,19,6,42],"176":[77,13,79,15],"177":[6,19,6,42],"178":[51,42,51,45],"184":[76,9,76,24],"185":[7,18,7,19],"186":[53,22,53,41],"192":[93,62,93,74],"193":[7,25,7,26],"194":[53,45,53,64],"200":[93,31,93,51],"201":[7,18,7,19],"202":[53,68,53,87],"208":[94,9,94,18],"209":[7,18,7,19],"210":[53,21,53,92],"216":[107,12,107,34],"217":[7,25,7,26],"218":[62,9,62,11],"224":[107,12,107,47],"225":[7,25,7,26],"226":[65,9,65,56],"232":[107,12,107,60],"233":[7,28,7,29],"234":[66,14,66,15],"240":[107,12,107,65],"241":[7,32,7,39],"242":[67,16,67,32],"248":[115,12,115,55],"249":[7,32,7,46],"250":[70,9,70,62],"256":[124,13,124,44],"258":[71,14,71,15],"264":[123,28,123,46],"265":[7,48,7,49],"266":[72,16,72,35],"273":[7,48,7,51],"274":[76,9,76,24],"282":[78,24,78,45],"289":[8,25,8,39],"290":[78,49,78,122],"297":[8,40,8,47],"298":[80,18,80,19],"305":[8,48,8,49],"306":[93,31,93,51],"313":[8,40,8,50],"314":[94,9,94,18],"321":[8,40,8,57],"322":[107,12,107,21],"323":[8,40,8,55],"329":[8,59,8,60],"330":[107,25,107,34],"337":[8,25,8,61],"338":[107,38,107,47],"345":[8,25,8,61],"346":[107,51,107,60],"353":[8,25,8,61],"354":[110,12,110,22],"361":[9,13,9,22],"362":[115,53,115,55],"369":[10,13,10,20],"370":[115,12,115,55],"378":[116,9,116,16],"385":[10,21,10,22],"393":[10,21,10,24],"394":[116,9,116,16],"402":[117,9,117,16],"409":[10,28,10,37],"417":[10,13,10,37],"418":[117,9,117,16],"425":[10,13,10,38],"426":[123,28,123,46],"433":[13,5,13,12],"434":[123,48,123,51],"441":[13,22,13,23],"449":[13,5,13,23],"450":[123,48,123,51],"457":[13,5,13,24],"458":[124,13,124,39],"465":[14,12,14,19],"466":[124,13,124,44],"473":[14,12,14,19],"474":[125,21,125,24],"481":[14,5,14,20],"489":[5,1,15,2],"490":[127,27,127,43],"497":[5,1,15,2],"498":[130,22,130,27],"505":[5,1,15,2],"513":[5,1,15,2],"521":[5,1,15,2],"529":[5,1,15,2],"537":[5,1,15,2],"545":[18,17,18,18],"553":[18,25,18,60],"561":[18,17,18,61],"563":[18,17,18,24],"569":[18,17,18,61],"577":[18,17,18,61],"585":[19,10,19,15],"593":[20,16,20,20],"601":[20,16,20,20],"609":[20,9,20,21],"617":[21,16,21,21],"625":[21,22,21,23],"633":[21,16,21,24],"641":[21,36,21,41],"649":[21,42,21,43],"657":[21,36,21,44],"665":[21,53,21,55],"673":[21,58,21,62],"681":[21,65,21,68],"689":[21,71,21,78],"697":[21,89,21,91],"705":[21,97,21,98],"713":[21,16,21,24],"721":[21,16,21,24],"729":[21,36,21,44],"737":[21,36,21,44],"745":[21,53,21,78],"753":[21,53,21,78],"761":[21,89,21,91],"769":[21,89,21,91],"777":[21,97,21,98],"785":[21,97,21,98],"793":[22,9,22,14],"801":[22,15,22,16],"809":[22,9,22,17],"817":[23,18,23,23],"825":[23,24,23,25],"833":[23,18,23,26],"841":[23,33,23,36],"849":[23,18,23,37],"851":[23,18,23,32],"857":[24,20,24,21],"865":[24,20,24,28],"867":[24,20,24,26],"873":[24,35,24,38],"881":[24,20,24,39],"883":[24,20,24,34],"889":[24,20,24,39],"897":[24,13,24,40],"905":[23,42,25,10],"913":[23,42,25,10],"921":[23,42,25,10],"929":[23,42,25,10],"937":[23,18,25,11],"939":[23,18,23,41],"945":[26,24,26,25],"953":[26,26,26,27],"961":[26,24,26,28],"969":[26,24,26,42],"971":[26,24,26,40],"977":[26,24,26,42],"985":[26,24,26,42],"993":[27,25,27,26],"1001":[27,27,27,28],"1009":[27,25,27,29],"1017":[27,25,27,29],"1025":[27,25,27,29],"1033":[28,13,28,16],"1041":[28,17,28,21],"1049":[28,25,28,30],"1057":[28,34,28,39],"1065":[28,40,28,41],"1073":[28,34,28,42],"1081":[28,47,28,50],"1089":[28,54,28,59],"1097":[28,60,28,65],"1105":[28,60,28,72],"1113":[28,75,28,76],"1121":[28,54,28,77],"1129":[28,82,28,85],"1137":[28,88,28,93],"1145":[28,101,28,102],"1153":[28,104,28,109],"1161":[28,104,28,116],"1169":[28,119,28,120],"1177":[28,88,28,121],"1179":[28,88,28,100],"1185":[28,124,28,129],"1193":[28,13,28,129],"1201":[28,13,28,130],"1209":[29,20,29,23],"1217":[29,20,29,23],"1225":[29,13,29,24],"1233":[25,19,30,10],"1241":[25,19,30,10],"1249":[25,19,30,10],"1257":[25,19,30,10],"1265":[25,19,30,10],"1273":[25,19,30,10],"1281":[25,19,30,10],"1289":[30,12,30,18],"1297":[23,18,30,19],"1299":[23,18,25,18],"1305":[23,18,30,19],"1313":[23,9,30,20],"1321":[31,13,31,19],"1329":[31,13,31,21],"1337":[31,25,31,29],"1345":[32,17,32,27],"1353":[32,28,32,34],"1361":[32,28,32,36],"1369":[32,17,32,37],"1377":[32,17,32,37],"1385":[32,13,32,38],"1393":[33,20,33,26],"1401":[33,13,33,29],"1409":[37,15,37,19],"1417":[38,18,38,25],"1425":[39,17,39,23],"1433":[40,12,40,13],"1441":[41,12,41,13],"1449":[42,15,42,19],"1457":[36,12,43,6],"1465":[36,12,43,6],"1473":[36,5,43,7],"1481":[17,1,44,2],"1489":[17,1,44,2],"1497":[17,1,44,2],"1505":[17,1,44,2],"1513":[17,1,44,2],"1521":[17,1,44,2],"1529":[17,1,44,2],"1537":[17,1,44,2],"1545":[17,1,44,2],"1553":[17,1,44,2],"1561":[47,13,47,14],"1569":[48,12,48,13],"1577":[49,12,49,13],"1585":[46,20,50,6],"1593":[46,20,50,6],"1601":[46,20,50,6],"1609":[51,18,51,19],"1617":[51,18,51,19],"1625":[51,18,51,19],"1633":[51,21,51,22],"1641":[51,25,51,33],"1649":[51,25,51,40],"1665":[51,42,51,43],"1673":[51,42,51,45],"1689":[52,20,52,27],"1697":[52,28,52,32],"1705":[52,34,52,42],"1713":[52,43,52,44],"1721":[52,34,52,45],"1729":[52,47,52,52],"1737":[52,20,52,53],"1745":[52,20,52,53],"1753":[52,20,52,53],"1761":[53,13,53,17],"1769":[53,22,53,30],"1777":[53,22,53,32],"1785":[53,35,53,39],"1793":[53,35,53,41],"1801":[53,45,53,53],"1809":[53,45,53,55],"1817":[53,58,53,62],"1825":[53,58,53,64],"1833":[53,68,53,76],"1841":[53,68,53,78],"1849":[53,81,53,85],"1857":[53,81,53,87],"1865":[53,91,53,92],"1873":[54,24,54,28],"1881":[54,24,54,28],"1889":[54,13,54,29],"1897":[57,12,57,20],"1905":[57,12,57,20],"1913":[57,5,57,21],"1921":[45,1,58,2],"1929":[45,1,58,2],"1937":[45,1,58,2],"1945":[45,1,58,2],"1953":[45,1,58,2],"1961":[45,1,58,2],"1969":[45,1,58,2],"1977":[45,1,58,2],"1985":[60,13,60,27],"1993":[60,28,60,32],"2001":[60,13,60,33],"2009":[60,13,60,33],"2017":[60,13,60,33],"2025":[61,13,61,14],"2033":[61,13,61,14],"2041":[61,13,61,14],"2049":[62,10,62,11],"2057":[63,16,63,20],"2065":[63,16,63,20],"2073":[63,9,63,21],"2081":[65,9,65,13],"2089":[65,9,65,18],"2097":[65,9,65,32],"2099":[65,9,65,30],"2105":[65,36,65,37],"2113":[65,36,65,42],"2121":[65,36,65,56],"2123":[65,36,65,54],"2129":[66,14,66,15],"2137":[66,9,66,10],"2145":[66,9,66,15],"2153":[66,9,66,16],"2161":[67,16,67,20],"2169":[67,16,67,25],"2177":[67,29,67,32],"2185":[68,16,68,20],"2193":[68,16,68,20],"2201":[68,9,68,21],"2209":[70,9,70,13],"2217":[70,9,70,21],"2225":[70,9,70,35],"2227":[70,9,70,33],"2233":[70,39,70,40],"2241":[70,39,70,48],"2249":[70,39,70,62],"2251":[70,39,70,60],"2257":[71,14,71,15],"2265":[71,9,71,10],"2273":[71,9,71,15],"2281":[71,9,71,16],"2289":[72,16,72,20],"2297":[72,16,72,28],"2305":[72,32,72,35],"2313":[73,16,73,20],"2321":[73,16,73,20],"2329":[73,9,73,21],"2337":[75,16,75,22],"2345":[75,28,75,32],"2353":[75,28,75,39],"2361":[75,16,75,40],"2363":[75,16,75,27],"2369":[75,16,75,40],"2377":[75,16,75,40],"2385":[76,9,76,13],"2393":[76,9,76,20],"2401":[76,23,76,24],"2409":[77,13,77,17],"2417":[78,24,78,28],"2425":[78,24,78,35],"2433":[78,36,78,37],"2441":[78,24,78,38],"2449":[78,42,78,45],"2457":[78,50,78,54],"2465":[78,50,78,61],"2473":[78,62,78,63],"2481":[78,50,78,64],"2489":[78,68,78,70],"2497":[78,49,78,85],"2499":[78,49,78,83],"2505":[78,90,78,91],"2513":[78,90,78,98],"2521":[78,99,78,100],"2529":[78,90,78,101],"2537":[78,105,78,107],"2545":[78,89,78,122],"2547":[78,89,78,120],"2553":[78,24,78,122],"2561":[78,17,78,123],"2569":[77,24,79,14],"2577":[77,24,79,14],"2585":[77,24,79,14],"2593":[77,24,79,14],"2601":[77,13,79,15],"2603":[77,13,77,23],"2609":[80,18,80,19],"2617":[80,13,80,14],"2625":[80,13,80,19],"2633":[80,13,80,20],"2641":[82,20,82,24],"2649":[82,20,82,24],"2657":[82,13,82,25],"2665":[86,12,86,17],"2673":[87,12,87,16],"2681":[87,12,87,18],"2689":[88,12,88,16],"2697":[88,12,88,18],"2705":[89,12,89,13],"2713":[85,12,90,6],"2721":[85,12,90,6],"2729":[85,5,90,7],"2737":[59,1,91,2],"2745":[59,1,91,2],"2753":[59,1,91,2],"2761":[59,1,91,2],"2769":[59,1,91,2],"2777":[59,1,91,2],"2785":[59,1,91,2],"2793":[59,1,91,2],"2801":[93,19,93,30],"2809":[93,31,93,37],"2817":[93,42,93,51],"2825":[93,54,93,59],"2833":[93,62,93,68],"2841":[93,72,93,74],"2849":[93,19,93,75],"2857":[93,19,93,75],"2865":[93,19,93,75],"2873":[94,10,94,18],"2881":[95,16,95,23],"2889":[95,31,95,40],"2897":[95,16,95,41],"2899":[95,16,95,30],"2905":[95,47,95,59],"2913":[95,16,95,60],"2915":[95,16,95,46],"2921":[96,20,96,24],"2929":[96,20,96,29],"2937":[96,20,96,29],"2945":[96,13,96,30],"2953":[95,65,97,10],"2961":[95,65,97,10],"2969":[95,65,97,10],"2977":[95,65,97,10],"2985":[95,65,97,10],"2993":[95,16,97,11],"2995":[95,16,95,64],"3001":[95,16,97,11],"3009":[95,9,97,12],"3017":[99,22,99,30],"3025":[100,16,100,36],"3033":[100,37,100,41],"3041":[100,43,100,50],"3049":[100,52,100,57],"3057":[100,16,100,58],"3065":[100,16,100,58],"3073":[100,9,100,59],"3081":[99,35,101,6],"3089":[99,35,101,6],"3097":[99,35,101,6],"3105":[99,35,101,6],"3113":[99,35,101,6],"3121":[99,35,101,6],"3129":[99,22,101,7],"3131":[99,22,99,34],"3137":[99,22,101,7],"3145":[99,22,101,7],"3153":[102,12,102,22],"3161":[102,30,102,39],"3169":[102,12,102,40],"3171":[102,12,102,29],"3177":[102,46,102,58],"3185":[102,12,102,59],"3187":[102,12,102,45],"3193":[103,16,103,24],"3201":[103,25,103,35],"3209":[103,44,103,52],"3217":[103,25,103,53],"3219":[103,25,103,43],"3225":[103,16,103,54],"3233":[103,16,103,54],"3241":[103,9,103,55],"3249":[102,64,104,6],"3257":[102,64,104,6],"3265":[102,64,104,6],"3273":[102,64,104,6],"3281":[102,64,104,6],"3289":[102,12,104,7],"3291":[102,12,102,63],"3297":[102,12,104,7],"3305":[102,5,104,8],"3313":[92,1,105,2],"3321":[92,1,105,2],"3329":[92,1,105,2],"3337":[92,1,105,2],"3345":[92,1,105,2],"3353":[92,1,105,2],"3361":[107,12,107,13],"3369":[107,12,107,15],"3377":[107,18,107,19],"3385":[107,18,107,21],"3393":[107,25,107,26],"3401":[107,25,107,28],"3409":[107,31,107,32],"3417":[107,31,107,34],"3425":[107,38,107,39],"3433":[107,38,107,41],"3441":[107,44,107,45],"3449":[107,44,107,47],"3457":[107,51,107,52],"3465":[107,51,107,54],"3473":[107,57,107,58],"3481":[107,57,107,60],"3489":[107,64,107,65],"3497":[107,12,107,65],"3505":[107,5,107,66],"3513":[106,1,108,2],"3521":[106,1,108,2],"3529":[106,1,108,2],"3537":[106,1,108,2],"3545":[110,12,110,16],"3553":[110,12,110,18],"3561":[110,21,110,22],"3569":[110,12,110,22],"3577":[110,5,110,23],"3585":[109,1,111,2],"3593":[109,1,111,2],"3601":[109,1,111,2],"3609":[113,17,113,18],"3617":[113,17,113,18],"3625":[113,17,113,18],"3633":[114,17,114,18],"3641":[114,17,114,18],"3649":[114,17,114,18],"3657":[115,21,115,27],"3665":[115,36,115,39],"3673":[115,41,115,46],"3681":[115,21,115,47],"3683":[115,21,115,35],"3689":[115,21,115,47],"3697":[115,54,115,55],"3713":[116,9,116,14],"3721":[116,9,116,16],"3737":[116,9,116,17],"3753":[117,9,117,14],"3761":[117,9,117,16],"3777":[117,9,117,17],"3785":[119,12,119,17],"3793":[119,12,119,17],"3801":[119,5,119,18],"3809":[112,1,120,2],"3817":[112,1,120,2],"3825":[112,1,120,2],"3833":[112,1,120,2],"3841":[112,1,120,2],"3849":[122,19,122,25],"3857":[122,32,122,35],"3865":[122,19,122,36],"3867":[122,19,122,31],"3873":[122,19,122,36],"3881":[122,19,122,36],"3889":[123,18,123,19],"3897":[123,25,123,26],"3905":[123,18,123,19],"3913":[123,18,123,19],"3921":[123,25,123,26],"3929":[123,25,123,26],"3937":[123,28,123,29],"3945":[123,32,123,39],"3953":[123,32,123,46],"3969":[123,48,123,49],"3977":[123,48,123,51],"3993":[124,13,124,23],"4001":[124,24,124,31],"4009":[124,32,124,33],"4017":[124,24,124,34],"4025":[124,13,124,35],"4033":[124,38,124,39],"4041":[124,43,124,44],"4049":[125,13,125,20],"4065":[125,23,125,24],"4073":[125,21,125,24],"4081":[125,28,125,35],"4089":[125,36,125,37],"4097":[125,28,125,38],"4105":[125,13,125,38],"4113":[125,13,125,39],"4121":[127,13,127,20],"4129":[127,21,127,22],"4137":[127,27,127,30],"4145":[127,33,127,40],"4153":[127,41,127,42],"4161":[127,33,127,43],"4169":[127,13,127,43],"4171":[127,13,127,43],"4177":[127,13,127,44],"4185":[130,5,130,12],"4193":[130,22,130,23],"4201":[130,26,130,27],"4209":[130,5,130,27],"4217":[130,5,130,28],"4225":[131,12,131,19],"4233":[131,12,131,19],"4241":[131,5,131,20],"4249":[121,1,132,2],"4257":[121,1,132,2],"4265":[121,1,132,2],"4273":[121,1,132,2],"4281":[121,1,132,2],"4289":[121,1,132,2],"4297":[1,1,132,2],"4305":[1,1,132,2],"4313":[1,1,132,2],"4321":[5,1,15,2],"4329":[1,1,132,2],"4337":[17,1,44,2],"4345":[1,1,132,2],"4353":[45,1,58,2],"4361":[1,1,132,2],"4369":[59,1,91,2],"4377":[1,1,132,2],"4385":[92,1,105,2],"4393":[1,1,132,2],"4401":[106,1,108,2],"4409":[1,1,132,2],"4417":[109,1,111,2],"4425":[1,1,132,2],"4433":[112,1,120,2],"4441":[1,1,132,2],"4449":[121,1,132,2],"4457":[1,1,132,2],"4465":[9,9,11,10],"4473":[7,5,12,6],"4481":[7,5,12,6],"4489":[5,1,15,2],"4497":[5,1,15,2],"4505":[19,5,20,21],"4513":[23,42,25,10],"4521":[23,42,25,10],"4529":[28,25,28,129],"4537":[25,19,30,10],"4545":[25,19,30,10],"4553":[31,9,34,10],"4561":[22,5,35,6],"4569":[17,1,44,2],"4577":[17,1,44,2],"4585":[53,9,55,10],"4593":[51,5,56,6],"4601":[51,5,56,6],"4609":[45,1,58,2],"4617":[45,1,58,2],"4625":[62,5,64,6],"4633":[67,12,69,6],"4641":[65,5,69,6],"4649":[72,12,74,6],"4657":[70,5,74,6],"4665":[77,24,79,14],"4673":[77,24,79,14],"4681":[77,9,83,10],"4689":[76,5,84,6],"4697":[59,1,91,2],"4705":[59,1,91,2],"4713":[93,31,93,74],"4721":[95,65,97,10],"4729":[95,65,97,10],"4737":[94,5,98,6],"4745":[99,35,101,6],"4753":[99,35,101,6],"4761":[102,64,104,6],"4769":[102,64,104,6],"4777":[92,1,105,2],"4785":[92,1,105,2],"4793":[106,1,108,2],"4801":[106,1,108,2],"4809":[109,1,111,2],"4817":[109,1,111,2],"4825":[115,5,118,6],"4833":[112,1,120,2],"4841":[112,1,120,2],"4849":[124,9,128,10],"4857":[123,5,129,6],"4865":[123,5,129,6],"4873":[121,1,132,2],"4881":[121,1,132,2],"4889":[1,1,132,2],"4897":[1,1,132,2],"nBranches":66,"originalCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/negotiator/lib/mediaType.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/negotiator/lib/mediaType_jalangi_.js","code":"/**\n * negotiator\n * Copyright(c) 2012 Isaac Z. Schlueter\n * Copyright(c) 2014 Federico Romero\n * Copyright(c) 2014-2015 Douglas Christopher Wilson\n * MIT Licensed\n */\n\nmodule.exports = preferredMediaTypes;\npreferredMediaTypes.preferredMediaTypes = preferredMediaTypes;\n\nfunction parseAccept(accept) {\n  var accepts = splitMediaTypes(accept);\n\n  for (var i = 0, j = 0; i < accepts.length; i++) {\n    var mediaType = parseMediaType(accepts[i].trim(), i);\n\n    if (mediaType) {\n      accepts[j++] = mediaType;\n    }\n  }\n\n  // trim accepts\n  accepts.length = j;\n\n  return accepts;\n};\n\nfunction parseMediaType(s, i) {\n  var match = s.match(/\\s*(\\S+?)\\/([^;\\s]+)\\s*(?:;(.*))?/);\n  if (!match) return null;\n\n  var type = match[1],\n      subtype = match[2],\n      full = \"\" + type + \"/\" + subtype,\n      params = {},\n      q = 1;\n\n  if (match[3]) {\n    params = match[3].split(';').map(function(s) {\n      return s.trim().split('=');\n    }).reduce(function (set, p) {\n      var name = p[0].toLowerCase();\n      var value = p[1];\n\n      set[name] = value && value[0] === '\"' && value[value.length - 1] === '\"'\n        ? value.substr(1, value.length - 2)\n        : value;\n\n      return set;\n    }, params);\n\n    if (params.q != null) {\n      q = parseFloat(params.q);\n      delete params.q;\n    }\n  }\n\n  return {\n    type: type,\n    subtype: subtype,\n    params: params,\n    q: q,\n    i: i,\n    full: full\n  };\n}\n\nfunction getMediaTypePriority(type, accepted, index) {\n  var priority = {o: -1, q: 0, s: 0};\n\n  for (var i = 0; i < accepted.length; i++) {\n    var spec = specify(type, accepted[i], index);\n\n    if (spec && (priority.s - spec.s || priority.q - spec.q || priority.o - spec.o) < 0) {\n      priority = spec;\n    }\n  }\n\n  return priority;\n}\n\nfunction specify(type, spec, index) {\n  var p = parseMediaType(type);\n  var s = 0;\n\n  if (!p) {\n    return null;\n  }\n\n  if(spec.type.toLowerCase() == p.type.toLowerCase()) {\n    s |= 4\n  } else if(spec.type != '*') {\n    return null;\n  }\n\n  if(spec.subtype.toLowerCase() == p.subtype.toLowerCase()) {\n    s |= 2\n  } else if(spec.subtype != '*') {\n    return null;\n  }\n\n  var keys = Object.keys(spec.params);\n  if (keys.length > 0) {\n    if (keys.every(function (k) {\n      return spec.params[k] == '*' || (spec.params[k] || '').toLowerCase() == (p.params[k] || '').toLowerCase();\n    })) {\n      s |= 1\n    } else {\n      return null\n    }\n  }\n\n  return {\n    i: index,\n    o: spec.i,\n    q: spec.q,\n    s: s,\n  }\n\n}\n\nfunction preferredMediaTypes(accept, provided) {\n  // RFC 2616 sec 14.2: no header = */*\n  var accepts = parseAccept(accept === undefined ? '*/*' : accept || '');\n\n  if (!provided) {\n    // sorted list of all types\n    return accepts.filter(isQuality).sort(compareSpecs).map(function getType(spec) {\n      return spec.full;\n    });\n  }\n\n  var priorities = provided.map(function getPriority(type, index) {\n    return getMediaTypePriority(type, accepts, index);\n  });\n\n  // sorted list of accepted types\n  return priorities.filter(isQuality).sort(compareSpecs).map(function getType(priority) {\n    return provided[priorities.indexOf(priority)];\n  });\n}\n\nfunction compareSpecs(a, b) {\n  return (b.q - a.q) || (b.s - a.s) || (a.o - b.o) || (a.i - b.i) || 0;\n}\n\nfunction isQuality(spec) {\n  return spec.q > 0;\n}\n\nfunction quoteCount(string) {\n  var count = 0;\n  var index = 0;\n\n  while ((index = string.indexOf('\"', index)) !== -1) {\n    count++;\n    index++;\n  }\n\n  return count;\n}\n\nfunction splitMediaTypes(accept) {\n  var accepts = accept.split(',');\n\n  for (var i = 1, j = 0; i < accepts.length; i++) {\n    if (quoteCount(accepts[j]) % 2 == 0) {\n      accepts[++j] = accepts[i];\n    } else {\n      accepts[j] += ',' + accepts[i];\n    }\n  }\n\n  // trim accepts\n  accepts.length = j + 1;\n\n  return accepts;\n}\n"}