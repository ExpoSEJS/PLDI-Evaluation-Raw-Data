{"8":[12,12,12,70],"9":[1,20,1,27],"10":[12,12,12,33],"16":[12,12,12,107],"17":[1,28,1,32],"18":[12,37,12,70],"24":[26,9,26,25],"25":[1,20,1,33],"26":[12,74,12,107],"32":[28,29,28,70],"33":[1,20,1,33],"34":[26,9,26,25],"40":[31,9,31,19],"41":[1,20,1,33],"42":[31,9,31,19],"48":[44,28,44,46],"49":[2,26,2,38],"50":[36,12,36,34],"56":[42,28,42,44],"57":[2,26,2,45],"58":[39,25,39,34],"64":[40,21,40,24],"65":[2,26,2,45],"66":[48,48,48,76],"72":[50,21,50,63],"73":[2,26,2,45],"74":[50,21,50,31],"80":[54,25,54,44],"81":[3,1,3,13],"82":[50,35,50,63],"88":[53,28,53,38],"89":[3,1,3,14],"90":[53,28,53,38],"96":[50,21,50,63],"97":[4,9,4,16],"98":[54,25,54,44],"104":[36,12,36,34],"105":[4,17,4,23],"106":[128,21,128,41],"112":[66,13,66,16],"113":[4,9,4,24],"114":[128,43,128,46],"120":[69,17,69,20],"121":[4,9,4,31],"128":[83,13,83,16],"129":[4,42,4,49],"130":[128,43,128,46],"136":[87,17,87,20],"137":[4,50,4,58],"138":[134,9,134,15],"144":[100,13,100,16],"145":[4,42,4,59],"146":[139,9,139,19],"152":[104,17,104,20],"153":[4,74,4,81],"154":[141,21,141,46],"160":[117,13,117,16],"161":[4,82,4,92],"162":[141,48,141,51],"168":[120,17,120,20],"169":[4,74,4,93],"176":[129,13,129,40],"177":[4,9,4,31],"178":[141,48,141,51],"184":[128,21,128,41],"185":[4,9,4,31],"186":[143,21,143,30],"192":[134,9,134,15],"193":[4,42,4,59],"194":[144,17,144,27],"200":[139,9,139,19],"201":[4,42,4,59],"208":[144,17,144,27],"209":[4,74,4,93],"216":[141,21,141,46],"217":[4,74,4,93],"225":[6,5,6,9],"233":[6,15,6,17],"241":[6,5,6,17],"249":[6,5,6,18],"257":[7,5,7,9],"265":[7,21,7,29],"273":[7,5,7,29],"281":[7,5,7,30],"289":[8,5,8,9],"297":[8,21,8,29],"305":[8,5,8,29],"313":[8,5,8,30],"321":[9,5,9,9],"329":[9,20,9,27],"337":[9,5,9,27],"345":[9,5,9,28],"353":[5,19,10,2],"361":[5,19,10,2],"369":[5,19,10,2],"377":[5,19,10,2],"385":[5,19,10,2],"393":[5,19,10,2],"401":[5,19,10,2],"409":[5,19,10,2],"417":[5,19,10,2],"425":[11,1,11,12],"433":[11,1,11,22],"441":[12,12,12,19],"449":[12,12,12,22],"457":[12,26,12,30],"465":[12,26,12,33],"473":[12,37,12,44],"481":[12,37,12,53],"489":[12,57,12,61],"497":[12,57,12,70],"505":[12,74,12,81],"513":[12,74,12,90],"521":[12,94,12,98],"529":[12,94,12,107],"537":[12,12,12,107],"545":[12,5,12,108],"553":[11,31,13,2],"561":[11,31,13,2],"569":[11,31,13,2],"577":[11,31,13,2],"585":[11,1,13,2],"593":[11,1,13,3],"601":[14,16,14,20],"609":[14,16,14,20],"617":[14,16,14,20],"625":[15,24,15,28],"633":[15,24,15,28],"641":[15,24,15,28],"649":[17,16,17,23],"657":[17,24,17,34],"665":[17,16,17,35],"673":[17,16,17,44],"681":[17,16,17,44],"689":[17,5,17,45],"697":[18,24,18,31],"705":[18,32,18,42],"713":[18,24,18,43],"721":[18,24,18,53],"729":[18,24,18,70],"737":[18,24,18,70],"745":[18,5,18,71],"753":[19,3,20,2],"761":[22,5,22,9],"769":[22,22,22,24],"777":[22,5,22,24],"785":[22,5,22,25],"793":[21,14,23,2],"801":[21,14,23,2],"809":[21,14,23,2],"817":[21,14,23,2],"825":[21,14,23,2],"833":[24,1,24,7],"841":[24,1,24,17],"849":[25,16,25,20],"857":[25,16,25,20],"865":[25,16,25,20],"873":[26,9,26,17],"881":[26,21,26,25],"889":[27,16,27,24],"897":[27,29,27,34],"905":[27,35,27,70],"913":[27,25,27,71],"921":[27,16,27,72],"929":[27,16,27,72],"937":[27,9,27,73],"945":[28,29,28,36],"953":[28,37,28,56],"961":[28,29,28,57],"969":[28,61,28,70],"977":[28,29,28,70],"985":[28,29,28,70],"993":[29,23,29,27],"1001":[29,23,29,36],"1003":[29,23,29,34],"1009":[29,23,29,36],"1017":[29,23,29,36],"1025":[30,17,30,28],"1033":[30,17,30,35],"1041":[30,17,30,35],"1049":[30,17,30,35],"1057":[31,9,31,14],"1065":[31,18,31,19],"1073":[32,16,32,24],"1081":[32,25,32,29],"1089":[32,31,32,35],"1097":[32,16,32,36],"1105":[32,16,32,36],"1113":[32,9,32,37],"1121":[33,36,33,37],"1129":[33,36,33,37],"1137":[33,36,33,37],"1145":[34,28,34,33],"1153":[34,28,34,33],"1161":[34,28,34,33],"1169":[35,23,35,27],"1177":[35,23,35,27],"1185":[35,23,35,27],"1193":[36,12,36,23],"1201":[36,12,36,30],"1209":[36,33,36,34],"1217":[38,13,38,29],"1225":[38,30,38,32],"1233":[38,34,38,42],"1241":[38,44,38,52],"1249":[38,54,38,56],"1257":[38,58,38,75],"1265":[38,77,38,83],"1273":[38,85,38,95],"1281":[39,25,39,30],"1289":[39,33,39,34],"1297":[39,25,39,34],"1305":[39,17,39,35],"1313":[40,21,40,24],"1321":[41,35,41,38],"1329":[41,35,41,38],"1337":[41,21,41,39],"1345":[42,28,42,29],"1353":[42,28,42,36],"1361":[42,37,42,43],"1369":[42,28,42,44],"1377":[43,35,43,36],"1385":[43,35,43,43],"1393":[43,35,43,43],"1401":[43,21,43,44],"1409":[44,28,44,29],"1417":[44,28,44,36],"1425":[44,37,44,45],"1433":[44,28,44,46],"1441":[45,35,45,36],"1449":[45,35,45,43],"1457":[45,35,45,43],"1465":[45,21,45,44],"1473":[47,40,47,44],"1481":[47,40,47,44],"1489":[47,21,47,45],"1497":[48,48,48,72],"1505":[48,75,48,76],"1513":[48,48,48,76],"1521":[48,21,48,77],"1529":[50,21,50,26],"1537":[50,30,50,31],"1545":[50,35,50,59],"1553":[50,62,50,63],"1561":[51,21,51,35],"1569":[51,36,51,40],"1577":[51,36,51,50],"1585":[51,56,51,67],"1593":[51,68,51,70],"1601":[51,72,51,80],"1609":[51,82,51,90],"1617":[51,92,51,99],"1625":[51,52,51,100],"1633":[51,21,51,101],"1641":[51,21,51,102],"1649":[52,21,52,29],"1657":[52,30,52,34],"1665":[52,36,52,40],"1673":[52,21,52,41],"1681":[52,21,52,42],"1689":[53,28,53,33],"1697":[53,37,53,38],"1705":[54,25,54,36],"1713":[54,40,54,44],"1721":[55,43,55,53],"1729":[55,54,55,55],"1737":[55,56,55,94],"1745":[55,54,55,95],"1753":[55,39,55,96],"1761":[55,39,55,96],"1769":[55,25,55,97],"1777":[56,21,56,29],"1785":[56,30,56,41],"1793":[56,43,56,48],"1801":[56,21,56,49],"1809":[56,21,56,50],"1817":[38,97,58,14],"1825":[38,97,58,14],"1833":[38,97,58,14],"1841":[38,97,58,14],"1849":[38,97,58,14],"1857":[38,13,58,15],"1865":[38,13,58,16],"1873":[37,23,59,10],"1881":[37,23,59,10],"1889":[37,23,59,10],"1897":[37,23,59,10],"1905":[37,23,59,10],"1913":[37,23,59,10],"1921":[60,9,60,16],"1929":[60,17,60,28],"1937":[60,17,60,36],"1939":[60,17,60,34],"1945":[60,9,60,37],"1953":[60,9,60,38],"1961":[24,25,62,2],"1969":[24,25,62,2],"1977":[24,25,62,2],"1985":[24,25,62,2],"1993":[24,25,62,2],"2001":[24,25,62,2],"2009":[24,25,62,2],"2017":[24,25,62,2],"2025":[24,25,62,2],"2033":[24,25,62,2],"2041":[24,25,62,2],"2049":[24,25,62,2],"2057":[24,25,62,2],"2065":[24,25,62,2],"2073":[24,25,62,2],"2081":[24,25,62,2],"2089":[24,25,62,2],"2097":[24,25,62,2],"2105":[24,1,62,2],"2113":[24,1,62,3],"2121":[64,34,64,50],"2129":[64,51,64,61],"2137":[64,51,64,66],"2145":[64,68,64,78],"2153":[64,68,64,83],"2161":[64,85,64,102],"2169":[64,30,64,103],"2177":[64,30,64,103],"2185":[64,30,64,103],"2193":[65,5,65,23],"2201":[65,29,65,37],"2209":[65,39,65,47],"2217":[66,13,66,16],"2225":[67,20,67,28],"2233":[67,29,67,32],"2241":[67,34,67,39],"2249":[67,20,67,40],"2257":[67,20,67,40],"2265":[67,13,67,41],"2273":[68,9,68,27],"2281":[68,39,68,41],"2289":[69,17,69,20],"2297":[70,24,70,32],"2305":[70,33,70,36],"2313":[70,38,70,43],"2321":[70,24,70,44],"2329":[70,24,70,44],"2337":[70,17,70,45],"2345":[71,13,71,35],"2353":[71,36,71,54],"2361":[71,56,71,63],"2369":[71,65,71,67],"2377":[71,69,71,77],"2385":[71,79,71,87],"2393":[71,89,71,95],"2401":[71,97,71,103],"2409":[71,105,71,115],"2417":[71,117,71,125],"2425":[71,13,71,126],"2433":[71,13,71,127],"2441":[68,43,72,10],"2449":[68,43,72,10],"2457":[68,43,72,10],"2465":[68,43,72,10],"2473":[68,43,72,10],"2481":[68,9,72,11],"2483":[68,9,68,38],"2489":[68,9,72,12],"2497":[65,49,73,6],"2505":[65,49,73,6],"2513":[65,49,73,6],"2521":[65,49,73,6],"2529":[65,49,73,6],"2537":[65,5,73,7],"2539":[65,5,65,28],"2545":[65,5,73,8],"2553":[63,24,74,2],"2561":[63,24,74,2],"2569":[63,24,74,2],"2577":[63,24,74,2],"2585":[63,24,74,2],"2593":[63,24,74,2],"2601":[63,24,74,2],"2609":[63,24,74,2],"2617":[63,24,74,2],"2625":[63,24,74,2],"2633":[63,24,74,2],"2641":[63,24,74,2],"2649":[63,24,74,2],"2657":[63,24,74,2],"2665":[77,20,77,21],"2673":[78,20,78,28],"2681":[79,18,79,25],"2689":[80,24,80,25],"2697":[76,19,81,6],"2705":[76,19,81,6],"2713":[76,19,81,6],"2721":[82,5,82,11],"2729":[82,20,82,36],"2737":[82,38,82,45],"2745":[82,61,82,71],"2753":[82,47,82,73],"2761":[83,13,83,16],"2769":[84,20,84,28],"2777":[84,29,84,32],"2785":[84,34,84,39],"2793":[84,20,84,40],"2801":[84,20,84,40],"2809":[84,13,84,41],"2817":[85,19,85,20],"2825":[85,19,85,27],"2833":[85,19,85,27],"2841":[85,19,85,27],"2849":[86,9,86,27],"2857":[86,39,86,40],"2865":[86,39,86,47],"2873":[86,39,86,55],"2881":[87,17,87,20],"2889":[88,24,88,32],"2897":[88,33,88,36],"2905":[88,38,88,43],"2913":[88,24,88,44],"2921":[88,24,88,44],"2929":[88,17,88,45],"2937":[89,13,89,36],"2945":[89,37,89,55],"2953":[89,57,89,64],"2961":[89,66,89,69],"2969":[89,71,89,73],"2977":[89,75,89,83],"2985":[89,85,89,93],"2993":[89,95,89,101],"3001":[89,103,89,109],"3009":[89,111,89,121],"3017":[89,123,89,131],"3025":[89,13,89,132],"3033":[89,13,89,133],"3041":[86,57,90,10],"3049":[86,57,90,10],"3057":[86,57,90,10],"3065":[86,57,90,10],"3073":[86,57,90,10],"3081":[86,9,90,11],"3083":[86,9,86,38],"3089":[86,9,90,12],"3097":[82,75,91,6],"3105":[82,75,91,6],"3113":[82,75,91,6],"3121":[82,75,91,6],"3129":[82,75,91,6],"3137":[82,75,91,6],"3145":[82,5,91,7],"3147":[82,5,82,19],"3153":[82,5,91,8],"3161":[75,30,92,2],"3169":[75,30,92,2],"3177":[75,30,92,2],"3185":[75,30,92,2],"3193":[75,30,92,2],"3201":[75,30,92,2],"3209":[75,30,92,2],"3217":[75,30,92,2],"3225":[75,30,92,2],"3233":[75,30,92,2],"3241":[75,30,92,2],"3249":[75,30,92,2],"3257":[75,30,92,2],"3265":[75,30,92,2],"3273":[75,30,92,2],"3281":[95,23,95,24],"3289":[96,25,96,28],"3297":[96,25,96,43],"3305":[97,18,97,25],"3313":[94,19,98,6],"3321":[94,19,98,6],"3329":[94,19,98,6],"3337":[99,5,99,11],"3345":[99,20,99,36],"3353":[99,38,99,45],"3361":[99,61,99,71],"3369":[99,47,99,73],"3377":[100,13,100,16],"3385":[101,20,101,28],"3393":[101,29,101,32],"3401":[101,34,101,39],"3409":[101,20,101,40],"3417":[101,20,101,40],"3425":[101,13,101,41],"3433":[102,19,102,20],"3441":[102,19,102,27],"3449":[102,19,102,27],"3457":[102,19,102,27],"3465":[103,9,103,27],"3473":[103,39,103,42],"3481":[103,39,103,50],"3489":[104,17,104,20],"3497":[105,24,105,32],"3505":[105,33,105,36],"3513":[105,38,105,43],"3521":[105,24,105,44],"3529":[105,24,105,44],"3537":[105,17,105,45],"3545":[106,13,106,35],"3553":[106,36,106,54],"3561":[106,56,106,63],"3569":[106,65,106,68],"3577":[106,70,106,72],"3585":[106,74,106,82],"3593":[106,84,106,92],"3601":[106,94,106,100],"3609":[106,102,106,108],"3617":[106,110,106,120],"3625":[106,122,106,130],"3633":[106,13,106,131],"3641":[106,13,106,132],"3649":[103,52,107,10],"3657":[103,52,107,10],"3665":[103,52,107,10],"3673":[103,52,107,10],"3681":[103,52,107,10],"3689":[103,9,107,11],"3691":[103,9,103,38],"3697":[103,9,107,12],"3705":[99,75,108,6],"3713":[99,75,108,6],"3721":[99,75,108,6],"3729":[99,75,108,6],"3737":[99,75,108,6],"3745":[99,75,108,6],"3753":[99,5,108,7],"3755":[99,5,99,19],"3761":[99,5,108,8],"3769":[93,31,109,2],"3777":[93,31,109,2],"3785":[93,31,109,2],"3793":[93,31,109,2],"3801":[93,31,109,2],"3809":[93,31,109,2],"3817":[93,31,109,2],"3825":[93,31,109,2],"3833":[93,31,109,2],"3841":[93,31,109,2],"3849":[93,31,109,2],"3857":[93,31,109,2],"3865":[93,31,109,2],"3873":[93,31,109,2],"3881":[93,31,109,2],"3889":[93,31,109,2],"3897":[112,23,112,24],"3905":[113,25,113,28],"3913":[113,25,113,43],"3921":[114,18,114,25],"3929":[111,19,115,6],"3937":[111,19,115,6],"3945":[111,19,115,6],"3953":[116,5,116,11],"3961":[116,20,116,36],"3969":[116,38,116,45],"3977":[116,61,116,71],"3985":[116,47,116,73],"3993":[117,13,117,16],"4001":[118,20,118,28],"4009":[118,29,118,32],"4017":[118,34,118,39],"4025":[118,20,118,40],"4033":[118,20,118,40],"4041":[118,13,118,41],"4049":[119,9,119,27],"4057":[119,39,119,43],"4065":[120,17,120,20],"4073":[121,24,121,32],"4081":[121,33,121,36],"4089":[121,38,121,42],"4097":[121,24,121,43],"4105":[121,24,121,43],"4113":[121,17,121,44],"4121":[122,13,122,21],"4129":[122,22,122,26],"4137":[122,28,122,29],"4145":[122,13,122,30],"4153":[122,13,122,31],"4161":[119,45,123,10],"4169":[119,45,123,10],"4177":[119,45,123,10],"4185":[119,45,123,10],"4193":[119,45,123,10],"4201":[119,9,123,11],"4203":[119,9,119,38],"4209":[119,9,123,12],"4217":[116,75,124,6],"4225":[116,75,124,6],"4233":[116,75,124,6],"4241":[116,75,124,6],"4249":[116,75,124,6],"4257":[116,5,124,7],"4259":[116,5,116,19],"4265":[116,5,124,8],"4273":[110,30,125,2],"4281":[110,30,125,2],"4289":[110,30,125,2],"4297":[110,30,125,2],"4305":[110,30,125,2],"4313":[110,30,125,2],"4321":[110,30,125,2],"4329":[110,30,125,2],"4337":[110,30,125,2],"4345":[110,30,125,2],"4353":[110,30,125,2],"4361":[110,30,125,2],"4369":[110,30,125,2],"4377":[110,30,125,2],"4385":[110,30,125,2],"4393":[110,30,125,2],"4401":[127,17,127,22],"4409":[127,17,127,22],"4417":[127,17,127,22],"4425":[128,18,128,19],"4433":[128,18,128,19],"4441":[128,18,128,19],"4449":[128,21,128,22],"4457":[128,25,128,34],"4465":[128,25,128,41],"4481":[128,43,128,44],"4489":[128,43,128,46],"4505":[129,13,129,22],"4513":[129,23,129,24],"4521":[129,13,129,25],"4529":[129,32,129,39],"4537":[129,13,129,40],"4539":[129,13,129,31],"4545":[130,21,130,25],"4553":[130,21,130,25],"4561":[130,13,130,26],"4569":[134,10,134,15],"4577":[135,9,135,18],"4585":[135,24,135,31],"4593":[135,9,135,32],"4595":[135,9,135,23],"4601":[135,9,135,33],"4609":[126,22,136,2],"4617":[126,22,136,2],"4625":[126,22,136,2],"4633":[126,22,136,2],"4641":[126,22,136,2],"4649":[126,22,136,2],"4657":[126,22,136,2],"4665":[126,22,136,2],"4673":[126,22,136,2],"4681":[137,1,137,7],"4689":[137,1,137,17],"4697":[138,17,138,21],"4705":[138,17,138,31],"4713":[138,17,138,38],"4721":[138,17,138,38],"4729":[138,17,138,38],"4737":[139,9,139,14],"4745":[139,18,139,19],"4753":[140,16,140,24],"4761":[140,25,140,29],"4769":[140,31,140,35],"4777":[140,16,140,36],"4785":[140,16,140,36],"4793":[140,9,140,37],"4801":[141,18,141,19],"4809":[141,18,141,19],"4817":[141,18,141,19],"4825":[141,21,141,22],"4833":[141,25,141,29],"4841":[141,25,141,39],"4849":[141,25,141,46],"4865":[141,48,141,49],"4873":[141,48,141,51],"4889":[142,9,142,13],"4897":[142,19,142,25],"4905":[142,27,142,31],"4913":[142,33,142,37],"4921":[142,33,142,47],"4929":[142,48,142,49],"4937":[142,33,142,50],"4945":[142,33,142,53],"4953":[142,55,142,59],"4961":[142,55,142,69],"4969":[142,70,142,71],"4977":[142,55,142,72],"4985":[142,55,142,81],"4993":[142,83,142,87],"5001":[142,83,142,97],"5009":[142,98,142,99],"5017":[142,83,142,100],"5025":[142,83,142,109],"5033":[142,111,142,115],"5041":[142,111,142,125],"5049":[142,126,142,127],"5057":[142,111,142,128],"5065":[142,111,142,136],"5073":[143,21,143,26],"5081":[143,29,143,30],"5089":[143,21,143,30],"5097":[143,13,143,31],"5105":[144,17,144,22],"5113":[144,26,144,27],"5121":[145,17,145,25],"5129":[145,26,145,30],"5137":[145,32,145,36],"5145":[145,17,145,37],"5153":[145,17,145,38],"5161":[142,138,147,10],"5169":[142,138,147,10],"5177":[142,138,147,10],"5185":[142,138,147,10],"5193":[142,138,147,10],"5201":[142,9,147,11],"5203":[142,9,142,18],"5209":[142,9,147,12],"5217":[137,35,149,2],"5225":[137,35,149,2],"5233":[137,35,149,2],"5241":[137,35,149,2],"5249":[137,35,149,2],"5257":[137,35,149,2],"5265":[137,35,149,2],"5273":[137,35,149,2],"5281":[137,1,149,2],"5289":[137,1,149,3],"5297":[150,1,150,7],"5305":[150,18,150,24],"5313":[150,1,150,24],"5321":[150,1,150,25],"5329":[1,1,150,25],"5337":[1,1,150,25],"5345":[1,1,150,25],"5353":[1,1,150,25],"5361":[1,1,150,25],"5369":[1,1,150,25],"5377":[1,1,150,25],"5385":[1,1,150,25],"5393":[1,1,150,25],"5401":[1,1,150,25],"5409":[1,1,150,25],"5417":[1,1,150,25],"5425":[1,1,150,25],"5433":[1,1,150,25],"5441":[1,1,150,25],"5449":[5,19,10,2],"5457":[5,19,10,2],"5465":[11,31,13,2],"5473":[11,31,13,2],"5481":[21,14,23,2],"5489":[21,14,23,2],"5497":[26,5,27,73],"5505":[31,5,32,37],"5513":[44,24,49,18],"5521":[42,24,49,18],"5529":[40,17,49,18],"5537":[54,21,55,97],"5545":[53,24,57,18],"5553":[50,17,57,18],"5561":[38,97,58,14],"5569":[38,97,58,14],"5577":[37,23,59,10],"5585":[37,23,59,10],"5593":[36,5,61,6],"5601":[24,25,62,2],"5609":[24,25,62,2],"5617":[66,9,67,41],"5625":[69,13,70,45],"5633":[68,43,72,10],"5641":[68,43,72,10],"5649":[65,49,73,6],"5657":[65,49,73,6],"5665":[63,24,74,2],"5673":[63,24,74,2],"5681":[83,9,84,41],"5689":[87,13,88,45],"5697":[86,57,90,10],"5705":[86,57,90,10],"5713":[82,75,91,6],"5721":[82,75,91,6],"5729":[75,30,92,2],"5737":[75,30,92,2],"5745":[100,9,101,41],"5753":[104,13,105,45],"5761":[103,52,107,10],"5769":[103,52,107,10],"5777":[99,75,108,6],"5785":[99,75,108,6],"5793":[93,31,109,2],"5801":[93,31,109,2],"5809":[117,9,118,41],"5817":[120,13,121,44],"5825":[119,45,123,10],"5833":[119,45,123,10],"5841":[116,75,124,6],"5849":[116,75,124,6],"5857":[110,30,125,2],"5865":[110,30,125,2],"5873":[129,9,132,10],"5881":[128,5,133,6],"5889":[128,5,133,6],"5897":[134,5,135,33],"5905":[126,22,136,2],"5913":[126,22,136,2],"5921":[139,5,140,37],"5929":[144,13,146,14],"5937":[142,138,147,10],"5945":[142,138,147,10],"5953":[141,5,148,6],"5961":[141,5,148,6],"5969":[137,35,149,2],"5977":[137,35,149,2],"5985":[1,1,150,25],"5993":[1,1,150,25],"nBranches":54,"originalCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/mongodb-core/lib/auth/gssapi.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/mongodb-core/lib/auth/gssapi_jalangi_.js","code":"\"use strict\";\n\nvar f = require('util').format\n  , crypto = require('crypto')\n  , MongoError = require('../error');\n\nvar AuthSession = function(db, username, password, options) {\n  this.db = db;\n  this.username = username;\n  this.password = password;\n  this.options = options;\n}\n\nAuthSession.prototype.equal = function(session) {\n  return session.db == this.db \n    && session.username == this.username\n    && session.password == this.password;\n}\n\n// Kerberos class\nvar Kerberos = null;\nvar MongoAuthProcess = null;\n\n// Try to grab the Kerberos class\ntry {\n  Kerberos = require('kerberos').Kerberos\n  // Authentication process for Mongo\n  MongoAuthProcess = require('kerberos').processes.MongoAuthProcess\n} catch(err) {}\n\n/**\n * Creates a new GSSAPI authentication mechanism\n * @class\n * @return {GSSAPI} A cursor instance\n */\nvar GSSAPI = function() {\n  this.authStore = [];\n}\n\n/**\n * Authenticate\n * @method\n * @param {{Server}|{ReplSet}|{Mongos}} server Topology the authentication method is being called on\n * @param {Pool} pool Connection pool for this topology\n * @param {string} db Name of the database\n * @param {string} username Username\n * @param {string} password Password\n * @param {authResultCallback} callback The callback to return the result from the authentication\n * @return {object}\n */\nGSSAPI.prototype.auth = function(server, pool, db, username, password, options, callback) {\n  var self = this;\n  // We don't have the Kerberos library\n  if(Kerberos == null) return callback(new Error(\"Kerberos library is not installed\"));  \n  var gssapiServiceName = options['gssapiServiceName'] || 'mongodb';\n  // Get all the connections\n  var connections = pool.getAll();\n  // Total connections\n  var count = connections.length;\n  if(count == 0) return callback(null, null);\n\n  // Valid connections\n  var numberOfValidConnections = 0;\n  var credentialsValid = false;\n  var errorObject = null;\n\n  // For each connection we need to authenticate\n  while(connections.length > 0) {    \n    // Execute MongoCR\n    var execute = function(connection) {\n      // Start Auth process for a connection\n      GSSAPIInitialize(db, username, password, db, gssapiServiceName, server, connection, function(err, r) {\n        // Adjust count\n        count = count - 1;\n\n        // If we have an error\n        if(err) {\n          errorObject = err;\n        } else if(r.result['$err']) {\n          errorObject = r.result;\n        } else if(r.result['errmsg']) {\n          errorObject = r.result;\n        } else {\n          credentialsValid = true;\n          numberOfValidConnections = numberOfValidConnections + 1;\n        }\n\n        // We have authenticated all connections\n        if(count == 0 && numberOfValidConnections > 0) {\n          // Store the auth details\n          addAuthSession(self.authStore, new AuthSession(db, username, password, options));\n          // Return correct authentication\n          callback(null, true);\n        } else if(count == 0) {\n          if(errorObject == null) errorObject = new MongoError(f(\"failed to authenticate using mongocr\"));\n          callback(errorObject, false);\n        }\n      });\n    }\n\n    // Get the connection\n    execute(connections.shift());\n  }\n}\n\n//\n// Initialize step\nvar GSSAPIInitialize = function(db, username, password, authdb, gssapiServiceName, server, connection, callback) {\n  // Create authenticator\n  var mongo_auth_process = new MongoAuthProcess(connection.host, connection.port, gssapiServiceName);\n\n  // Perform initialization\n  mongo_auth_process.init(username, password, function(err, context) {\n    if(err) return callback(err, false);\n\n    // Perform the first step\n    mongo_auth_process.transition('', function(err, payload) {\n      if(err) return callback(err, false);\n\n      // Call the next db step\n      MongoDBGSSAPIFirstStep(mongo_auth_process, payload, db, username, password, authdb, server, connection, callback);\n    });\n  });\n}\n\n//\n// Perform first step against mongodb\nvar MongoDBGSSAPIFirstStep = function(mongo_auth_process, payload, db, username, password, authdb, server, connection, callback) {\n  // Build the sasl start command\n  var command = {\n      saslStart: 1\n    , mechanism: 'GSSAPI'\n    , payload: payload\n    , autoAuthorize: 1\n  };\n\n  // Execute first sasl step\n  server.command(\"$external.$cmd\"\n    , command\n    , { connection: connection }, function(err, r) {\n    if(err) return callback(err, false);    \n    var doc = r.result;\n    // Execute mongodb transition\n    mongo_auth_process.transition(r.result.payload, function(err, payload) {\n      if(err) return callback(err, false);\n\n      // MongoDB API Second Step\n      MongoDBGSSAPISecondStep(mongo_auth_process, payload, doc, db, username, password, authdb, server, connection, callback);\n    });\n  });\n}\n\n//\n// Perform first step against mongodb\nvar MongoDBGSSAPISecondStep = function(mongo_auth_process, payload, doc, db, username, password, authdb, server, connection, callback) {\n  // Build Authentication command to send to MongoDB\n  var command = {\n      saslContinue: 1\n    , conversationId: doc.conversationId\n    , payload: payload\n  };\n\n  // Execute the command\n  server.command(\"$external.$cmd\"\n    , command\n    , { connection: connection }, function(err, r) {\n    if(err) return callback(err, false);\n    var doc = r.result;\n    // Call next transition for kerberos\n    mongo_auth_process.transition(doc.payload, function(err, payload) {\n      if(err) return callback(err, false);\n\n      // Call the last and third step\n      MongoDBGSSAPIThirdStep(mongo_auth_process, payload, doc, db, username, password, authdb, server, connection, callback);\n    });    \n  });\n}\n\nvar MongoDBGSSAPIThirdStep = function(mongo_auth_process, payload, doc, db, username, password, authdb, server, connection, callback) {\n  // Build final command\n  var command = {\n      saslContinue: 1\n    , conversationId: doc.conversationId\n    , payload: payload\n  };\n\n  // Execute the command\n  server.command(\"$external.$cmd\"\n    , command\n    , { connection: connection }, function(err, r) {\n    if(err) return callback(err, false);\n    mongo_auth_process.transition(null, function(err, payload) {\n      if(err) return callback(err, null);\n      callback(null, r);\n    });\n  });\n}\n\n// Add to store only if it does not exist\nvar addAuthSession = function(authStore, session) {\n  var found = false;\n\n  for(var i = 0; i < authStore.length; i++) {\n    if(authStore[i].equal(session)) {\n      found = true;\n      break;\n    }\n  }\n\n  if(!found) authStore.push(session);\n}\n\n/**\n * Re authenticate pool\n * @method\n * @param {{Server}|{ReplSet}|{Mongos}} server Topology the authentication method is being called on\n * @param {Pool} pool Connection pool for this topology\n * @param {authResultCallback} callback The callback to return the result from the authentication\n * @return {object}\n */\nGSSAPI.prototype.reauthenticate = function(server, pool, callback) {\n  var count = this.authStore.length;\n  if(count == 0) return callback(null, null);\n  // Iterate over all the auth details stored\n  for(var i = 0; i < this.authStore.length; i++) {\n    this.auth(server, pool, this.authStore[i].db, this.authStore[i].username, this.authStore[i].password, this.authStore[i].options, function(err, r) {\n      count = count - 1;\n      // Done re-authenticating\n      if(count == 0) {\n        callback(null, null);\n      }\n    });\n  }\n}\n\n/**\n * This is a result from a authentication strategy\n *\n * @callback authResultCallback\n * @param {error} error An error object. Set to null if no error present\n * @param {boolean} result The result of the authentication process\n */\n\nmodule.exports = GSSAPI;"}