{"8":[26,13,26,32],"9":[1,20,1,27],"10":[26,13,26,32],"16":[36,13,36,16],"17":[1,28,1,32],"18":[41,13,41,19],"24":[39,21,39,42],"25":[1,20,1,33],"26":[47,38,47,45],"32":[41,13,41,19],"33":[1,20,1,33],"34":[47,47,47,50],"40":[44,13,44,47],"41":[1,20,1,33],"48":[44,13,44,47],"49":[2,26,2,38],"50":[49,17,49,21],"56":[50,17,50,37],"57":[2,26,2,45],"58":[50,17,50,24],"64":[49,17,49,21],"65":[2,26,2,45],"72":[54,21,54,24],"73":[2,26,2,45],"74":[57,17,57,24],"80":[57,17,57,37],"81":[3,17,3,24],"88":[47,38,47,45],"89":[3,25,3,34],"90":[67,9,67,15],"96":[64,9,64,24],"97":[3,17,3,35],"98":[70,34,70,41],"104":[66,17,66,38],"105":[3,17,3,35],"106":[70,43,70,46],"112":[67,9,67,15],"113":[3,17,3,35],"120":[71,13,71,24],"121":[4,17,4,24],"122":[74,13,74,17],"128":[74,13,74,17],"129":[4,25,4,40],"130":[85,9,85,30],"136":[77,13,77,32],"137":[4,17,4,41],"138":[86,14,86,18],"144":[70,34,70,41],"145":[4,17,4,41],"146":[86,13,86,18],"152":[86,13,86,26],"153":[4,17,4,41],"154":[91,9,91,50],"160":[86,13,86,26],"161":[5,29,5,36],"162":[91,55,91,63],"168":[85,9,85,30],"169":[5,37,5,61],"170":[91,67,91,97],"176":[91,11,91,49],"177":[5,29,5,62],"178":[100,12,100,15],"184":[91,55,91,97],"185":[5,29,5,62],"192":[91,9,91,98],"193":[5,29,5,62],"194":[100,12,100,15],"200":[93,13,93,35],"201":[6,18,6,25],"202":[101,13,101,22],"208":[93,13,93,35],"209":[6,26,6,41],"210":[104,13,104,44],"216":[91,9,91,98],"217":[6,18,6,42],"218":[104,48,104,97],"224":[101,13,101,22],"225":[6,18,6,42],"226":[107,15,107,46],"232":[104,13,104,97],"233":[6,18,6,42],"234":[107,13,107,47],"240":[104,13,104,97],"241":[7,19,7,26],"242":[134,9,134,26],"248":[107,13,107,59],"249":[7,27,7,46],"250":[136,16,136,32],"256":[109,17,109,82],"257":[7,19,7,47],"258":[137,12,137,15],"264":[117,21,117,35],"265":[7,19,7,47],"272":[117,21,117,35],"273":[7,19,7,47],"274":[137,12,137,15],"280":[108,17,108,21],"281":[10,9,10,20],"282":[139,13,139,36],"288":[107,13,107,59],"289":[10,27,10,31],"296":[100,12,100,15],"297":[10,33,10,42],"304":[134,11,134,25],"305":[10,9,10,43],"307":[10,9,10,26],"312":[134,9,134,26],"313":[10,9,10,44],"320":[140,13,140,40],"321":[9,5,11,6],"328":[139,13,139,36],"329":[9,5,11,6],"336":[137,12,137,15],"337":[12,5,12,21],"344":[144,12,144,31],"345":[12,34,12,40],"352":[144,12,144,44],"353":[12,48,12,59],"361":[12,48,12,69],"369":[12,34,12,70],"371":[12,34,12,47],"377":[12,5,12,70],"385":[12,5,12,71],"393":[13,5,13,21],"401":[13,5,13,31],"409":[13,45,13,51],"417":[13,5,13,52],"419":[13,5,13,44],"425":[13,5,13,53],"433":[14,5,14,21],"441":[14,31,14,37],"449":[14,5,14,37],"457":[14,5,14,38],"465":[15,19,15,25],"473":[15,19,15,33],"481":[16,9,16,25],"489":[16,9,16,35],"497":[16,36,16,37],"505":[16,41,16,47],"513":[16,41,16,55],"521":[16,56,16,57],"529":[16,41,16,58],"537":[16,9,16,58],"545":[16,9,16,59],"553":[15,19,15,33],"561":[15,5,16,59],"569":[15,5,16,59],"577":[17,15,17,21],"585":[17,15,17,29],"593":[18,9,18,25],"601":[18,26,18,27],"609":[18,31,18,37],"617":[18,31,18,45],"625":[18,46,18,47],"633":[18,31,18,48],"641":[18,9,18,48],"649":[18,9,18,49],"657":[17,15,17,29],"665":[17,5,18,49],"673":[17,5,18,49],"681":[19,5,19,21],"689":[19,32,19,39],"697":[19,5,19,39],"705":[19,5,19,40],"713":[20,5,20,14],"721":[20,20,20,24],"729":[20,26,20,29],"737":[20,31,20,47],"745":[20,49,20,56],"753":[20,5,20,57],"755":[20,5,20,19],"761":[20,5,20,58],"769":[21,5,21,9],"777":[21,19,21,25],"785":[21,5,21,25],"793":[21,5,21,26],"801":[22,16,22,20],"809":[22,16,22,25],"817":[22,16,22,25],"825":[22,16,22,25],"833":[23,14,23,18],"841":[23,14,23,31],"849":[23,14,23,31],"857":[23,14,23,31],"865":[24,5,24,9],"873":[25,19,25,21],"881":[25,27,25,31],"889":[25,19,25,32],"891":[25,19,25,26],"897":[25,19,25,32],"905":[25,19,25,32],"913":[26,14,26,19],"921":[26,28,26,31],"929":[26,14,26,32],"931":[26,14,26,27],"937":[27,20,27,23],"945":[27,19,27,24],"953":[27,19,27,24],"961":[27,13,27,25],"969":[28,20,28,41],"977":[28,42,28,45],"985":[28,47,28,51],"993":[28,53,28,57],"1001":[28,16,28,58],"1009":[28,16,28,58],"1017":[28,9,28,59],"1025":[24,18,29,6],"1033":[24,18,29,6],"1041":[24,18,29,6],"1049":[24,18,29,6],"1057":[24,5,29,7],"1059":[24,5,24,17],"1065":[24,5,29,8],"1073":[8,1,30,2],"1081":[8,1,30,2],"1089":[8,1,30,2],"1097":[8,1,30,2],"1105":[8,1,30,2],"1113":[9,5,11,6],"1121":[8,1,30,2],"1129":[8,1,30,2],"1137":[8,1,30,2],"1145":[8,1,30,2],"1153":[31,1,31,14],"1161":[31,28,31,43],"1169":[31,1,31,43],"1177":[31,1,31,44],"1185":[32,1,32,14],"1193":[32,27,32,33],"1201":[32,41,32,50],"1209":[32,41,32,60],"1217":[32,27,32,61],"1219":[32,27,32,40],"1225":[32,1,32,61],"1233":[32,1,32,62],"1241":[33,1,33,14],"1249":[33,1,33,24],"1257":[33,39,33,52],"1265":[33,1,33,52],"1273":[33,1,33,53],"1281":[34,1,34,14],"1289":[34,1,34,24],"1297":[35,5,35,15],"1305":[35,5,35,25],"1313":[35,5,35,36],"1321":[35,42,35,46],"1329":[35,48,35,53],"1337":[36,13,36,16],"1345":[37,20,37,22],"1353":[37,23,37,26],"1361":[37,20,37,27],"1369":[37,20,37,27],"1377":[37,13,37,28],"1385":[39,21,39,26],"1393":[39,30,39,35],"1401":[39,30,39,42],"1409":[39,21,39,42],"1417":[39,21,39,42],"1425":[41,14,41,19],"1433":[42,20,42,22],"1441":[42,20,42,24],"1449":[42,20,42,24],"1457":[42,13,42,25],"1465":[44,13,44,20],"1473":[44,24,44,31],"1481":[44,24,44,47],"1489":[45,20,45,22],"1497":[45,20,45,24],"1505":[45,20,45,24],"1513":[45,13,45,25],"1521":[47,22,47,23],"1529":[47,31,47,36],"1537":[47,22,47,23],"1545":[47,22,47,23],"1553":[47,31,47,36],"1561":[47,31,47,36],"1569":[47,38,47,39],"1577":[47,42,47,45],"1593":[47,49,47,50],"1601":[47,47,47,50],"1609":[48,23,48,28],"1617":[48,29,48,30],"1625":[48,23,48,31],"1633":[48,23,48,31],"1641":[48,23,48,31],"1649":[49,18,49,21],"1665":[50,19,50,24],"1673":[50,17,50,24],"1681":[50,28,50,30],"1689":[50,31,50,36],"1697":[50,28,50,37],"1705":[50,17,50,38],"1713":[53,13,53,16],"1721":[53,41,53,45],"1729":[53,26,53,47],"1737":[54,21,54,24],"1745":[55,29,55,32],"1753":[55,29,55,32],"1761":[55,21,55,33],"1777":[57,19,57,24],"1785":[57,17,57,24],"1793":[57,28,57,30],"1801":[57,31,57,36],"1809":[57,28,57,37],"1817":[57,17,57,38],"1825":[53,49,58,14],"1833":[53,49,58,14],"1841":[53,49,58,14],"1849":[53,49,58,14],"1857":[53,13,58,15],"1859":[53,13,53,25],"1865":[53,13,58,16],"1873":[35,55,60,6],"1881":[35,55,60,6],"1889":[35,55,60,6],"1897":[35,55,60,6],"1905":[35,55,60,6],"1913":[35,55,60,6],"1921":[35,55,60,6],"1929":[35,55,60,6],"1937":[35,55,60,6],"1945":[60,8,60,13],"1953":[35,5,60,14],"1955":[35,5,35,41],"1961":[35,5,60,15],"1969":[34,38,61,2],"1977":[34,38,61,2],"1985":[34,38,61,2],"1993":[34,38,61,2],"2001":[34,38,61,2],"2009":[34,38,61,2],"2017":[34,38,61,2],"2025":[34,1,61,2],"2033":[34,1,61,3],"2041":[62,1,62,14],"2049":[62,1,62,24],"2057":[63,27,63,37],"2065":[63,27,63,47],"2073":[63,27,63,62],"2081":[63,68,63,72],"2089":[63,74,63,79],"2097":[63,81,63,86],"2105":[63,27,63,87],"2107":[63,27,63,67],"2113":[63,27,63,87],"2121":[63,27,63,87],"2129":[64,9,64,24],"2137":[65,16,65,31],"2145":[65,16,65,31],"2153":[65,9,65,32],"2161":[66,17,66,22],"2169":[66,26,66,31],"2177":[66,26,66,38],"2185":[66,54,66,58],"2193":[66,17,66,38],"2201":[66,17,66,38],"2209":[66,54,66,58],"2217":[66,54,66,58],"2225":[67,10,67,15],"2233":[68,9,68,16],"2241":[68,9,68,16],"2249":[70,18,70,19],"2257":[70,27,70,32],"2265":[70,18,70,19],"2273":[70,18,70,19],"2281":[70,27,70,32],"2289":[70,27,70,32],"2297":[70,34,70,35],"2305":[70,38,70,41],"2321":[70,45,70,46],"2329":[70,43,70,46],"2337":[71,13,71,24],"2345":[73,19,73,24],"2353":[73,25,73,26],"2361":[73,19,73,27],"2369":[73,19,73,27],"2377":[73,19,73,27],"2385":[74,14,74,17],"2393":[76,35,76,38],"2401":[76,35,76,53],"2403":[76,35,76,51],"2409":[76,35,76,53],"2417":[76,35,76,53],"2425":[77,13,77,32],"2433":[78,27,78,46],"2441":[78,27,78,46],"2449":[78,13,78,47],"2457":[81,12,81,23],"2465":[81,12,81,23],"2473":[81,5,81,24],"2481":[62,42,82,2],"2489":[62,42,82,2],"2497":[62,42,82,2],"2505":[62,42,82,2],"2513":[62,42,82,2],"2521":[62,42,82,2],"2529":[62,42,82,2],"2537":[62,42,82,2],"2545":[62,42,82,2],"2553":[62,42,82,2],"2561":[62,42,82,2],"2569":[62,42,82,2],"2577":[62,1,82,2],"2585":[62,1,82,3],"2593":[83,1,83,14],"2601":[83,1,83,24],"2609":[85,10,85,15],"2617":[85,24,85,29],"2625":[85,10,85,30],"2627":[85,10,85,23],"2633":[86,15,86,18],"2641":[86,22,86,26],"2649":[87,13,87,16],"2657":[87,30,87,34],"2665":[87,30,87,39],"2673":[87,13,87,40],"2675":[87,13,87,29],"2681":[87,13,87,41],"2689":[89,16,89,20],"2697":[89,27,89,32],"2705":[89,26,89,33],"2713":[89,35,89,38],"2721":[89,40,89,44],"2729":[89,46,89,50],"2737":[89,16,89,51],"2739":[89,16,89,25],"2745":[89,16,89,51],"2753":[89,9,89,52],"2761":[91,11,91,16],"2769":[91,20,91,25],"2777":[91,20,91,49],"2785":[91,56,91,63],"2793":[91,68,91,75],"2801":[91,68,91,97],"2809":[92,21,92,42],"2817":[92,43,92,48],"2825":[92,50,92,54],"2833":[92,50,92,59],"2841":[92,61,92,64],"2849":[92,17,92,65],"2857":[92,17,92,65],"2865":[92,9,92,66],"2873":[93,13,93,17],"2881":[93,21,93,25],"2889":[93,21,93,35],"2897":[94,29,94,33],"2905":[94,29,94,43],"2913":[95,17,95,20],"2921":[95,36,95,39],"2929":[95,41,95,45],"2937":[95,41,95,55],"2945":[95,56,95,59],"2953":[95,41,95,60],"2961":[95,17,95,61],"2963":[95,17,95,35],"2969":[95,17,95,62],"2977":[94,29,94,43],"2985":[94,13,96,14],"2993":[94,13,96,14],"3001":[99,9,99,14],"3009":[99,9,99,21],"3017":[99,9,99,21],"3025":[99,5,99,22],"3041":[100,12,100,13],"3049":[100,12,100,15],"3065":[101,14,101,19],"3073":[101,20,101,21],"3081":[101,14,101,22],"3089":[104,13,104,18],"3097":[104,19,104,20],"3105":[104,13,104,21],"3113":[104,33,104,44],"3121":[104,48,104,53],"3129":[104,54,104,55],"3137":[104,48,104,56],"3145":[104,48,104,63],"3153":[104,68,104,72],"3161":[104,68,104,90],"3169":[104,68,104,97],"3177":[105,13,105,18],"3185":[105,19,105,20],"3193":[105,24,105,29],"3201":[105,30,105,31],"3209":[105,24,105,32],"3217":[105,54,105,59],"3225":[105,42,105,61],"3233":[105,24,105,62],"3235":[105,24,105,41],"3241":[105,13,105,62],"3249":[105,13,105,63],"3257":[107,15,107,20],"3265":[107,21,107,22],"3273":[107,15,107,23],"3281":[107,35,107,46],"3289":[107,51,107,56],"3297":[107,57,107,58],"3305":[107,51,107,59],"3313":[108,17,108,21],"3321":[109,17,109,25],"3329":[109,41,109,51],"3337":[109,52,109,56],"3345":[109,58,109,61],"3353":[109,58,109,65],"3361":[109,58,109,74],"3369":[109,76,109,80],"3377":[109,41,109,81],"3385":[109,41,109,81],"3393":[109,17,109,83],"3401":[110,30,110,34],"3409":[110,53,110,57],"3417":[110,59,110,64],"3425":[110,66,110,70],"3433":[110,72,110,80],"3441":[110,82,110,83],"3449":[110,26,110,84],"3451":[110,30,110,52],"3457":[110,26,110,84],"3465":[110,17,110,85],"3473":[111,17,111,22],"3481":[111,23,111,24],"3489":[111,28,111,34],"3497":[111,40,111,45],"3505":[111,46,111,47],"3513":[111,40,111,48],"3521":[111,28,111,49],"3523":[111,28,111,39],"3529":[111,17,111,49],"3537":[111,17,111,50],"3545":[114,30,114,34],"3553":[114,38,114,43],"3561":[114,44,114,45],"3569":[114,38,114,46],"3577":[114,38,114,50],"3585":[114,30,114,51],"3587":[114,30,114,37],"3593":[114,30,114,51],"3601":[114,21,114,52],"3609":[115,19,116,18],"3617":[117,21,117,25],"3625":[117,29,117,35],"3633":[118,21,118,27],"3641":[118,32,118,37],"3649":[118,38,118,39],"3657":[118,32,118,40],"3665":[118,21,118,41],"3667":[118,21,118,31],"3673":[118,21,118,42],"3681":[119,21,119,26],"3689":[119,27,119,28],"3697":[119,32,119,38],"3705":[119,21,119,38],"3713":[119,21,119,39],"3721":[122,38,122,42],"3729":[122,61,122,66],"3737":[122,67,122,68],"3745":[122,61,122,69],"3753":[122,71,122,76],"3761":[122,78,122,87],"3769":[122,89,122,98],"3777":[122,100,122,101],"3785":[122,34,122,102],"3787":[122,38,122,60],"3793":[122,34,122,102],"3801":[122,25,122,103],"3809":[123,25,123,30],"3817":[123,31,123,32],"3825":[123,36,123,42],"3833":[123,25,123,42],"3841":[123,25,123,43],"3849":[125,35,125,44],"3857":[125,45,125,55],"3865":[125,57,125,62],"3873":[125,63,125,64],"3881":[125,57,125,65],"3889":[125,67,125,72],"3897":[125,67,125,78],"3905":[125,31,125,79],"3913":[125,31,125,79],"3921":[125,25,125,80],"3929":[124,23,126,22],"3937":[131,12,131,17],"3945":[131,12,131,17],"3953":[131,5,131,18],"3961":[83,32,132,2],"3969":[83,32,132,2],"3977":[83,32,132,2],"3985":[83,32,132,2],"3993":[83,32,132,2],"4001":[83,32,132,2],"4009":[83,32,132,2],"4017":[83,32,132,2],"4025":[83,32,132,2],"4033":[83,32,132,2],"4041":[83,32,132,2],"4049":[83,32,132,2],"4057":[83,1,132,2],"4065":[83,1,132,3],"4073":[134,11,134,15],"4081":[134,19,134,25],"4089":[135,16,135,25],"4097":[135,16,135,25],"4105":[135,9,135,26],"4113":[136,16,136,21],"4121":[136,16,136,26],"4129":[136,29,136,32],"4137":[136,41,136,47],"4145":[136,53,136,59],"4153":[136,41,136,60],"4155":[136,41,136,52],"4161":[136,66,136,70],"4169":[136,66,136,77],"4177":[136,90,136,92],"4185":[136,16,136,32],"4193":[136,16,136,32],"4201":[136,41,136,60],"4209":[136,41,136,60],"4217":[136,66,136,77],"4225":[136,66,136,77],"4233":[136,90,136,92],"4241":[136,90,136,92],"4257":[137,12,137,13],"4265":[137,12,137,15],"4281":[138,15,138,19],"4289":[138,20,138,21],"4297":[138,15,138,22],"4305":[138,15,138,22],"4313":[138,9,138,23],"4321":[139,13,139,14],"4329":[139,19,139,22],"4337":[139,31,139,35],"4345":[139,19,139,36],"4347":[139,19,139,30],"4353":[140,13,140,20],"4361":[140,35,140,39],"4369":[140,35,140,39],"4377":[140,13,140,41],"4385":[141,13,141,21],"4393":[141,22,141,25],"4401":[141,36,141,40],"4409":[141,36,141,47],"4417":[141,22,141,48],"4419":[141,22,141,35],"4425":[141,52,141,58],"4433":[141,59,141,62],"4441":[141,52,141,63],"4449":[141,13,141,63],"4457":[141,13,141,64],"4465":[144,12,144,19],"4473":[144,23,144,31],"4481":[144,35,144,44],"4489":[144,12,144,44],"4497":[144,5,144,45],"4505":[133,1,145,2],"4513":[133,1,145,2],"4521":[133,1,145,2],"4529":[133,1,145,2],"4537":[133,1,145,2],"4545":[133,1,145,2],"4553":[133,1,145,2],"4561":[133,1,145,2],"4569":[133,1,145,2],"4577":[133,1,145,2],"4585":[133,1,145,2],"4593":[146,1,146,7],"4601":[146,18,146,31],"4609":[146,1,146,31],"4617":[146,1,146,32],"4625":[1,1,146,32],"4633":[1,1,146,32],"4641":[1,1,146,32],"4649":[1,1,146,32],"4657":[1,1,146,32],"4665":[1,1,146,32],"4673":[1,1,146,32],"4681":[1,1,146,32],"4689":[8,1,30,2],"4697":[1,1,146,32],"4705":[133,1,145,2],"4713":[1,1,146,32],"4721":[9,5,11,6],"4729":[9,5,11,6],"4737":[26,9,27,25],"4745":[24,18,29,6],"4753":[24,18,29,6],"4761":[8,1,30,2],"4769":[8,1,30,2],"4777":[36,9,38,10],"4785":[41,9,43,10],"4793":[44,9,46,10],"4801":[49,13,52,14],"4809":[54,17,56,18],"4817":[53,49,58,14],"4825":[53,49,58,14],"4833":[47,9,59,10],"4841":[47,9,59,10],"4849":[35,55,60,6],"4857":[35,55,60,6],"4865":[34,38,61,2],"4873":[34,38,61,2],"4881":[64,5,65,32],"4889":[67,5,69,6],"4897":[71,9,72,19],"4905":[74,9,75,22],"4913":[77,9,79,10],"4921":[70,5,80,6],"4929":[70,5,80,6],"4937":[62,42,82,2],"4945":[62,42,82,2],"4953":[86,9,88,10],"4961":[85,5,90,6],"4969":[93,9,97,10],"4977":[91,5,98,6],"4985":[101,9,103,10],"4993":[104,9,106,10],"5001":[117,17,127,18],"5009":[108,13,128,14],"5017":[107,9,129,10],"5025":[100,5,130,6],"5033":[83,32,132,2],"5041":[83,32,132,2],"5049":[134,5,135,26],"5057":[139,9,142,10],"5065":[137,5,143,6],"5073":[133,1,145,2],"5081":[133,1,145,2],"5089":[1,1,146,32],"5097":[1,1,146,32],"nBranches":88,"originalCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/mongoose/lib/schema/documentarray.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/node-flarum/node_modules/mongoose/lib/schema/documentarray_jalangi_.js","code":"/* eslint no-empty: 1 */\n\n/*!\n * Module dependencies.\n */\n\nvar ArrayType = require('./array');\nvar CastError = require('../error/cast');\nvar MongooseDocumentArray = require('../types/documentarray');\nvar SchemaType = require('../schematype');\nvar Subdocument = require('../types/embedded');\n\n/**\n * SubdocsArray SchemaType constructor\n *\n * @param {String} key\n * @param {Schema} schema\n * @param {Object} options\n * @inherits SchemaArray\n * @api public\n */\n\nfunction DocumentArray(key, schema, options) {\n  // compile an embedded document for this schema\n  function EmbeddedDocument() {\n    Subdocument.apply(this, arguments);\n  }\n\n  EmbeddedDocument.prototype = Object.create(Subdocument.prototype);\n  EmbeddedDocument.prototype.$__setSchema(schema);\n  EmbeddedDocument.schema = schema;\n\n  // apply methods\n  for (var i in schema.methods)\n    EmbeddedDocument.prototype[i] = schema.methods[i];\n\n  // apply statics\n  for (i in schema.statics)\n    EmbeddedDocument[i] = schema.statics[i];\n\n  EmbeddedDocument.options = options;\n\n  ArrayType.call(this, key, EmbeddedDocument, options);\n\n  this.schema = schema;\n  var path = this.path;\n  var fn = this.defaultValue;\n\n  this.default(function() {\n    var arr = fn.call(this);\n    if (!Array.isArray(arr)) arr = [arr];\n    return new MongooseDocumentArray(arr, path, this);\n  });\n}\n\n/**\n * This schema type's name, to defend against minifiers that mangle\n * function names.\n *\n * @api public\n */\nDocumentArray.schemaName = 'DocumentArray';\n\n/*!\n * Inherits from ArrayType.\n */\nDocumentArray.prototype = Object.create( ArrayType.prototype );\nDocumentArray.prototype.constructor = DocumentArray;\n\n/**\n * Performs local validations first, then validations on each embedded doc\n *\n * @api private\n */\n\nDocumentArray.prototype.doValidate = function(array, fn, scope, options) {\n  SchemaType.prototype.doValidate.call(this, array, function(err) {\n    if (err) {\n      return fn(err);\n    }\n\n    var count = array && array.length;\n    var error;\n\n    if (!count) {\n      return fn();\n    }\n    if (options && options.updateValidator) {\n      return fn();\n    }\n\n    // handle sparse arrays, do not use array.forEach which does not\n    // iterate over sparse elements yet reports array.length including\n    // them :(\n\n    for (var i = 0, len = count; i < len; ++i) {\n      // sidestep sparse entries\n      var doc = array[i];\n      if (!doc) {\n        --count || fn(error);\n        continue;\n      }\n\n      doc.validate({ __noPromise: true }, function(err) {\n        if (err) {\n          error = err;\n        }\n        --count || fn(error);\n      });\n    }\n  }, scope);\n};\n\n/**\n * Performs local validations first, then validations on each embedded doc.\n *\n * ####Note:\n *\n * This method ignores the asynchronous validators.\n *\n * @return {MongooseError|undefined}\n * @api private\n */\n\nDocumentArray.prototype.doValidateSync = function(array, scope) {\n  var schemaTypeError = SchemaType.prototype.doValidateSync.call(this, array, scope);\n  if (schemaTypeError) return schemaTypeError;\n\n  var count = array && array.length,\n      resultError = null;\n\n  if (!count) {\n    return;\n  }\n\n  // handle sparse arrays, do not use array.forEach which does not\n  // iterate over sparse elements yet reports array.length including\n  // them :(\n\n  for (var i = 0, len = count; i < len; ++i) {\n    // only first error\n    if ( resultError ) break;\n    // sidestep sparse entries\n    var doc = array[i];\n    if (!doc) continue;\n\n    var subdocValidateError = doc.validateSync();\n\n    if (subdocValidateError) {\n      resultError = subdocValidateError;\n    }\n  }\n\n  return resultError;\n};\n\n/**\n * Casts contents\n *\n * @param {Object} value\n * @param {Document} document that triggers the casting\n * @api private\n */\n\nDocumentArray.prototype.cast = function(value, doc, init, prev, options) {\n  var selected,\n      subdoc,\n      i;\n\n  if (!Array.isArray(value)) {\n    // gh-2442 mark whole array as modified if we're initializing a doc from\n    // the db and the path isn't an array in the document\n    if (!!doc && init) {\n      doc.markModified(this.path);\n    }\n    return this.cast([value], doc, init, prev);\n  }\n\n  if (!(value && value.isMongooseDocumentArray) &&\n      (!options || !options.skipDocumentArrayCast)) {\n    value = new MongooseDocumentArray(value, this.path, doc);\n    if (prev && prev._handlers) {\n      for (var key in prev._handlers) {\n        doc.removeListener(key, prev._handlers[key]);\n      }\n    }\n  }\n\n  i = value.length;\n\n  while (i--) {\n    if (!value[i]) {\n      continue;\n    }\n    // Check if the document has a different schema (re gh-3701)\n    if ((value[i] instanceof Subdocument) &&\n        value[i].schema !== this.casterConstructor.schema) {\n      value[i] = value[i].toObject({ virtuals: false });\n    }\n    if (!(value[i] instanceof Subdocument) && value[i]) {\n      if (init) {\n        selected || (selected = scopePaths(this, doc.$__.selected, init));\n        subdoc = new this.casterConstructor(null, value, true, selected, i);\n        value[i] = subdoc.init(value[i]);\n      } else {\n        try {\n          subdoc = prev.id(value[i]._id);\n        } catch (e) {}\n\n        if (prev && subdoc) {\n          // handle resetting doc with existing id but differing data\n          // doc.array = [{ doc: 'val' }]\n          subdoc.set(value[i]);\n          // if set() is hooked it will have no return value\n          // see gh-746\n          value[i] = subdoc;\n        } else {\n          try {\n            subdoc = new this.casterConstructor(value[i], value, undefined,\n              undefined, i);\n            // if set() is hooked it will have no return value\n            // see gh-746\n            value[i] = subdoc;\n          } catch (error) {\n            throw new CastError('embedded', value[i], value._path);\n          }\n        }\n      }\n    }\n  }\n\n  return value;\n};\n\n/*!\n * Scopes paths selected in a query to this array.\n * Necessary for proper default application of subdocument values.\n *\n * @param {DocumentArray} array - the array to scope `fields` paths\n * @param {Object|undefined} fields - the root fields selected in the query\n * @param {Boolean|undefined} init - if we are being created part of a query result\n */\n\nfunction scopePaths(array, fields, init) {\n  if (!(init && fields)) return undefined;\n\n  var path = array.path + '.',\n      keys = Object.keys(fields),\n      i = keys.length,\n      selected = {},\n      hasKeys,\n      key;\n\n  while (i--) {\n    key = keys[i];\n    if (0 === key.indexOf(path)) {\n      hasKeys || (hasKeys = true);\n      selected[key.substring(path.length)] = fields[key];\n    }\n  }\n\n  return hasKeys && selected || undefined;\n}\n\n/*!\n * Module exports.\n */\n\nmodule.exports = DocumentArray;\n"}