<?php
    function html5_insert_image($html, $id, $caption, $title, $align, $url) {
      $src  = wp_get_attachment_image_src( $id, $size, false );
      $srcWebp = substr_replace($src[0] , 'webp', strrpos($src[0] , '.') +1);
      $html5 = "<picture id='post-$id media-$id' class='align$align'>";
      $html5 .= "<source srcset='$srcWebp' alt='$title' type='image/webp' />";
      $html5 .= "<img src='$src[0]' alt='$title' />";
      $html5 .= "</picture>";
      return $html5;
    }
    add_filter( 'image_send_to_editor', 'html5_insert_image', 10, 9 );
?>