var xferlog = require('../');
var lines = [
    {
        line: 'Fri Jul 17 15:17:06 2015 1 10.1.20.112 13335 /storage/resized1/img/archive/photos/auto/photo/13460/1346091/134609123/134609123bl.jpg b _ i r img ftp 0 * c',
        parsed: {
            'current-time': new Date('Fri Jul 17 15:17:06 2015').valueOf(),
            'transfer-time': 1,
            'remote-host': '10.1.20.112',
            'file-size': 13335,
            'filename': '/storage/resized1/img/archive/photos/auto/photo/13460/1346091/134609123/134609123bl.jpg',
            'transfer-type': 'b',
            'special-action-flag': '_',
            'direction': 'i',
            'access-mode': 'r',
            'username': 'img',
            'service-name': 'ftp',
            'authentication-method': 0,
            'authenticated-user-id': '*',
            'completion-status': 'c'
        }
    },
    {
        line: 'Sat Aug  1 03:29:09 2015 1 10.1.20.201 0 /storage/resized1/img/archive/photos/dom/photo/4734/473444/47344433/.lock b _ i r img ftp 0 * c',
        parsed: {
            'current-time': new Date('Sat Aug  1 03:29:09 2015').valueOf(),
            'transfer-time': 1,
            'remote-host': '10.1.20.201',
            'file-size': 0,
            'filename': '/storage/resized1/img/archive/photos/dom/photo/4734/473444/47344433/.lock',
            'transfer-type': 'b',
            'special-action-flag': '_',
            'direction': 'i',
            'access-mode': 'r',
            'username': 'img',
            'service-name': 'ftp',
            'authentication-method': 0,
            'authenticated-user-id': '*',
            'completion-status': 'c'
        }
    }
];

describe('xferlog Tests', function () {

    it("Parce line", function () {
        for (var i in lines) {
            var line = lines[i].line;
            var parsedLine = xferlog(line);
            for (var j of Object.keys(lines[i].parsed)) {
                expect(parsedLine[j].valueOf()).toEqual(lines[i].parsed[j]);
            }
        }
    });
});
