/root/Targets/graphql-faker
└─┬ graphql-faker@1.4.0 
  ├─┬ body-parser@1.18.1 
  │ ├── bytes@3.0.0 
  │ ├── content-type@1.0.4 
  │ ├─┬ debug@2.6.8 
  │ │ └── ms@2.0.0 
  │ ├── depd@1.1.1 
  │ ├─┬ http-errors@1.6.2 
  │ │ └── inherits@2.0.3 
  │ ├── iconv-lite@0.4.19 
  │ ├─┬ on-finished@2.3.0 
  │ │ └── ee-first@1.1.1 
  │ ├── qs@6.5.1 
  │ ├─┬ raw-body@2.3.2 
  │ │ └── unpipe@1.0.0 
  │ └─┬ type-is@1.6.15 
  │   ├── media-typer@0.3.0 
  │   └─┬ mime-types@2.1.17 
  │     └── mime-db@1.30.0 
  ├─┬ chalk@2.1.0 
  │ ├─┬ ansi-styles@3.2.0 
  │ │ └─┬ color-convert@1.9.0 
  │ │   └── color-name@1.1.3 
  │ ├── escape-string-regexp@1.0.5 
  │ └─┬ supports-color@4.4.0 
  │   └── has-flag@2.0.0 
  ├── core-js@2.5.1 
  ├─┬ cors@2.8.4 
  │ ├── object-assign@4.1.1 
  │ └── vary@1.1.1 
  ├─┬ express@4.15.4 
  │ ├─┬ accepts@1.3.4 
  │ │ └── negotiator@0.6.1 
  │ ├── array-flatten@1.1.1 
  │ ├── content-disposition@0.5.2 
  │ ├── cookie@0.3.1 
  │ ├── cookie-signature@1.0.6 
  │ ├── encodeurl@1.0.1 
  │ ├── escape-html@1.0.3 
  │ ├── etag@1.8.1 
  │ ├── finalhandler@1.0.5 
  │ ├── fresh@0.5.0 
  │ ├── merge-descriptors@1.0.1 
  │ ├── methods@1.1.2 
  │ ├── parseurl@1.3.2 
  │ ├── path-to-regexp@0.1.7 
  │ ├─┬ proxy-addr@1.1.5 
  │ │ ├── forwarded@0.1.2 
  │ │ └── ipaddr.js@1.4.0 
  │ ├── qs@6.5.0 
  │ ├── range-parser@1.2.0 
  │ ├─┬ send@0.15.4 
  │ │ ├── destroy@1.0.4 
  │ │ └── mime@1.3.4 
  │ ├── serve-static@1.12.4 
  │ ├── setprototypeof@1.0.3 
  │ ├── statuses@1.3.1 
  │ └── utils-merge@1.0.0 
  ├── express-graphql@0.6.2  (git://github.com/apis-guru/express-graphql.git#90ff36c20d49e7cec0b64846d0481f75b93d4ae6)
  ├── faker@4.1.0 
  ├─┬ graphql@0.9.1  (git://github.com/apis-guru/graphql-js.git#96b1ce3a0e578545dc3958f8b3457e9a535d73a9)
  │ └── iterall@1.0.3 
  ├── lodash@4.17.4 
  ├─┬ node-fetch@1.7.3 
  │ ├── encoding@0.1.12 
  │ └── is-stream@1.1.0 
  ├─┬ opn@5.1.0 
  │ └── is-wsl@1.1.0 
  └─┬ yargs@9.0.1 
    ├── camelcase@4.1.0 
    ├─┬ cliui@3.2.0 
    │ ├─┬ string-width@1.0.2 
    │ │ ├── code-point-at@1.1.0 
    │ │ └─┬ is-fullwidth-code-point@1.0.0 
    │ │   └── number-is-nan@1.0.1 
    │ ├─┬ strip-ansi@3.0.1 
    │ │ └── ansi-regex@2.1.1 
    │ └─┬ wrap-ansi@2.1.0 
    │   └── string-width@1.0.2 
    ├── decamelize@1.2.0 
    ├── get-caller-file@1.0.2 
    ├─┬ os-locale@2.1.0 
    │ ├─┬ execa@0.7.0 
    │ │ ├─┬ cross-spawn@5.1.0 
    │ │ │ ├─┬ lru-cache@4.1.1 
    │ │ │ │ ├── pseudomap@1.0.2 
    │ │ │ │ └── yallist@2.1.2 
    │ │ │ ├─┬ shebang-command@1.2.0 
    │ │ │ │ └── shebang-regex@1.0.0 
    │ │ │ └─┬ which@1.3.0 
    │ │ │   └── isexe@2.0.0 
    │ │ ├── get-stream@3.0.0 
    │ │ ├─┬ npm-run-path@2.0.2 
    │ │ │ └── path-key@2.0.1 
    │ │ ├── p-finally@1.0.0 
    │ │ ├── signal-exit@3.0.2 
    │ │ └── strip-eof@1.0.0 
    │ ├─┬ lcid@1.0.0 
    │ │ └── invert-kv@1.0.0 
    │ └─┬ mem@1.1.0 
    │   └── mimic-fn@1.1.0 
    ├─┬ read-pkg-up@2.0.0 
    │ ├─┬ find-up@2.1.0 
    │ │ └─┬ locate-path@2.0.0 
    │ │   ├─┬ p-locate@2.0.0 
    │ │   │ └── p-limit@1.1.0 
    │ │   └── path-exists@3.0.0 
    │ └─┬ read-pkg@2.0.0 
    │   ├─┬ load-json-file@2.0.0 
    │   │ ├── graceful-fs@4.1.11 
    │   │ ├─┬ parse-json@2.2.0 
    │   │ │ └─┬ error-ex@1.3.1 
    │   │ │   └── is-arrayish@0.2.1 
    │   │ ├── pify@2.3.0 
    │   │ └── strip-bom@3.0.0 
    │   ├─┬ normalize-package-data@2.4.0 
    │   │ ├── hosted-git-info@2.5.0 
    │   │ ├─┬ is-builtin-module@1.0.0 
    │   │ │ └── builtin-modules@1.1.1 
    │   │ ├── semver@5.4.1 
    │   │ └─┬ validate-npm-package-license@3.0.1 
    │   │   ├─┬ spdx-correct@1.0.2 
    │   │   │ └── spdx-license-ids@1.2.2 
    │   │   └── spdx-expression-parse@1.0.4 
    │   └── path-type@2.0.0 
    ├── require-directory@2.1.1 
    ├── require-main-filename@1.0.1 
    ├── set-blocking@2.0.0 
    ├─┬ string-width@2.1.1 
    │ ├── is-fullwidth-code-point@2.0.0 
    │ └─┬ strip-ansi@4.0.0 
    │   └── ansi-regex@3.0.0 
    ├── which-module@2.0.0 
    ├── y18n@3.2.1 
    └── yargs-parser@7.0.0 

Setup Done exists, not setting up
:../FeatureTester/libs/:/root/Targets/graphql-faker/node_modules
Set Default Z3_PATH to ./node_modules/z3javascript/bin/libz3.so
ExpoSE Master: /root/ExpoSE/lib/Harness/src/harness.js max concurrent: 16 max paths: 1000000
Setting timeout to 900000
*** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [1 done /0 queued / 0 running / 1 errors / 33% coverage ] ***
*-- Stat Module Output --*
*-- concretizations: ["defineProperty","bound log"]
*-- Stat Module Done --*
*-- Test Case {"_bound":0} start 0.0515 took 3.3099s
*-- Errors occured in test {"_bound":0}
* Error: Tropigate failed because SyntaxError: Unexpected character '#' (1:78) on program #!/usr/bin/env node
"use strict";
var __assign = (this && this.__assign) || Object.assign || function(t) {
    for (var s, i = 1, n = arguments.length; i < n; i++) {
        s = arguments[i];
        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))
            t[p] = s[p];
    }
    return t;
};
Object.defineProperty(exports, "__esModule", { value: true });
require("core-js/shim");
var graphql_1 = require("graphql");
var fs = require("fs");
var path = require("path");
var express = require("express");
var graphqlHTTP = require("express-graphql");
var chalk = require("chalk");
var fake_schema_1 = require("./fake_schema");
var proxy_1 = require("./proxy");
var utils_1 = require("./utils");
var opn = require("opn");
var cors = require('cors');
var pick = require('lodash/pick');
var DEFAULT_PORT = process.env.PORT || 9002;
var argv = require('yargs')
    .usage('Usage: $0 [file]')
    .alias('p', 'port')
    .nargs('p', 1)
    .describe('p', 'HTTP Port')
    .default('p', DEFAULT_PORT)
    .alias('e', 'extend')
    .nargs('e', 1)
    .describe('e', 'URL to existing GraphQL server to extend')
    .alias('o', 'open')
    .describe('o', 'Open page with IDL editor and GraphiQL in browser')
    .alias('H', 'header')
    .describe('H', 'Specify headers to the proxied server in cURL format,' +
    'e.g.: "Authorization: bearer XXXXXXXXX"')
    .nargs('H', 1)
    .implies('header', 'extend')
    .describe('forward-headers', 'Headers that should be forwarded to the proxied server')
    .array('forward-headers')
    .implies('forward-headers', 'extend')
    .alias('co', 'cors-origin')
    .nargs('co', 1)
    .describe('co', 'CORS: Define Access-Control-Allow-Origin header')
    .help('h')
    .alias('h', 'help')
    .epilog("Examples:\n\n  # Mock GraphQL API based on example IDL and open interactive editor\n  $0 --open\n\n  # Extend real data from SWAPI with faked data based on extension IDL\n  $0 ./ext-swapi.grqphql --extend http://swapi.apis.guru/\n\n  # Extend real data from GitHub API with faked data based on extension IDL\n  $0 ./ext-gh.graphql --extend https://api.github.com/graphql \\\n  --header \"Authorization: bearer <TOKEN>\"")
    .argv;
var log = console.log;
var headers = {};
if (argv.header) {
    var headerStrings = Array.isArray(argv.header) ? argv.header : [argv.header];
    for (var _i = 0, headerStrings_1 = headerStrings; _i < headerStrings_1.length; _i++) {
        var str = headerStrings_1[_i];
        var index = str.indexOf(':');
        var name = str.substr(0, index);
        var value = str.substr(index + 1).trim();
        headers[name] = value;
    }
}
var forwardHeaderNames = (argv.forwardHeaders || []).map(function (str) { return str.toLowerCase(); });
var fileArg = argv._[0];
var fileName = fileArg || (argv.extend ?
    './schema_extension.faker.graphql' :
    './schema.faker.graphql');
var fakeDefinitionAST = readAST(path.join(__dirname, 'fake_definition.graphql'));
var corsOptions = {};
if (argv.co) {
    corsOptions['origin'] = argv.co;
    corsOptions['credentials'] = true;
}
var userIDL;
if (utils_1.existsSync(fileName)) {
    userIDL = readIDL(fileName);
}
else {
    // different default IDLs for extend and non-extend modes
    var defaultFileName = argv.e ? 'default-extend.graphql' : 'default-schema.graphql';
    userIDL = readIDL(path.join(__dirname, defaultFileName));
}
var bodyParser = require('body-parser');
function readIDL(filepath) {
    return new graphql_1.Source(fs.readFileSync(filepath, 'utf-8'), filepath);
}
function readAST(filepath) {
    return graphql_1.parse(readIDL(filepath));
}
function saveIDL(idl) {
    fs.writeFileSync(fileName, idl);
    log(chalk.green('✚') + " schema saved to " + chalk.magenta(fileName) + " on " + (new Date()).toLocaleString());
    return new graphql_1.Source(idl, fileName);
}
if (argv.e) {
    // run in proxy mode
    var url_1 = argv.e;
    proxy_1.proxyMiddleware(url_1, headers)
        .then(function (_a) {
        var schemaIDL = _a[0], cb = _a[1];
        schemaIDL = new graphql_1.Source(schemaIDL, "Inrospection from \"" + url_1 + "\"");
        runServer(schemaIDL, userIDL, cb);
    })
        .catch(function (error) {
        log(chalk.red(error.stack));
        process.exit(1);
    });
}
else {
    runServer(userIDL, null, function (schema) {
        fake_schema_1.fakeSchema(schema);
        return { schema: schema };
    });
}
function buildServerSchema(idl) {
    var ast = graphql_1.concatAST([graphql_1.parse(idl), fakeDefinitionAST]);
    return graphql_1.buildASTSchema(ast);
}
function runServer(schemaIDL, extensionIDL, optionsCB) {
    var app = express();
    if (extensionIDL) {
        var schema = buildServerSchema(schemaIDL);
        extensionIDL.body = extensionIDL.body.replace('<RootTypeName>', schema.getQueryType().name);
    }
    app.options('/graphql', cors(corsOptions));
    app.use('/graphql', cors(corsOptions), graphqlHTTP(function (req) {
        var schema = buildServerSchema(schemaIDL);
        var forwardHeaders = pick(req.headers, forwardHeaderNames);
        return __assign({}, optionsCB(schema, extensionIDL, forwardHeaders), { graphiql: true });
    }));
    app.get('/user-idl', function (_, res) {
        res.status(200).json({
            schemaIDL: schemaIDL.body,
            extensionIDL: extensionIDL && extensionIDL.body,
        });
    });
    app.use('/user-idl', bodyParser.text());
    app.post('/user-idl', function (req, res) {
        try {
            if (extensionIDL === null)
                schemaIDL = saveIDL(req.body);
            else
                extensionIDL = saveIDL(req.body);
            res.status(200).send('ok');
        }
        catch (err) {
            res.status(500).send(err.message);
        }
    });
    app.use('/editor', express.static(path.join(__dirname, 'editor')));
    app.listen(argv.port);
    log("\n" + chalk.green('✔') + " Your GraphQL Fake API is ready to use \uD83D\uDE80\n  Here are your links:\n\n  " + chalk.blue('❯') + " Interactive Editor:\t http://localhost:" + argv.port + "/editor\n  " + chalk.blue('❯') + " GraphQL API:\t http://localhost:" + argv.port + "/graphql\n\n  ");
    if (!fileArg) {
        log(chalk.yellow("Default file " + chalk.magenta(fileName) + " is used. " +
            "Specify [file] parameter to change."));
    }
    if (argv.open) {
        setTimeout(function () { return opn("http://localhost:" + argv.port + "/editor"); }, 500);
    }
}
//# sourceMappingURL=index.js.map at SyntaxError: Unexpected character '#' (1:78)
    at Parser.pp$4.raise (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2221:15)
    at Parser.pp$7.getTokenFromCode (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2756:10)
    at Parser.pp$7.readToken (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2477:17)
    at Parser.readToken (/root/ExpoSE/lib/Tropigate/bin/Tokens.js:124:26)
    at Parser.pp$7.nextToken (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2468:15)
    at Parser.pp$7.next (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2413:10)
    at Parser.pp.eat (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:536:12)
    at Parser.pp.semicolon (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:581:15)
    at Parser.pp$1.parseVarStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:918:10)
    at Parser.pp$1.parseStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:706:19)
*-- Replay with NO_COMPILE=1 expoSE replay '/root/ExpoSE/lib/Harness/src/harness.js' '{"_bound":0}'
*-- Coverage Data
*- File /root/ExpoSE/lib/Harness/src/harness.js. Coverage (Term): 18% Coverage (LOC): 24%
*- File /root/ExpoSE/lib/S$/bin/symbols.js. Coverage (Term): 16% Coverage (LOC): 34%
*- Re-run with EXPOSE_PRINT_COVERAGE=1 to print line by line coverage information
** ExpoSE Finished. 1 paths with 1 errors **
