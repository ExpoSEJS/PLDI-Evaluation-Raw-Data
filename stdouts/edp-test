
> ws@0.4.32 install /root/Targets/edp-test/node_modules/ws
> (node-gyp rebuild 2> builderror.log) || (exit 0)

make: Entering directory '/root/Targets/edp-test/node_modules/ws/build'
  CXX(target) Release/obj.target/bufferutil/src/bufferutil.o
bufferutil.target.mk:96: recipe for target 'Release/obj.target/bufferutil/src/bufferutil.o' failed
make: Leaving directory '/root/Targets/edp-test/node_modules/ws/build'
/root/Targets/edp-test
└─┬ edp-test@1.1.1 
  ├─┬ chokidar@0.8.4 
  │ └── recursive-readdir@0.0.2 
  ├─┬ edp-browser-launcher2@0.4.5 
  │ ├── headless@0.1.7 
  │ ├── lodash@2.4.2 
  │ ├── mkdirp@0.5.1 
  │ ├─┬ osenv@0.1.4 
  │ │ ├── os-homedir@1.0.2 
  │ │ └── os-tmpdir@1.0.2 
  │ ├─┬ plist@1.2.0 
  │ │ ├── base64-js@0.0.8 
  │ │ ├── util-deprecate@1.0.2 
  │ │ ├─┬ xmlbuilder@4.0.0 
  │ │ │ └── lodash@3.10.1 
  │ │ └── xmldom@0.1.27 
  │ └─┬ win-detect-browsers@0.0.2 
  │   └─┬ which@1.3.0 
  │     └── isexe@2.0.0 
  ├── edp-config@1.0.2 
  ├─┬ edp-core@1.0.32 
  │ ├─┬ chalk@1.0.0 
  │ │ ├── ansi-styles@2.2.1 
  │ │ ├── escape-string-regexp@1.0.5 
  │ │ ├─┬ has-ansi@1.0.3 
  │ │ │ ├── ansi-regex@1.1.1 
  │ │ │ └── get-stdin@4.0.1 
  │ │ ├── strip-ansi@2.0.1 
  │ │ └── supports-color@1.3.1 
  │ ├── esprima@2.2.0 
  │ ├── estraverse@4.1.1 
  │ ├─┬ glob@5.0.15 
  │ │ ├─┬ inflight@1.0.6 
  │ │ │ └── wrappy@1.0.2 
  │ │ ├── inherits@2.0.3 
  │ │ ├── once@1.4.0 
  │ │ └── path-is-absolute@1.0.1 
  │ ├── iconv-lite@0.4.19 
  │ ├─┬ minimatch@2.0.10 
  │ │ └─┬ brace-expansion@1.1.8 
  │ │   ├── balanced-match@1.0.0 
  │ │   └── concat-map@0.0.1 
  │ └── semver@4.3.6 
  ├─┬ edp-project@0.7.2 
  │ ├── async@0.9.2 
  │ ├─┬ edp-package@0.7.1 
  │ │ ├── adm-zip@0.4.7 
  │ │ ├─┬ fstream@0.1.31 
  │ │ │ └─┬ rimraf@2.6.2 
  │ │ │   └─┬ glob@7.1.2 
  │ │ │     ├── fs.realpath@1.0.0 
  │ │ │     └── minimatch@3.0.4 
  │ │ ├── semver@3.0.1 
  │ │ └─┬ tar@0.1.20 
  │ │   └── block-stream@0.0.9 
  │ ├─┬ escodegen@1.4.3 
  │ │ ├── esprima@1.2.5 
  │ │ ├── estraverse@1.9.3 
  │ │ ├── esutils@1.1.6 
  │ │ ├─┬ optionator@0.4.0 
  │ │ │ ├── deep-is@0.1.3 
  │ │ │ ├── fast-levenshtein@1.0.7 
  │ │ │ ├── levn@0.2.5 
  │ │ │ ├── prelude-ls@1.1.2 
  │ │ │ └── type-check@0.3.2 
  │ │ └── source-map@0.1.43 
  │ ├── esprima@1.2.5 
  │ ├── estraverse@1.7.1 
  │ ├── mime@1.4.1 
  │ ├── mkdirp@0.3.5 
  │ └── semver@2.2.1 
  ├─┬ edp-webserver@1.2.11 
  │ ├─┬ babel-core@5.8.38 
  │ │ ├── babel-plugin-constant-folding@1.0.1 
  │ │ ├── babel-plugin-dead-code-elimination@1.0.2 
  │ │ ├── babel-plugin-eval@1.0.1 
  │ │ ├── babel-plugin-inline-environment-variables@1.0.1 
  │ │ ├── babel-plugin-jscript@1.0.4 
  │ │ ├── babel-plugin-member-expression-literals@1.0.1 
  │ │ ├── babel-plugin-property-literals@1.0.1 
  │ │ ├─┬ babel-plugin-proto-to-assign@1.0.4 
  │ │ │ └── lodash@3.10.1 
  │ │ ├── babel-plugin-react-constant-elements@1.0.3 
  │ │ ├── babel-plugin-react-display-name@1.0.3 
  │ │ ├── babel-plugin-remove-console@1.0.1 
  │ │ ├── babel-plugin-remove-debugger@1.0.1 
  │ │ ├── babel-plugin-runtime@1.0.7 
  │ │ ├─┬ babel-plugin-undeclared-variables-check@1.0.2 
  │ │ │ └── leven@1.0.2 
  │ │ ├── babel-plugin-undefined-to-void@1.1.6 
  │ │ ├── babylon@5.8.38 
  │ │ ├── bluebird@2.11.0 
  │ │ ├── convert-source-map@1.5.0 
  │ │ ├── core-js@1.2.7 
  │ │ ├─┬ debug@2.6.9 
  │ │ │ └── ms@2.0.0 
  │ │ ├─┬ detect-indent@3.0.1 
  │ │ │ └── minimist@1.2.0 
  │ │ ├── esutils@2.0.2 
  │ │ ├── fs-readdir-recursive@0.1.2 
  │ │ ├── globals@6.4.1 
  │ │ ├─┬ home-or-tmp@1.0.0 
  │ │ │ └── user-home@1.1.1 
  │ │ ├─┬ is-integer@1.0.7 
  │ │ │ └─┬ is-finite@1.0.2 
  │ │ │   └── number-is-nan@1.0.1 
  │ │ ├── js-tokens@1.0.1 
  │ │ ├── json5@0.4.0 
  │ │ ├── lodash@3.10.1 
  │ │ ├─┬ output-file-sync@1.1.2 
  │ │ │ ├── graceful-fs@4.1.11 
  │ │ │ └── object-assign@4.1.1 
  │ │ ├── path-exists@1.0.0 
  │ │ ├── private@0.1.7 
  │ │ ├─┬ regenerator@0.8.40 
  │ │ │ ├─┬ commoner@0.10.8 
  │ │ │ │ ├── commander@2.11.0 
  │ │ │ │ ├─┬ detective@4.5.0 
  │ │ │ │ │ ├── acorn@4.0.13 
  │ │ │ │ │ └── defined@1.0.0 
  │ │ │ │ ├── graceful-fs@4.1.11 
  │ │ │ │ ├── q@1.5.0 
  │ │ │ │ └─┬ recast@0.11.23 
  │ │ │ │   ├── ast-types@0.9.6 
  │ │ │ │   ├── esprima@3.1.3 
  │ │ │ │   └── source-map@0.5.7 
  │ │ │ ├─┬ defs@1.1.1 
  │ │ │ │ ├─┬ alter@0.2.0 
  │ │ │ │ │ └── stable@0.1.6 
  │ │ │ │ ├── ast-traverse@0.1.1 
  │ │ │ │ ├── breakable@1.0.0 
  │ │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │ │ │ │ ├── simple-fmt@0.1.0 
  │ │ │ │ ├── simple-is@0.2.0 
  │ │ │ │ ├── stringmap@0.2.2 
  │ │ │ │ ├── stringset@0.2.1 
  │ │ │ │ ├── tryor@0.1.2 
  │ │ │ │ └─┬ yargs@3.27.0 
  │ │ │ │   ├── camelcase@1.2.1 
  │ │ │ │   ├─┬ cliui@2.1.0 
  │ │ │ │   │ ├─┬ center-align@0.1.3 
  │ │ │ │   │ │ ├─┬ align-text@0.1.4 
  │ │ │ │   │ │ │ ├─┬ kind-of@3.2.2 
  │ │ │ │   │ │ │ │ └── is-buffer@1.1.5 
  │ │ │ │   │ │ │ ├── longest@1.0.1 
  │ │ │ │   │ │ │ └── repeat-string@1.6.1 
  │ │ │ │   │ │ └── lazy-cache@1.0.4 
  │ │ │ │   │ ├── right-align@0.1.3 
  │ │ │ │   │ └── wordwrap@0.0.2 
  │ │ │ │   ├── decamelize@1.2.0 
  │ │ │ │   ├─┬ os-locale@1.4.0 
  │ │ │ │   │ └─┬ lcid@1.0.0 
  │ │ │ │   │   └── invert-kv@1.0.0 
  │ │ │ │   ├── window-size@0.1.4 
  │ │ │ │   └── y18n@3.2.1 
  │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │ │ │ ├─┬ recast@0.10.33 
  │ │ │ │ ├── ast-types@0.8.12 
  │ │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │ │ │ │ └── source-map@0.5.7 
  │ │ │ └── through@2.3.8 
  │ │ ├─┬ regexpu@1.3.0 
  │ │ │ ├── esprima@2.7.3 
  │ │ │ ├── regenerate@1.3.3 
  │ │ │ ├── regjsgen@0.2.0 
  │ │ │ └─┬ regjsparser@0.1.5 
  │ │ │   └── jsesc@0.5.0 
  │ │ ├── repeating@1.1.3 
  │ │ ├─┬ resolve@1.4.0 
  │ │ │ └── path-parse@1.0.5 
  │ │ ├── shebang-regex@1.0.0 
  │ │ ├── slash@1.0.0 
  │ │ ├── source-map@0.5.7 
  │ │ ├─┬ source-map-support@0.2.10 
  │ │ │ └── source-map@0.1.32 
  │ │ ├── to-fast-properties@1.0.3 
  │ │ ├── trim-right@1.0.1 
  │ │ └── try-resolve@1.0.1 
  │ ├── coffee-script@1.9.3 
  │ ├─┬ connect@3.3.5 
  │ │ ├─┬ debug@2.1.3 
  │ │ │ └── ms@0.7.0 
  │ │ ├─┬ finalhandler@0.3.4 
  │ │ │ ├─┬ debug@2.1.3 
  │ │ │ │ └── ms@0.7.0 
  │ │ │ ├── escape-html@1.0.1 
  │ │ │ └─┬ on-finished@2.2.1 
  │ │ │   └── ee-first@1.1.0 
  │ │ ├── parseurl@1.3.2 
  │ │ └── utils-merge@1.0.0 
  │ ├─┬ connect-logger@0.0.1 
  │ │ └── moment@2.18.1 
  │ ├─┬ handlebars@3.0.3 
  │ │ ├── optimist@0.6.1 
  │ │ └─┬ uglify-js@2.3.6 
  │ │   ├── async@0.2.10 
  │ │   └── optimist@0.3.7 
  │ ├── html2js@0.2.0 
  │ ├── http2@3.3.7 
  │ ├─┬ less@1.7.5 
  │ │ ├─┬ clean-css@2.2.23 
  │ │ │ └── commander@2.2.0 
  │ │ ├─┬ graceful-fs@3.0.11 
  │ │ │ └── natives@1.1.0 
  │ │ ├── mime@1.2.11 
  │ │ └─┬ request@2.40.0 
  │ │   ├── aws-sign2@0.5.0 
  │ │   ├── forever-agent@0.5.2 
  │ │   ├─┬ form-data@0.1.4 
  │ │   │ ├─┬ combined-stream@0.0.7 
  │ │   │ │ └── delayed-stream@0.0.5 
  │ │   │ └── mime@1.2.11 
  │ │   ├─┬ hawk@1.1.1 
  │ │   │ ├── boom@0.4.2 
  │ │   │ ├── cryptiles@0.2.2 
  │ │   │ ├── hoek@0.9.1 
  │ │   │ └── sntp@0.2.4 
  │ │   ├─┬ http-signature@0.10.1 
  │ │   │ ├── asn1@0.1.11 
  │ │   │ ├── assert-plus@0.1.5 
  │ │   │ └── ctype@0.5.3 
  │ │   ├── json-stringify-safe@5.0.1 
  │ │   ├── mime-types@1.0.2 
  │ │   ├── node-uuid@1.4.8 
  │ │   ├── oauth-sign@0.3.0 
  │ │   ├── qs@1.0.2 
  │ │   ├── stringstream@0.0.5 
  │ │   ├─┬ tough-cookie@2.3.3 
  │ │   │ └── punycode@1.4.1 
  │ │   └── tunnel-agent@0.4.3 
  │ ├─┬ markdown@0.5.0 
  │ │ └─┬ nopt@2.1.2 
  │ │   └── abbrev@1.1.1 
  │ ├─┬ path-to-regexp@1.1.1 
  │ │ └── isarray@0.0.1 
  │ ├─┬ postcss@5.2.17 
  │ │ ├─┬ chalk@1.1.3 
  │ │ │ ├─┬ has-ansi@2.0.0 
  │ │ │ │ └── ansi-regex@2.1.1 
  │ │ │ ├── strip-ansi@3.0.1 
  │ │ │ └── supports-color@2.0.0 
  │ │ ├── js-base64@2.3.2 
  │ │ ├── source-map@0.5.7 
  │ │ └─┬ supports-color@3.2.3 
  │ │   └── has-flag@1.0.0 
  │ ├─┬ stylus@0.51.1 
  │ │ ├── css-parse@1.7.0 
  │ │ ├─┬ glob@3.2.11 
  │ │ │ └── minimatch@0.3.0 
  │ │ ├── mkdirp@0.3.5 
  │ │ └── sax@0.5.8 
  │ └── underscore@1.8.3 
  ├─┬ istanbul@0.2.16 
  │ ├── abbrev@1.0.9 
  │ ├─┬ escodegen@1.3.3 
  │ │ ├── esprima@1.1.1 
  │ │ ├── estraverse@1.5.1 
  │ │ └── esutils@1.0.0 
  │ ├── esprima@1.2.5 
  │ ├─┬ fileset@0.1.8 
  │ │ ├─┬ glob@3.2.11 
  │ │ │ └── minimatch@0.3.0 
  │ │ └─┬ minimatch@0.4.0 
  │ │   ├── lru-cache@2.7.3 
  │ │   └── sigmund@1.0.1 
  │ ├─┬ handlebars@1.3.0 
  │ │ └── optimist@0.3.7 
  │ ├─┬ js-yaml@3.10.0 
  │ │ ├─┬ argparse@1.0.9 
  │ │ │ └── sprintf-js@1.0.3 
  │ │ └── esprima@4.0.0 
  │ ├── nopt@3.0.6 
  │ ├── resolve@0.7.4 
  │ ├── which@1.0.9 
  │ └── wordwrap@0.0.3 
  ├─┬ jasmine-node@2.0.0 
  │ ├── coffee-script@1.7.1 
  │ ├─┬ gaze@0.5.2 
  │ │ └─┬ globule@0.1.0 
  │ │   ├─┬ glob@3.1.21 
  │ │   │ ├── graceful-fs@1.2.3 
  │ │   │ └── inherits@1.0.2 
  │ │   ├── lodash@1.0.2 
  │ │   └── minimatch@0.2.14 
  │ ├─┬ jasmine-growl-reporter@0.2.1 
  │ │ └── growl@1.7.0 
  │ ├── minimist@0.0.8 
  │ ├── mkdirp@0.3.5 
  │ ├── underscore@1.6.0 
  │ └── walkdir@0.0.12 
  ├── qransi@0.0.2 
  ├─┬ socket.io@0.9.19 
  │ ├── base64id@0.1.0 
  │ ├── policyfile@0.0.4 
  │ ├── redis@0.7.3 
  │ └─┬ socket.io-client@0.9.16 
  │   └── uglify-js@1.2.5 
  ├─┬ socket.io-client@0.9.17 
  │ ├─┬ active-x-obfuscator@0.0.1 
  │ │ └── zeparser@0.0.5 
  │ ├── uglify-js@1.2.5 
  │ ├─┬ ws@0.4.32 
  │ │ ├── commander@2.1.0 
  │ │ ├── nan@1.0.0 
  │ │ ├── options@0.0.6 
  │ │ └── tinycolor@0.0.1 
  │ └── xmlhttprequest@1.4.2 
  ├─┬ source-map-closest-match@0.1.1 
  │ └── amdefine@1.0.1 
  └─┬ useragent@2.0.10 
    └── lru-cache@2.2.4 

Setup Done exists, not setting up
:../FeatureTester/libs/:/root/Targets/edp-test/node_modules
Set Default Z3_PATH to ./node_modules/z3javascript/bin/libz3.so
ExpoSE Master: /root/ExpoSE/lib/Harness/src/harness.js max concurrent: 16 max paths: 1000000
Setting timeout to 900000
*** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [1 done /0 queued / 0 running / 1 errors / 31% coverage ] ***
*-- Stat Module Output --*
*-- concretizations: ["defineProperty","bound log","random","reduce","RegExp","bind","defineProperties","call"]
*-- Stat Module Done --*
*-- Test Case {"_bound":0} start 0.0582 took 9.8477s
*-- Errors occured in test {"_bound":0}
* Error: Tropigate failed because SyntaxError: Unexpected token (8:4) on program /**
 * ER (Enterprise RIA)
 * Copyright 2013 Baidu Inc. All rights reserved.
 * 
 * @file Deferred类实现
 * @author otakustay
 */
var assert = require('assert');

/**
  * 尝试执行相关的回调函数
  * 
  * 当`deferred`处于非**pending**状态时，根据其状态，
  * 立即异步地运行对应的回调函数
  *
  * @param {Deferred} deferred 需要处理的`Deferred`实例
  */
function tryFlush(deferred) {
    if (deferred.state === 'pending') {
        return;
    }

    var callbacks = deferred.state === 'resolved'
        ? deferred._doneCallbacks.slice()
        : deferred._failCallbacks.slice();

    function flush() {
        for (var i = 0; i < callbacks.length; i++) {
            var callback = callbacks[i];
            try {
                // 回调时的this应该是`Promise`，没有`resolve`等方法
                callback.apply(deferred.promise, deferred._args);
            }
            catch (ex) {
            }
        }
    }

    if (deferred.syncModeEnabled) {
        flush();
    }
    else {
        process.nextTick(flush);
    }

    deferred._doneCallbacks = [];
    deferred._failCallbacks = [];
}

/**
  * 将一个原有的`Deferred`与一个新的`Deferred`对象连接起来
  * 
  * 该方法作为`then`方法的核心
  *
  * @param {Deferred} original 原`Deferred`对象
  * @param {Deferred} deferred 新`Deferred`对象
  * @param {callback} 当`original`运行完毕后，需要执行的函数
  * @param {string} actionType 关联的动作类型，`'resolve'`或`'reject'`
  * @return {function} 关联函数，可注册在`original`的相关回调函数上
  */
function pipe(original, deferred, callback, actionType) {
    return function () {
        // `.then(done)`及`.then(null, fail)`时使用
        // 
        // 根据`callback`的行为，进行以下处理：
        // 
        // - 如果`callback`返回值，则用该值改`deferred`为**resolved**
        // - 如果`callback`抛出异常，则用异常改`deferred`为**rejected**
        if (typeof callback === 'function') {
            var resolver = deferred.resolver;
            try {
                var returnValue = 
                    callback.apply(original.promise, arguments);

                if (Deferred.isPromise(returnValue)) {
                    returnValue.then(resolver.resolve, resolver.reject);
                }
                else {
                    resolver.resolve(returnValue);
                }
            }
            catch (error) {
                resolver.reject(error);
            }
        }
        // `.then()`及`.then(done, null)`时使用
        // 
        // 直接使用原`Deferred`保存的参数将`deferred`改为对应状态
        else {
            deferred[actionType].apply(deferred, original._args);
        }
    };
}

/**
  * Deferred类
  * 
  * 类似于jQuery的Deferred对象，是对异步操作的一种封装
  *
  * @constructor
  */
function Deferred() {
    this.state = 'pending';
    this._args = null;
    this._doneCallbacks = [];
    this._failCallbacks = [];

    /**
      * 与当前对象关联的`Promise`对象
      * 
      * 一个`Promise`对象是对`Deferred`对象的**只读**状态的表达，
      * `Promise`对象拥有所有添加回调函数的方法，包括：
      * 
      * - `done`
      * - `fail`
      * - `ensure`
      * - `then`
      * 
      * 但`Promise`对象并不包改变`Deferred`对象的方法，包括：
      * 
      * - `resolve`
      * - `reject`
      *
      * @type {Promise}
      * @public
      */
    this.promise =  {
        done: this.done.bind(this),
        fail: this.fail.bind(this),
        ensure: this.ensure.bind(this),
        then: this.then.bind(this)
    };
    // 形成环引用，保证`.promise.promise`能运行
    this.promise.promise = this.promise;


    /**
      * 与当前对象关联的`Resolver`对象
      * 
      * 一个`Resolver`对象是对`Deferred`对象的**只写**状态的表达，
      * `Resolver`对象拥有所有改变状态的方法，包括：
      * 
      * - `resolve`
      * - `reject
      *
      * @type {Resolver}
      * @public
      */
    this.resolver = {
        resolve: this.resolve.bind(this),
        reject: this.reject.bind(this)
    };
}

require('./Observable').enable(Deferred);

/**
  * 判断一个对象是否是一个`Promise`对象
  * 
  * 该方法采用灵活的判断方式，并非要求`value`为`Deferred`的实例
  *
  * @param {*} value 需要判断的对象
  * @return {boolean} 如果`value`是`Promise`对象，则返回true
  */
Deferred.isPromise = function (value) {
    return value && typeof value.then === 'function';
};

/**
  * 是否启用同步模式。
  * 
  * 在同步模式下，`Deferred`对象并不符合Promise/A规范，
  * 当对象进入或处于**resolved**或**rejected**状态时，
  * 添加的回调函数会**立即**、**同步**地被执行。
  *
  * @type {boolean}
  * @public
  */
Deferred.prototype.syncModeEnabled = false;

/**
  * 将当前对象状态设置为**resolved**，并执行所有成功回调函数
  *
  * @param {...*} args 执行回调时的参数
  * @public
  */
Deferred.prototype.resolve = function () {
    if (this.state !== 'pending') {
        return;
    }

    this.state = 'resolved';
    this._args = [].slice.call(arguments);

    Deferred.fire(
        'resolve',
        {
            deferred: this,
            args: this._args,
            reason: this._args[0]
        }
    );

    tryFlush(this);
};

/**
  * 将当前对象状态设置为**rejected**，并执行所有失败回调函数
  *
  * @param {...*} args 执行回调时的参数
  * @public
  */
Deferred.prototype.reject = function () {
    if (this.state !== 'pending') {
        return;
    }

    this.state = 'rejected';
    this._args = [].slice.call(arguments);

    Deferred.fire(
        'reject',
        {
            deferred: this,
            args: this._args,
            reason: this._args[0]
        }
    );

    tryFlush(this);
};

/**
  * 添加一个成功回调函数
  * 
  * 本方法相当于`.then(callback, null)，具体参考`then`方法的说明al
  *
  * @param {function} callback 需要添加的回调函数
  * @return {Promise} 新的`Promise`对象
  * @public
  */
Deferred.prototype.done = function (callback) {
    return this.then(callback);
};

/**
  * 添加一个失败回调函数
  * 
  * 本方法相当于`.then(null, callback)，具体参考`then`方法的说明
  *
  * @param {function} callback 需要添加的回调函数
  * @return {Promise} 新的`Promise`对象
  * @public
  */
Deferred.prototype.fail = function (callback) {
    return this.then(null, callback);
};


/**
  * 添加一个无论成功还是失败均执行的回调函数
  * 
  * 本方法相当于`.then(callback, callback)，具体参考`then`方法的说明
  *
  * @param {function} callback 需要添加的回调函数
  * @return {Promise} 新的`Promise`对象
  * @public
  */
Deferred.prototype.ensure = function (callback) {
    return this.then(callback, callback);
};

/**
  * 添加成功回调函数及可选的失败回调函数
  * 
  * 该函数会返回一个新的`Promise`对象，新`Promise`对象将有以下行为：
  * 
  * - 当原有`Deferred`对象进入**resolved**状态时，执行`done`回调函数，
  *   并根据函数的返回值进行逻辑
  * - 当原有`Deferred`对象进入**rejected**状态时，执行`fail`回调函数，
  *   并根据函数的返回值进行逻辑
  * 
  * 其中**根据函数的返回值进行逻辑**具体如下：
  * 
  * - 当函数返回非`null`或`undefined`时，使用返回值进入**resolved**状态
  * - 当函数抛出异常时，使用异常对象进入**rejected**状态
  * 
  * 另如果当前`Deferred`对象不处在**pending**状态，则：
  * 
  * - 如果处在**resolved**状态，则成功回调函数会被立即异步执行
  * - 如果处在**rejected**状态，则失败回调函数会被立即异步执行
  *
  * @param {?function} done 成功时执行的回调函数
  * @param {function=} fail 失败时执行的回调函数，可选参数
  * @return {Promise} 新的`Promise`对象
  * @public
  */
Deferred.prototype.then = function (done, fail) {
    var deferred = new Deferred();
    deferred.syncModeEnabled = this.syncModeEnabled;

    this._doneCallbacks.push(pipe(this, deferred, done, 'resolve'));
    this._failCallbacks.push(pipe(this, deferred, fail, 'reject'));

    tryFlush(this);

    return deferred.promise;
};

// 暂不支持`progress`，
// 社区对`progress`处理函数的返回值和异常的传递还在讨论中

/**
  * 生成一个新的`Promise`对象，当所有给定的`Promise`对象完成后触发
  * 
  * 其触发逻辑如下：
  * 
  * - 如果所有给定的`Promise`对象均进入**resolved**状态，则该`Promise`
  *   对象进入**resolved**状态
  * - 如果有至少一个`Promise`对象进入**rejected**状态，则该`Promise`
  *   对象进入**rejected**状态
  * 
  * 当新的`Promise`对象触发时，将按照传入的`Promise`对象的顺序，
  * 依次提供参数，且根据原`Promise`对象的回调参数，有以下情况：
  * 
  * - 如果给定参数只有一个，使用这一个参数
  * - 如果给定多个参数，则提供一个数组包含这些参数
  * 
  * 本方法对参数的方法与`Array.prototyp.concat`相同，
  * 如果任意一个参数是数组则会展开
  *
  * @param {...Promise | ...Array.<Promise>} 需要组合的`Promise`对象
  * @return {Promise} 一个新的`Promise`对象
  */
Deferred.all = function () {
    // 典型的异步并发归并问题，使用计数器来解决
    var workingUnits = [].concat.apply([], arguments);
    var workingCount = workingUnits.length;

    // 如果没有任何任务，直接给处理完的
    if (!workingCount) {
        return Deferred.resolved();
    }

    var actionType = 'resolve';
    var result = [];

    var jointDeferred = new Deferred();

    function resolveOne(whichToFill) {
        workingCount--;

        assert.ok(
            workingCount >= 0, 'workingCount should be positive'
        );

        var unitResult = [].slice.call(arguments, 1);
        // 如果给定的结果只有一个，不要再组装成数组
        if (unitResult.length <= 1) {
            unitResult = unitResult[0];
        }
        result[whichToFill] = unitResult;

        if (workingCount === 0) {
            jointDeferred[actionType].apply(jointDeferred, result);
        }
    }

    function rejectOne() {
        actionType = 'reject';
        resolveOne.apply(this, arguments);
    }

    for (var i = 0; i < workingUnits.length; i++) {
        var unit = workingUnits[i];
        unit.then(
            resolveOne.bind(unit, i),
            rejectOne.bind(unit, i)
        );
    }

    return jointDeferred.promise;
};

/**
  * 返回一个已经处于**resolved**状态的`Promise`对象
  *
  * @param {...*} 用于调用`resolve`方法的参数
  * @return {Promise} 一个已经处于**resolved**状态的`Promise`对象
  */
Deferred.resolved = function () {
    var deferred = new Deferred();
    deferred.resolve.apply(deferred, arguments);
    return deferred.promise;
};

/**
  * 返回一个已经处于**rejected**状态的`Promise`对象
  *
  * @param {...*} 用于调用`reject`方法的参数
  * @return {Promise} 一个已经处于**rejected**状态的`Promise`对象
  */
Deferred.rejected = function () {
    var deferred = new Deferred();
    deferred.reject.apply(deferred, arguments);
    return deferred.promise;
};

/**
  * 返回一个`Promise`对象，当指定的模块被AMD加载器加载后，进入**resolved**状态
  *
  * @param {...string} 需要加载的模块列表
  * @return {Promise} 一个`Promise`对象
  */
Deferred.require = function () {
    var modules = [].slice.call(arguments);
    var deferred = new Deferred();

    require(modules, deferred.resolver.resolve);

    deferred.promise.abort = deferred.resolver.reject;

    return deferred.promise;
};

module.exports = exports = Deferred;
 at SyntaxError: Unexpected token (8:4)
    at Parser.pp$4.raise (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2221:15)
    at Parser.pp.unexpected (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:603:10)
    at Parser.pp$2.parseBindingAtom (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:1417:12)
    at Parser.parseBindingAtom (/root/ExpoSE/lib/Tropigate/bin/FunctionSignatures.js:49:30)
    at Parser.pp$1.parseVarId (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:1049:20)
    at Parser.pp$1.parseVar (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:1032:14)
    at Parser.pp$1.parseVarStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:917:10)
    at Parser.pp$1.parseStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:706:19)
    at Parser.parseStatement (/root/ExpoSE/lib/Tropigate/bin/Statements.js:104:30)
    at Parser.pp$1.parseTopLevel (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:638:25)
*-- Replay with NO_COMPILE=1 expoSE replay '/root/ExpoSE/lib/Harness/src/harness.js' '{"_bound":0}'
*-- Coverage Data
*- File /root/ExpoSE/lib/Harness/src/harness.js. Coverage (Term): 18% Coverage (LOC): 24%
*- File /root/ExpoSE/lib/S$/bin/symbols.js. Coverage (Term): 16% Coverage (LOC): 34%
*- File /root/Targets/edp-test/node_modules/edp-test/index.js. Coverage (Term): 12% Coverage (LOC): 14%
*- File /root/Targets/edp-test/node_modules/edp-core/index.js. Coverage (Term): 77% Coverage (LOC): 90%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/amd.js. Coverage (Term): 26% Coverage (LOC): 60%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/esl.js. Coverage (Term): 95% Coverage (LOC): 100%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/fs.js. Coverage (Term): 16% Coverage (LOC): 19%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/glob.js. Coverage (Term): 8% Coverage (LOC): 12%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/path.js. Coverage (Term): 26% Coverage (LOC): 45%
*- File /root/Targets/edp-test/node_modules/minimatch/minimatch.js. Coverage (Term): 7% Coverage (LOC): 10%
*- File /root/Targets/edp-test/node_modules/brace-expansion/index.js. Coverage (Term): 12% Coverage (LOC): 17%
*- File /root/Targets/edp-test/node_modules/concat-map/index.js. Coverage (Term): 24% Coverage (LOC): 40%
*- File /root/Targets/edp-test/node_modules/balanced-match/index.js. Coverage (Term): 11% Coverage (LOC): 15%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/log.js. Coverage (Term): 28% Coverage (LOC): 49%
*- File /root/Targets/edp-test/node_modules/chalk/index.js. Coverage (Term): 59% Coverage (LOC): 69%
*- File /root/Targets/edp-test/node_modules/escape-string-regexp/index.js. Coverage (Term): 85% Coverage (LOC): 90%
*- File /root/Targets/edp-test/node_modules/ansi-styles/index.js. Coverage (Term): 98% Coverage (LOC): 100%
*- File /root/Targets/edp-test/node_modules/strip-ansi/index.js. Coverage (Term): 57% Coverage (LOC): 86%
*- File /root/Targets/edp-test/node_modules/ansi-regex/index.js. Coverage (Term): 93% Coverage (LOC): 100%
*- File /root/Targets/edp-test/node_modules/has-ansi/index.js. Coverage (Term): 97% Coverage (LOC): 100%
*- File /root/Targets/edp-test/node_modules/supports-color/index.js. Coverage (Term): 66% Coverage (LOC): 48%
*- File /root/Targets/edp-test/node_modules/edp-core/lib/pkg.js. Coverage (Term): 16% Coverage (LOC): 19%
*- Re-run with EXPOSE_PRINT_COVERAGE=1 to print line by line coverage information
** ExpoSE Finished. 1 paths with 1 errors **
