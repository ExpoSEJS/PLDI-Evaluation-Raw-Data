/root/Targets/auditing
└─┬ auditing@0.0.7 
  ├─┬ joi@9.2.0 
  │ ├── hoek@4.2.0 
  │ ├── isemail@2.2.1 
  │ ├── items@2.1.1 
  │ ├── moment@2.18.1 
  │ └── topo@2.0.2 
  ├─┬ lighthouse@1.6.5 
  │ ├── axe-core@2.1.7 
  │ ├── chrome-devtools-frontend@1.0.422034 
  │ ├─┬ debug@2.2.0 
  │ │ └── ms@0.7.1 
  │ ├─┬ devtools-timeline-model@1.1.6 
  │ │ ├── chrome-devtools-frontend@1.0.401423 
  │ │ └── resolve@1.1.7 
  │ ├── gl-matrix@2.3.2 
  │ ├─┬ handlebars@4.0.5 
  │ │ ├── async@1.5.2 
  │ │ ├─┬ optimist@0.6.1 
  │ │ │ ├── minimist@0.0.10 
  │ │ │ └── wordwrap@0.0.3 
  │ │ ├─┬ source-map@0.4.4 
  │ │ │ └── amdefine@1.0.1 
  │ │ └─┬ uglify-js@2.8.29 
  │ │   ├── source-map@0.5.7 
  │ │   ├── uglify-to-browserify@1.0.2 
  │ │   └─┬ yargs@3.10.0 
  │ │     ├── camelcase@1.2.1 
  │ │     ├─┬ cliui@2.1.0 
  │ │     │ ├─┬ center-align@0.1.3 
  │ │     │ │ ├─┬ align-text@0.1.4 
  │ │     │ │ │ ├─┬ kind-of@3.2.2 
  │ │     │ │ │ │ └── is-buffer@1.1.5 
  │ │     │ │ │ ├── longest@1.0.1 
  │ │     │ │ │ └── repeat-string@1.6.1 
  │ │     │ │ └── lazy-cache@1.0.4 
  │ │     │ ├── right-align@0.1.3 
  │ │     │ └── wordwrap@0.0.2 
  │ │     └── window-size@0.1.0 
  │ ├── json-stringify-safe@5.0.1 
  │ ├── marked@0.3.6 
  │ ├── metaviewport-parser@0.0.1 
  │ ├─┬ mkdirp@0.5.1 
  │ │ └── minimist@0.0.8 
  │ ├─┬ opn@4.0.2 
  │ │ ├── object-assign@4.1.1 
  │ │ └─┬ pinkie-promise@2.0.1 
  │ │   └── pinkie@2.0.4 
  │ ├── rimraf@2.2.8 
  │ ├── semver@5.3.0 
  │ ├─┬ speedline@1.0.3 
  │ │ ├─┬ babar@0.0.3 
  │ │ │ └── colors@0.6.2 
  │ │ ├── image-ssim@0.2.0 
  │ │ ├── jpeg-js@0.1.2 
  │ │ ├─┬ loud-rejection@1.6.0 
  │ │ │ ├─┬ currently-unhandled@0.4.1 
  │ │ │ │ └── array-find-index@1.0.2 
  │ │ │ └── signal-exit@3.0.2 
  │ │ └─┬ meow@3.7.0 
  │ │   ├─┬ camelcase-keys@2.1.0 
  │ │   │ └── camelcase@2.1.1 
  │ │   ├── map-obj@1.0.1 
  │ │   ├── minimist@1.2.0 
  │ │   ├─┬ normalize-package-data@2.4.0 
  │ │   │ ├── hosted-git-info@2.5.0 
  │ │   │ ├─┬ is-builtin-module@1.0.0 
  │ │   │ │ └── builtin-modules@1.1.1 
  │ │   │ └─┬ validate-npm-package-license@3.0.1 
  │ │   │   ├─┬ spdx-correct@1.0.2 
  │ │   │   │ └── spdx-license-ids@1.2.2 
  │ │   │   └── spdx-expression-parse@1.0.4 
  │ │   ├─┬ redent@1.0.0 
  │ │   │ ├─┬ indent-string@2.1.0 
  │ │   │ │ └─┬ repeating@2.0.1 
  │ │   │ │   └── is-finite@1.0.2 
  │ │   │ └─┬ strip-indent@1.0.1 
  │ │   │   └── get-stdin@4.0.1 
  │ │   └── trim-newlines@1.0.0 
  │ ├─┬ update-notifier@2.2.0 
  │ │ ├─┬ boxen@1.2.1 
  │ │ │ ├── ansi-align@2.0.0 
  │ │ │ ├── camelcase@4.1.0 
  │ │ │ ├─┬ chalk@2.1.0 
  │ │ │ │ ├─┬ ansi-styles@3.2.0 
  │ │ │ │ │ └─┬ color-convert@1.9.0 
  │ │ │ │ │   └── color-name@1.1.3 
  │ │ │ │ └─┬ supports-color@4.4.0 
  │ │ │ │   └── has-flag@2.0.0 
  │ │ │ ├── cli-boxes@1.0.0 
  │ │ │ ├─┬ string-width@2.1.1 
  │ │ │ │ ├── is-fullwidth-code-point@2.0.0 
  │ │ │ │ └─┬ strip-ansi@4.0.0 
  │ │ │ │   └── ansi-regex@3.0.0 
  │ │ │ ├─┬ term-size@1.2.0 
  │ │ │ │ └─┬ execa@0.7.0 
  │ │ │ │   ├─┬ cross-spawn@5.1.0 
  │ │ │ │   │ ├─┬ lru-cache@4.1.1 
  │ │ │ │   │ │ ├── pseudomap@1.0.2 
  │ │ │ │   │ │ └── yallist@2.1.2 
  │ │ │ │   │ ├─┬ shebang-command@1.2.0 
  │ │ │ │   │ │ └── shebang-regex@1.0.0 
  │ │ │ │   │ └─┬ which@1.3.0 
  │ │ │ │   │   └── isexe@2.0.0 
  │ │ │ │   ├── get-stream@3.0.0 
  │ │ │ │   ├── is-stream@1.1.0 
  │ │ │ │   ├─┬ npm-run-path@2.0.2 
  │ │ │ │   │ └── path-key@2.0.1 
  │ │ │ │   ├── p-finally@1.0.0 
  │ │ │ │   └── strip-eof@1.0.0 
  │ │ │ └─┬ widest-line@1.0.0 
  │ │ │   └─┬ string-width@1.0.2 
  │ │ │     ├── is-fullwidth-code-point@1.0.0 
  │ │ │     └─┬ strip-ansi@3.0.1 
  │ │ │       └── ansi-regex@2.1.1 
  │ │ ├─┬ chalk@1.1.3 
  │ │ │ ├── ansi-styles@2.2.1 
  │ │ │ ├── escape-string-regexp@1.0.5 
  │ │ │ ├─┬ has-ansi@2.0.0 
  │ │ │ │ └── ansi-regex@2.1.1 
  │ │ │ ├─┬ strip-ansi@3.0.1 
  │ │ │ │ └── ansi-regex@2.1.1 
  │ │ │ └── supports-color@2.0.0 
  │ │ ├─┬ configstore@3.1.1 
  │ │ │ ├─┬ dot-prop@4.2.0 
  │ │ │ │ └── is-obj@1.0.1 
  │ │ │ ├── graceful-fs@4.1.11 
  │ │ │ ├─┬ make-dir@1.0.0 
  │ │ │ │ └── pify@2.3.0 
  │ │ │ ├─┬ unique-string@1.0.0 
  │ │ │ │ └── crypto-random-string@1.0.0 
  │ │ │ └─┬ write-file-atomic@2.3.0 
  │ │ │   └── imurmurhash@0.1.4 
  │ │ ├── import-lazy@2.1.0 
  │ │ ├── is-npm@1.0.0 
  │ │ ├─┬ latest-version@3.1.0 
  │ │ │ └─┬ package-json@4.0.1 
  │ │ │   ├─┬ got@6.7.1 
  │ │ │   │ ├─┬ create-error-class@3.0.2 
  │ │ │   │ │ └── capture-stack-trace@1.0.0 
  │ │ │   │ ├── duplexer3@0.1.4 
  │ │ │   │ ├── is-redirect@1.0.0 
  │ │ │   │ ├── is-retry-allowed@1.1.0 
  │ │ │   │ ├── lowercase-keys@1.0.0 
  │ │ │   │ ├── timed-out@4.0.1 
  │ │ │   │ ├── unzip-response@2.0.1 
  │ │ │   │ └─┬ url-parse-lax@1.0.0 
  │ │ │   │   └── prepend-http@1.0.4 
  │ │ │   ├─┬ registry-auth-token@3.3.1 
  │ │ │   │ └─┬ rc@1.2.1 
  │ │ │   │   ├── deep-extend@0.4.2 
  │ │ │   │   ├── ini@1.3.4 
  │ │ │   │   ├── minimist@1.2.0 
  │ │ │   │   └── strip-json-comments@2.0.1 
  │ │ │   └── registry-url@3.1.0 
  │ │ ├── semver-diff@2.1.0 
  │ │ └── xdg-basedir@3.0.0 
  │ ├─┬ whatwg-url@4.0.0 
  │ │ ├── tr46@0.0.3 
  │ │ └── webidl-conversions@3.0.1 
  │ ├─┬ ws@1.1.1 
  │ │ ├── options@0.0.6 
  │ │ └── ultron@1.0.2 
  │ └─┬ yargs@3.32.0 
  │   ├── camelcase@2.1.1 
  │   ├─┬ cliui@3.2.0 
  │   │ └─┬ strip-ansi@3.0.1 
  │   │   └── ansi-regex@2.1.1 
  │   ├─┬ string-width@1.0.2 
  │   │ └── is-fullwidth-code-point@1.0.0 
  │   └── window-size@0.1.4 
  ├── lodash@4.17.4 
  ├─┬ mrcrowley@0.0.7 
  │ ├─┬ jsdom@9.12.0 
  │ │ ├── abab@1.0.4 
  │ │ ├── acorn@4.0.13 
  │ │ ├── acorn-globals@3.1.0 
  │ │ ├── array-equal@1.0.0 
  │ │ ├── content-type-parser@1.0.1 
  │ │ ├── cssom@0.3.2 
  │ │ ├── cssstyle@0.2.37 
  │ │ ├─┬ escodegen@1.9.0 
  │ │ │ ├── esprima@3.1.3 
  │ │ │ ├── estraverse@4.2.0 
  │ │ │ ├── esutils@2.0.2 
  │ │ │ ├─┬ optionator@0.8.2 
  │ │ │ │ ├── deep-is@0.1.3 
  │ │ │ │ ├── fast-levenshtein@2.0.6 
  │ │ │ │ ├── levn@0.3.0 
  │ │ │ │ ├── prelude-ls@1.1.2 
  │ │ │ │ ├── type-check@0.3.2 
  │ │ │ │ └── wordwrap@1.0.0 
  │ │ │ └── source-map@0.5.7 
  │ │ ├── html-encoding-sniffer@1.0.1 
  │ │ ├── nwmatcher@1.4.2 
  │ │ ├── parse5@1.5.1 
  │ │ ├─┬ request@2.83.0 
  │ │ │ ├── aws-sign2@0.7.0 
  │ │ │ ├── aws4@1.6.0 
  │ │ │ ├── caseless@0.12.0 
  │ │ │ ├─┬ combined-stream@1.0.5 
  │ │ │ │ └── delayed-stream@1.0.0 
  │ │ │ ├── extend@3.0.1 
  │ │ │ ├── forever-agent@0.6.1 
  │ │ │ ├─┬ form-data@2.3.1 
  │ │ │ │ └── asynckit@0.4.0 
  │ │ │ ├─┬ har-validator@5.0.3 
  │ │ │ │ ├─┬ ajv@5.2.3 
  │ │ │ │ │ ├── co@4.6.0 
  │ │ │ │ │ ├── fast-deep-equal@1.0.0 
  │ │ │ │ │ ├── json-schema-traverse@0.3.1 
  │ │ │ │ │ └─┬ json-stable-stringify@1.0.1 
  │ │ │ │ │   └── jsonify@0.0.0 
  │ │ │ │ └── har-schema@2.0.0 
  │ │ │ ├─┬ hawk@6.0.2 
  │ │ │ │ ├── boom@4.3.1 
  │ │ │ │ ├─┬ cryptiles@3.1.2 
  │ │ │ │ │ └── boom@5.2.0 
  │ │ │ │ └── sntp@2.0.2 
  │ │ │ ├─┬ http-signature@1.2.0 
  │ │ │ │ ├── assert-plus@1.0.0 
  │ │ │ │ ├─┬ jsprim@1.4.1 
  │ │ │ │ │ ├── extsprintf@1.3.0 
  │ │ │ │ │ ├── json-schema@0.2.3 
  │ │ │ │ │ └── verror@1.10.0 
  │ │ │ │ └─┬ sshpk@1.13.1 
  │ │ │ │   ├── asn1@0.2.3 
  │ │ │ │   ├── bcrypt-pbkdf@1.0.1 
  │ │ │ │   ├── dashdash@1.14.1 
  │ │ │ │   ├── ecc-jsbn@0.1.1 
  │ │ │ │   ├── getpass@0.1.7 
  │ │ │ │   ├── jsbn@0.1.1 
  │ │ │ │   └── tweetnacl@0.14.5 
  │ │ │ ├── is-typedarray@1.0.0 
  │ │ │ ├── isstream@0.1.2 
  │ │ │ ├─┬ mime-types@2.1.17 
  │ │ │ │ └── mime-db@1.30.0 
  │ │ │ ├── oauth-sign@0.8.2 
  │ │ │ ├── performance-now@2.1.0 
  │ │ │ ├── qs@6.5.1 
  │ │ │ ├── safe-buffer@5.1.1 
  │ │ │ ├── stringstream@0.0.5 
  │ │ │ ├── tunnel-agent@0.6.0 
  │ │ │ └── uuid@3.1.0 
  │ │ ├── sax@1.2.4 
  │ │ ├── symbol-tree@3.2.2 
  │ │ ├── webidl-conversions@4.0.2 
  │ │ ├─┬ whatwg-encoding@1.0.1 
  │ │ │ └── iconv-lite@0.4.13 
  │ │ ├─┬ whatwg-url@4.8.0 
  │ │ │ └── webidl-conversions@3.0.1 
  │ │ └── xml-name-validator@2.0.1 
  │ └─┬ tough-cookie@2.3.3 
  │   └── punycode@1.4.1 
  ├─┬ w3cjs@0.3.2 
  │ ├── commander@2.6.0 
  │ ├─┬ superagent@0.21.0 
  │ │ ├── component-emitter@1.1.2 
  │ │ ├── cookiejar@2.0.1 
  │ │ ├── extend@1.2.1 
  │ │ ├─┬ form-data@0.1.3 
  │ │ │ ├── async@0.9.2 
  │ │ │ └─┬ combined-stream@0.0.7 
  │ │ │   └── delayed-stream@0.0.5 
  │ │ ├── formidable@1.0.14 
  │ │ ├── methods@1.0.1 
  │ │ ├── mime@1.2.11 
  │ │ ├── qs@1.2.0 
  │ │ ├─┬ readable-stream@1.0.27-1 
  │ │ │ ├── core-util-is@1.0.2 
  │ │ │ ├── inherits@2.0.3 
  │ │ │ ├── isarray@0.0.1 
  │ │ │ └── string_decoder@0.10.31 
  │ │ └── reduce-component@1.0.1 
  │ └─┬ superagent-proxy@0.3.2 
  │   └─┬ proxy-agent@1.1.1 
  │     ├─┬ http-proxy-agent@0.2.7 
  │     │ └── agent-base@1.0.2 
  │     ├── https-proxy-agent@0.3.6 
  │     ├── lru-cache@2.5.2 
  │     ├─┬ pac-proxy-agent@0.2.0 
  │     │ ├── extend@1.2.1 
  │     │ ├─┬ get-uri@0.1.4 
  │     │ │ ├── data-uri-to-buffer@0.0.4 
  │     │ │ ├── file-uri-to-path@0.0.2 
  │     │ │ ├─┬ ftp@0.3.10 
  │     │ │ │ ├── readable-stream@1.1.14 
  │     │ │ │ └── xregexp@2.0.0 
  │     │ │ └─┬ readable-stream@2.3.3 
  │     │ │   ├── isarray@1.0.0 
  │     │ │   ├── process-nextick-args@1.0.7 
  │     │ │   ├── string_decoder@1.0.3 
  │     │ │   └── util-deprecate@1.0.2 
  │     │ ├─┬ pac-resolver@1.2.6 
  │     │ │ ├── co@3.0.6 
  │     │ │ ├─┬ degenerator@1.0.4 
  │     │ │ │ └── ast-types@0.9.13 
  │     │ │ ├── netmask@1.0.6 
  │     │ │ ├─┬ regenerator@0.8.46 
  │     │ │ │ ├─┬ commoner@0.10.8 
  │     │ │ │ │ ├─┬ detective@4.5.0 
  │     │ │ │ │ │ └── defined@1.0.0 
  │     │ │ │ │ ├─┬ glob@5.0.15 
  │     │ │ │ │ │ ├─┬ inflight@1.0.6 
  │     │ │ │ │ │ │ └── wrappy@1.0.2 
  │     │ │ │ │ │ ├─┬ minimatch@3.0.4 
  │     │ │ │ │ │ │ └─┬ brace-expansion@1.1.8 
  │     │ │ │ │ │ │   ├── balanced-match@1.0.0 
  │     │ │ │ │ │ │   └── concat-map@0.0.1 
  │     │ │ │ │ │ ├── once@1.4.0 
  │     │ │ │ │ │ └── path-is-absolute@1.0.1 
  │     │ │ │ │ ├── q@1.5.0 
  │     │ │ │ │ └─┬ recast@0.11.23 
  │     │ │ │ │   ├── ast-types@0.9.6 
  │     │ │ │ │   └── source-map@0.5.7 
  │     │ │ │ ├─┬ defs@1.1.1 
  │     │ │ │ │ ├─┬ alter@0.2.0 
  │     │ │ │ │ │ └── stable@0.1.6 
  │     │ │ │ │ ├── ast-traverse@0.1.1 
  │     │ │ │ │ ├── breakable@1.0.0 
  │     │ │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │     │ │ │ │ ├── simple-fmt@0.1.0 
  │     │ │ │ │ ├── simple-is@0.2.0 
  │     │ │ │ │ ├── stringmap@0.2.2 
  │     │ │ │ │ ├── stringset@0.2.1 
  │     │ │ │ │ ├── tryor@0.1.2 
  │     │ │ │ │ └─┬ yargs@3.27.0 
  │     │ │ │ │   └── window-size@0.1.4 
  │     │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │     │ │ │ ├── private@0.1.7 
  │     │ │ │ ├─┬ recast@0.10.33 
  │     │ │ │ │ ├── ast-types@0.8.12 
  │     │ │ │ │ ├── esprima-fb@15001.1001.0-dev-harmony-fb 
  │     │ │ │ │ └── source-map@0.5.7 
  │     │ │ │ ├── regenerator-runtime@0.9.6 
  │     │ │ │ └── through@2.3.8 
  │     │ │ └── thunkify@2.1.2 
  │     │ └── stream-to-array@1.0.0 
  │     └─┬ socks-proxy-agent@1.0.2 
  │       ├── extend@1.2.1 
  │       └─┬ socks@1.1.10 
  │         ├── ip@1.1.5 
  │         └── smart-buffer@1.1.15 
  └─┬ yargs@6.6.0 
    ├── camelcase@3.0.0 
    ├─┬ cliui@3.2.0 
    │ ├─┬ strip-ansi@3.0.1 
    │ │ └── ansi-regex@2.1.1 
    │ └─┬ wrap-ansi@2.1.0 
    │   ├─┬ string-width@1.0.2 
    │   │ └── is-fullwidth-code-point@1.0.0 
    │   └─┬ strip-ansi@3.0.1 
    │     └── ansi-regex@2.1.1 
    ├── decamelize@1.2.0 
    ├── get-caller-file@1.0.2 
    ├─┬ os-locale@1.4.0 
    │ └─┬ lcid@1.0.0 
    │   └── invert-kv@1.0.0 
    ├─┬ read-pkg-up@1.0.1 
    │ ├─┬ find-up@1.1.2 
    │ │ └── path-exists@2.1.0 
    │ └─┬ read-pkg@1.1.0 
    │   ├─┬ load-json-file@1.1.0 
    │   │ ├─┬ parse-json@2.2.0 
    │   │ │ └─┬ error-ex@1.3.1 
    │   │ │   └── is-arrayish@0.2.1 
    │   │ └─┬ strip-bom@2.0.0 
    │   │   └── is-utf8@0.2.1 
    │   └── path-type@1.1.0 
    ├── require-directory@2.1.1 
    ├── require-main-filename@1.0.1 
    ├── set-blocking@2.0.0 
    ├─┬ string-width@1.0.2 
    │ ├── code-point-at@1.1.0 
    │ └─┬ is-fullwidth-code-point@1.0.0 
    │   └── number-is-nan@1.0.1 
    ├── which-module@1.0.0 
    ├── y18n@3.2.1 
    └─┬ yargs-parser@4.2.1 
      └── camelcase@3.0.0 

Setup Done exists, not setting up
:../FeatureTester/libs/:/root/Targets/auditing/node_modules
Set Default Z3_PATH to ./node_modules/z3javascript/bin/libz3.so
ExpoSE Master: /root/ExpoSE/lib/Harness/src/harness.js max concurrent: 16 max paths: 1000000
Setting timeout to 900000
*** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [0 done /0 queued / 1 running / 0 errors / 0% coverage ] ****** [1 done /0 queued / 0 running / 1 errors / 33% coverage ] ***
*-- Stat Module Output --*
*-- concretizations: ["defineProperty","bound log"]
*-- Stat Module Done --*
*-- Test Case {"_bound":0} start 0.0177 took 4.5259s
*-- Errors occured in test {"_bound":0}
* Error: Tropigate failed because SyntaxError: Unexpected character '#' (1:78) on program #!/usr/bin/env node


'use strict';
/* global Promise */

Object.defineProperty(exports, "__esModule", {
    value: true
});
exports.run = exports.setup = undefined;

var _typeof = typeof Symbol === "function" && typeof Symbol.iterator === "symbol" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; };

var _yargs = require('yargs');

var _merge = require('lodash/merge.js');

var _merge2 = _interopRequireDefault(_merge);

var _isArray = require('lodash/isArray.js');

var _isArray2 = _interopRequireDefault(_isArray);

var _scraper = require('./scraper.js');

var _config = require('./config.js');

var _utils = require('./utils.js');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// Import modules
var modules = {
    bestPractices: require('./modules/bestPractices.js'),
    analytics: require('./modules/analytics.js')
    // w3: require('./modules/w3.js')
    // TODO: Take care of these modules to be compliant...
    // wcag: require('./modules/wcag.js'),
    // SEO: require('./modules/seo.js'),
    // lighthouse: require('./modules/lighthouse.js')
};

var logWarn = void 0;
var desTest = void 0;
var itTest = void 0;

//-------------------------------------
// Functions

/**
 * Runs the rule
 *
 * @param {object} rule
 * @param {object} src
 * @param {array} ignore
 * @returns
 */
var runRule = function runRule() {
    var rule = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var src = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var ignore = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];

    if ((typeof rule === 'undefined' ? 'undefined' : _typeof(rule)) !== 'object' || (0, _isArray2.default)(rule)) {
        throw new Error('A rule needs to be an object');
    }

    if (!rule.name || typeof rule.name !== 'string') {
        throw new Error('A rule needs a string name');
    }

    if (!rule.fn || typeof rule.fn !== 'function') {
        throw new Error('A rule needs a function fn');
    }

    // Lets run the promise and parse the data
    return rule.fn(src).then(function (ruleData) {
        return (0, _merge2.default)({
            name: rule.name,
            status: 'passed',
            result: ruleData
        });
    }).catch(function (err) {
        return {
            name: rule.name,
            status: 'failed',
            result: err
        };
    }).then(function (data) {
        // Is this ignored already?
        if ((0, _utils.contains)(ignore, data.name)) {
            return {
                name: data.name,
                status: 'ignored',
                result: false
            };
        }

        // There was an error before
        if (data.status === 'failed') {
            throw data;
        }

        // No need to go further without an array
        if (!(0, _isArray2.default)(data.result) || !data.result[0] || _typeof(data.result[0]) !== 'object') {
            return data;
        } else if (!data.result[0].status) {
            return data;
        }

        // Lets check for nested issues...
        var nestedError = false;
        data.result = data.result.map(function (val) {
            // Lets check if we should ignore it...
            var isIgnore = (0, _utils.contains)(ignore, val.msg) || (0, _utils.contains)(ignore, val.raw);
            val.status = isIgnore ? 'ignored' : val.status;

            if (val.status !== 'ignored') {
                // We need to take care of status...
                if (val.status === 'warning') {
                    logWarn(rule.name, val.msg, val.raw);
                } else if (val.status === 'failed') {
                    nestedError = true;
                } else {
                    val.status = 'passed';
                }
            }

            return val;
        });

        // There was an error on the nested ones
        if (nestedError) {
            data.status = 'failed';
            throw data;
        }

        // No worries, pass the data
        return data;
    });
};

/**
 * Runs audit
 *
 * @param {object} auditsData
 * @param {object} src
 * @param {function} resolve
 * @param {function} reject
 * @returns
 */
var runAudit = function runAudit() {
    var auditsData = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    var src = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};
    var resolve = arguments[2];
    var reject = arguments[3];

    var allDone = 0;
    var promisesCount = 0;
    var audits = {};

    if (typeof resolve !== 'function' || typeof reject !== 'function') {
        throw new Error('Resolve and reject functions need to be provided');
    }

    // We need to know how many rules there are
    auditsData.forEach(function (audit) {
        promisesCount += (audit.rules || []).length;
    });

    if (!auditsData.length || promisesCount === 0) {
        resolve(audits);
    }

    // Lets go per audit...
    auditsData.forEach(function (audit) {
        audits[audit.name] = [];

        desTest('Audit: ' + audit.name, function () {
            return audit.rules.forEach(function (rule) {
                var isIgnore = (0, _utils.contains)(audit.ignore, rule.name);

                // We may need to ignore it
                if (isIgnore) {
                    return itTest.skip('Rule: ' + rule.name, function () {
                        // Cache it so we know it later
                        audits[audit.name].push({
                            name: rule.name,
                            status: 'ignored',
                            result: false
                        });

                        allDone += 1;
                        if (allDone === promisesCount) {
                            resolve(audits);
                        }
                    });
                }

                // Lets actually run the rule
                itTest('Rule: ' + rule.name, function (done) {
                    this.timeout(60000);

                    // Lets run the rule
                    runRule(rule, src, audit.ignore).then(function (newRule) {
                        // Ready
                        audits[audit.name].push(newRule);
                        done();

                        allDone += 1;
                        if (allDone === promisesCount) {
                            resolve(audits);
                        }

                        return newRule;
                    }).catch(function (newRule) {
                        var err = newRule.result;

                        // Ready
                        audits[audit.name].push(newRule);
                        done(err instanceof Error ? err : new Error(JSON.stringify(err, null, 4)));

                        allDone += 1;
                        if (allDone === promisesCount) {
                            reject(audits);
                        }
                    });
                });
            });
        });
    });

    return audits;
};

/**
 * Build audits array
 *
 * @param {array} audits
 * @returns {array}
 */
var buildAudits = function buildAudits(audits) {
    audits = typeof audits === 'string' ? [audits] : audits;
    audits = audits.map(function (val) {
        val = (typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object' ? val : { src: val };

        // Lets require
        var mod = modules[val.src] || require((0, _utils.getPwd)(val.src));
        mod = (typeof mod === 'undefined' ? 'undefined' : _typeof(mod)) === 'object' && mod.default ? mod.default : mod;

        // Now set all as should
        val.name = mod.name;
        val.rules = mod.rules.map(function (rule) {
            if ((typeof rule === 'undefined' ? 'undefined' : _typeof(rule)) !== 'object' || (0, _isArray2.default)(rule)) {
                throw new Error('A rule needs to be an object');
            }

            if (!rule.name) {
                throw new Error('A rule needs a name');
            }

            if (!rule.fn) {
                throw new Error('A rule needs a function');
            }

            return rule;
        });
        val.ignore = val.ignore || [];

        return val;
    });

    return audits;
};

/**
 * Gather data
 *
 * @param {array} data
 * @returns {promise}
 */
var gatherData = function gatherData() {
    var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];
    return new Promise(function (resolve, reject) {
        var reqData = [];
        var promisesCount = data.length;
        var allDone = 0;

        // No need to go further without data
        if (!data.length) {
            return resolve();
        }

        // Go through each request
        data.forEach(function (req) {
            return desTest('Requesting src', function () {
                return itTest('Gathering data...', function (done) {
                    this.timeout(10000);

                    // Lets get the scraper data
                    (0, _scraper.run)(req).then(function (scrapData) {
                        var newReq = (0, _merge2.default)(req, {
                            auditsData: buildAudits(req.audits),
                            srcData: scrapData
                        });

                        // Ready
                        reqData.push(newReq);
                        done();

                        allDone += 1;
                        if (allDone === promisesCount) {
                            resolve(reqData);
                        }

                        return newReq;
                    }).catch(function (err) {
                        var newReq = (0, _merge2.default)(req, { err: err });

                        // Ready
                        reqData.push(newReq);
                        done(err);

                        allDone += 1;
                        if (allDone === promisesCount) {
                            reject(reqData);
                        }
                    });
                });
            });
        });
    });
};

/**
 * Initialize audits
 *
 * @param {object|string} config
 * @returns {promise}
 */
var run = function run(config) {
    config = (0, _config.get)(config);

    // Lets gather data from the src
    return gatherData(config.data).then(function (data) {
        return new Promise(function (resolve, reject) {
            // Go through each element in data
            // Lets run audits per request
            data.forEach(function (req) {
                return req.srcData.forEach(function (src) {
                    desTest('Auditing: ' + src.originalSrc, function () {
                        runAudit(req.auditsData, src, resolve, reject);
                    });
                });
            });
        });
    });
};

/**
 * Sets up the testing environment
 *
 * @param {function} newDes
 * @param {function} newIt
 * @param {function} newWarn
 * @param {boolean} reset
 */
var setup = function setup(newDes, newIt, newWarn, reset) {
    if (newDes && typeof newDes !== 'function') {
        throw new Error('Describe needs to be a function');
    }

    if (newIt && typeof newIt !== 'function') {
        throw new Error('It needs to be a function');
    }

    if (newWarn && typeof newWarn !== 'function') {
        throw new Error('Warn needs to be a function');
    }

    // Reset
    if (reset) {
        desTest = itTest = logWarn = null;
    }

    desTest = newDes || desTest || function (msg, cb) {
        cb();
    };

    itTest = newIt || itTest || function (msg, cb) {
        var module = {
            done: function done() {},
            timeout: function timeout() {}
        };

        cb.bind(module)(module.done);
    };
    itTest.skip = newIt && newIt.skip || itTest && itTest.skip || function (msg, cb) {
        var module = {
            done: function done() {},
            timeout: function timeout() {}
        };

        cb.bind(module)(module.done);
    };

    /* eslint-disable no-console */
    logWarn = newWarn || logWarn || function (module) {
        var _console;

        for (var _len = arguments.length, msg = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
            msg[_key - 1] = arguments[_key];
        }

        (_console = console).warn.apply(_console, [module].concat(msg));
    };
    /* eslint-enable no-console */
};

//-------------------------------------
// Runtime

if (_yargs.argv && _yargs.argv.mocha) {
    /* eslint-disable no-undef */
    setup(describe, it);
    /* eslint-enable no-undef */
} else {
    setup();
}
_yargs.argv && _yargs.argv.config && run(_yargs.argv.config);
exports.setup = setup;
exports.run = run;

// Essentially for testing purposes
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9pbmRleC5qcyJdLCJuYW1lcyI6WyJtb2R1bGVzIiwiYmVzdFByYWN0aWNlcyIsInJlcXVpcmUiLCJhbmFseXRpY3MiLCJsb2dXYXJuIiwiZGVzVGVzdCIsIml0VGVzdCIsInJ1blJ1bGUiLCJydWxlIiwic3JjIiwiaWdub3JlIiwiRXJyb3IiLCJuYW1lIiwiZm4iLCJ0aGVuIiwic3RhdHVzIiwicmVzdWx0IiwicnVsZURhdGEiLCJjYXRjaCIsImVyciIsImRhdGEiLCJuZXN0ZWRFcnJvciIsIm1hcCIsImlzSWdub3JlIiwidmFsIiwibXNnIiwicmF3IiwicnVuQXVkaXQiLCJhdWRpdHNEYXRhIiwicmVzb2x2ZSIsInJlamVjdCIsImFsbERvbmUiLCJwcm9taXNlc0NvdW50IiwiYXVkaXRzIiwiZm9yRWFjaCIsImF1ZGl0IiwicnVsZXMiLCJsZW5ndGgiLCJza2lwIiwicHVzaCIsImRvbmUiLCJ0aW1lb3V0IiwibmV3UnVsZSIsIkpTT04iLCJzdHJpbmdpZnkiLCJidWlsZEF1ZGl0cyIsIm1vZCIsImRlZmF1bHQiLCJnYXRoZXJEYXRhIiwiUHJvbWlzZSIsInJlcURhdGEiLCJyZXEiLCJzY3JhcERhdGEiLCJuZXdSZXEiLCJzcmNEYXRhIiwicnVuIiwiY29uZmlnIiwib3JpZ2luYWxTcmMiLCJzZXR1cCIsIm5ld0RlcyIsIm5ld0l0IiwibmV3V2FybiIsInJlc2V0IiwiY2IiLCJtb2R1bGUiLCJiaW5kIiwid2FybiIsIm1vY2hhIiwiZGVzY3JpYmUiLCJpdCJdLCJtYXBwaW5ncyI6Ijs7QUFFQTtBQUNBOzs7Ozs7Ozs7QUFFQTs7QUFDQTs7OztBQUNBOzs7O0FBQ0E7O0FBQ0E7O0FBQ0E7Ozs7QUFFQTtBQUNBLElBQU1BLFVBQVU7QUFDWkMsbUJBQWVDLFFBQVEsNEJBQVIsQ0FESDtBQUVaQyxlQUFXRCxRQUFRLHdCQUFSO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQVBZLENBQWhCOztBQVVBLElBQUlFLGdCQUFKO0FBQ0EsSUFBSUMsZ0JB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O0FBQStCLEtBQTNGO0FBQ0E7QUFDSCxDQTFDRDs7QUE0Q0E7QUFDQTs7QUFFQSxJQUFJLGVBQVEsWUFBSzBDLEtBQWpCLEVBQXdCO0FBQ3BCO0FBQ0FULFVBQU1VLFFBQU4sRUFBZ0JDLEVBQWhCO0FBQ0E7QUFDSCxDQUpELE1BSU87QUFDSFg7QUFDSDtBQUNELGVBQVEsWUFBS0YsTUFBYixJQUF1QkQsSUFBSSxZQUFLQyxNQUFULENBQXZCO1FBQ1NFLEssR0FBQUEsSztRQUNBSCxHLEdBQUFBLEc7O0FBRVQiLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyJcblxuJ3VzZSBzdHJpY3QnO1xuLyogZ2xvYmFsIFByb21pc2UgKi9cblxuaW1wb3J0IHsgYXJndiB9IGZyb20gJ3lhcmdzJztcbmltcG9ydCBtZXJnZSBmcm9tICdsb2Rhc2gvbWVyZ2UuanMnO1xuaW1wb3J0IGlzQXJyYXkgZnJvbSAnbG9kYXNoL2lzQXJyYXkuanMnO1xuaW1wb3J0IHsgcnVuIGFzIHJ1blNjcmFwZXIgfSBmcm9tICcuL3NjcmFwZXIuanMnO1xuaW1wb3J0IHsgZ2V0IGFzIGNvbmZpZ0dldCB9IGZyb20gJy4vY29uZmlnLmpzJztcbmltcG9ydCB7IGdldFB3ZCwgY29udGFpbnMgfSBmcm9tICcuL3V0aWxzLmpzJztcblxuLy8gSW1wb3J0IG1vZHVsZXNcbmNvbnN0IG1vZHVsZXMgPSB7XG4gICAgYmVzdFByYWN0aWNlczogcmVxdWlyZSgnLi9tb2R1bGVzL2Jlc3RQcmFjdGljZXMuanMnKSxcbiAgICBhbmFseXRpY3M6IHJlcXVpcmUoJy4vbW9kdWxlcy9hbmFseXRpY3MuanMnKVxuICAgIC8vIHczOiByZXF1aXJlKCcuL21vZHVsZXMvdzMuanMnKVxuICAgIC8vIFRPRE86IFRha2UgY2FyZSBvZiB0aGVzZSBtb2R1bGVzIHRvIGJlIGNvbXBsaWFudC4uLlxuICAgIC8vIHdjYWc6IHJlcXVpcmUoJy4vbW9kdWxlcy93Y2FnLmpzJyksXG4gICAgLy8gU0VPOiByZXF1aXJlKCcuL21vZHVsZXMvc2VvLmpzJyksXG4gICAgLy8gbGlnaHRob3VzZTogcmVxdWlyZSgnLi9tb2R1bGVzL2xpZ2h0aG91c2UuanMnKVxufTtcblxubGV0IGxvZ1dhcm47XG5sZXQgZGVzVGVzdDtcbmxldCBpdFRlc3Q7XG5cbi8vLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuLy8gRnVuY3Rpb25zXG5cbi8qKlxuICogUnVucyB0aGUgcnVsZVxuICpcbiAqIEBwYXJhbSB7b2JqZWN0fSBydWxlXG4gKiBAcGFyYW0ge29iamVjdH0gc3JjXG4gKiBAcGFyYW0ge2FycmF5fSBpZ25vcmVcbiAqIEByZXR1cm5zXG4gKi9cbmNvbnN0IHJ1blJ1bGUgPSAocnVsZSA9IHt9LCBzcmMgPSB7fSwgaWdub3JlID0gW10pID0+IHtcbiAgICBpZiAodHlwZW9mIHJ1bGUgIT09ICdvYmplY3QnIHx8IGlzQXJyYXkocnVsZSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHJ1bGUgbmVlZHMgdG8gYmUgYW4gb2JqZWN0Jyk7XG4gICAgfVxuXG4gICAgaWYgKCFydWxlLm5hbWUgfHwgdHlwZW9mIHJ1bGUubmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdBIHJ1bGUgbmVlZHMgYSBzdHJpbmcgbmFtZScpO1xuICAgIH1cblxuICAgIGlmICghcnVsZS5mbiB8fCB0eXBlb2YgcnVsZS5mbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgcnVsZSBuZWVkcyBhIGZ1bmN0aW9uIGZuJyk7XG4gICAgfVxuXG4gICAgLy8gTGV0cyBydW4gdGhlIHByb21pc2UgYW5kIHBhcnNlIHRoZSBkYXRhXG4gICAgcmV0dXJuIHJ1bGUuZm4oc3JjKS50aGVuKHJ1bGVEYXRhID0+IG1lcmdlKHtcbiAgICAgICAgbmFtZTogcnVsZS5uYW1lLFxuICAgICAgICBzdGF0dXM6ICdwYXNzZWQnLFxuICAgICAgICByZXN1bHQ6IHJ1bGVEYXRhXG4gICAgfSkpXG4gICAgLmNhdGNoKGVyciA9PiAoe1xuICAgICAgICBuYW1lOiBydWxlLm5hbWUsXG4gICAgICAgIHN0YXR1czogJ2ZhaWxlZCcsXG4gICAgICAgIHJlc3VsdDogZXJyXG4gICAgfSkpXG4gICAgLnRoZW4oZGF0YSA9PiB7XG4gICAgICAgIC8vIElzIHRoaXMgaWdub3JlZCBhbHJlYWR5P1xuICAgICAgICBpZiAoY29udGFpbnMoaWdub3JlLCBkYXRhLm5hbWUpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICAgIG5hbWU6IGRhdGEubmFtZSxcbiAgICAgICAgICAgICAgICBzdGF0dXM6ICdpZ25vcmVkJyxcbiAgICAgICAgICAgICAgICByZXN1bHQ6IGZhbHNlXG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gVGhlcmUgd2FzIGFuIGVycm9yIGJlZm9yZVxuICAgICAgICBpZiAoZGF0YS5zdGF0dXMgPT09ICdmYWlsZWQnKSB7XG4gICAgICAgICAgICB0aHJvdyBkYXRhO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gTm8gbmVlZCB0byBnbyBmdXJ0aGVyIHdpdGhvdXQgYW4gYXJyYXlcbiAgICAgICAgaWYgKCFpc0FycmF5KGRhdGEucmVzdWx0KSB8fCAhZGF0YS5yZXN1bHRbMF0gfHwgdHlwZW9mIGRhdGEucmVzdWx0WzBdICE9PSAnb2JqZWN0Jykge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH0gZWxzZSBpZiAoIWRhdGEucmVzdWx0WzBdLnN0YXR1cykge1xuICAgICAgICAgICAgcmV0dXJuIGRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBMZXRzIGNoZWNrIGZvciBuZXN0ZWQgaXNzdWVzLi4uXG4gICAgICAgIGxldCBuZXN0ZWRFcnJvciA9IGZhbHNlO1xuICAgICAgICBkYXRhLnJlc3VsdCA9IGRhdGEucmVzdWx0Lm1hcCh2YWwgPT4ge1xuICAgICAgICAgICAgLy8gTGV0cyBjaGVjayBpZiB3ZSBzaG91bGQgaWdub3JlIGl0Li4uXG4gICAgICAgICAgICBjb25zdCBpc0lnbm9yZSA9IGNvbnRhaW5zKGlnbm9yZSwgdmFsLm1zZykgfHwgY29udGFpbnMoaWdub3JlLCB2YWwucmF3KTtcbiAgICAgICAgICAgIHZhbC5zdGF0dXMgPSBpc0lnbm9yZSA/ICdpZ25vcmVkJyA6IHZhbC5zdGF0dXM7XG5cbiAgICAgICAgICAgIGlmICh2YWwuc3RhdHVzICE9PSAnaWdub3JlZCcpIHtcbiAgICAgICAgICAgICAgICAvLyBXZSBuZWVkIHRvIHRha2UgY2FyZSBvZiBzdGF0dXMuLi5cbiAgICAgICAgICAgICAgICBpZiAodmFsLnN0YXR1cyA9PT0gJ3dhcm5pbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGxvZ1dhcm4ocnVsZS5uYW1lLCB2YWwubXNnLCB2YWwucmF3KTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHZhbC5zdGF0dXMgPT09ICdmYWlsZWQnKSB7XG4gICAgICAgICAgICAgICAgICAgIG5lc3RlZEVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICB2YWwuc3RhdHVzID0gJ3Bhc3NlZCc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gdmFsO1xuICAgICAgICB9KTtcblxuICAgICAgICAvLyBUaGVyZSB3YXMgYW4gZXJyb3Igb24gdGhlIG5lc3RlZCBvbmVzXG4gICAgICAgIGlmIChuZXN0ZWRFcnJvcikge1xuICAgICAgICAgICAgZGF0YS5zdGF0dXMgPSAnZmFpbGVkJztcbiAgICAgICAgICAgIHRocm93IGRhdGE7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBObyB3b3JyaWVzLCBwYXNzIHRoZSBkYXRhXG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgIH0pO1xufTtcblxuLyoqXG4gKiBSdW5zIGF1ZGl0XG4gKlxuICogQHBhcmFtIHtvYmplY3R9IGF1ZGl0c0RhdGFcbiAqIEBwYXJhbSB7b2JqZWN0fSBzcmNcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlc29sdmVcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IHJlamVjdFxuICogQHJldHVybnNcbiAqL1xuY29uc3QgcnVuQXVkaXQgPSAoYXVkaXRzRGF0YSA9IFtdLCBzcmMgPSB7fSwgcmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgbGV0IGFsbERvbmUgPSAwO1xuICAgIGxldCBwcm9taXNlc0NvdW50ID0gMDtcbiAgICBjb25zdCBhdWRpdHMgPSB7fTtcblxuICAgIGlmICh0eXBlb2YgcmVzb2x2ZSAhPT0gJ2Z1bmN0aW9uJyB8fCB0eXBlb2YgcmVqZWN0ICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUmVzb2x2ZSBhbmQgcmVqZWN0IGZ1bmN0aW9ucyBuZWVkIHRvIGJlIHByb3ZpZGVkJyk7XG4gICAgfVxuXG4gICAgLy8gV2UgbmVlZCB0byBrbm93IGhvdyBtYW55IHJ1bGVzIHRoZXJlIGFyZVxuICAgIGF1ZGl0c0RhdGEuZm9yRWFjaChhdWRpdCA9PiB7IHByb21pc2VzQ291bnQgKz0gKGF1ZGl0LnJ1bGVzIHx8IFtdKS5sZW5ndGg7IH0pO1xuXG4gICAgaWYgKCFhdWRpdHNEYXRhLmxlbmd0aCB8fCBwcm9taXNlc0NvdW50ID09PSAwKSB7XG4gICAgICAgIHJlc29sdmUoYXVkaXRzKTtcbiAgICB9XG5cbiAgICAvLyBMZXRzIGdvIHBlciBhdWRpdC4uLlxuICAgIGF1ZGl0c0RhdGEuZm9yRWFjaChhdWRpdCA9PiB7XG4gICAgICAgIGF1ZGl0c1thdWRpdC5uYW1lXSA9IFtdO1xuXG4gICAgICAgIGRlc1Rlc3QoYEF1ZGl0OiAke2F1ZGl0Lm5hbWV9YCwgKCkgPT4gYXVkaXQucnVsZXMuZm9yRWFjaChydWxlID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGlzSWdub3JlID0gY29udGFpbnMoYXVkaXQuaWdub3JlLCBydWxlLm5hbWUpO1xuXG4gICAgICAgICAgICAvLyBXZSBtYXkgbmVlZCB0byBpZ25vcmUgaXRcbiAgICAgICAgICAgIGlmIChpc0lnbm9yZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBpdFRlc3Quc2tpcChgUnVsZTogJHtydWxlLm5hbWV9YCwgKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAvLyBDYWNoZSBpdCBzbyB3ZSBrbm93IGl0IGxhdGVyXG4gICAgICAgICAgICAgICAgICAgIGF1ZGl0c1thdWRpdC5uYW1lXS5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHJ1bGUubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHN0YXR1czogJ2lnbm9yZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0OiBmYWxzZVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBhbGxEb25lICs9IDE7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhbGxEb25lID09PSBwcm9taXNlc0NvdW50KSB7IHJlc29sdmUoYXVkaXRzKTsgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBMZXRzIGFjdHVhbGx5IHJ1biB0aGUgcnVsZVxuICAgICAgICAgICAgaXRUZXN0KGBSdWxlOiAke3J1bGUubmFtZX1gLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICAgICAgICAgIHRoaXMudGltZW91dCg2MDAwMCk7XG5cbiAgICAgICAgICAgICAgICAvLyBMZXRzIHJ1biB0aGUgcnVsZVxuICAgICAgICAgICAgICAgIHJ1blJ1bGUocnVsZSwgc3JjLCBhdWRpdC5pZ25vcmUpXG4gICAgICAgICAgICAgICAgLnRoZW4obmV3UnVsZSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlYWR5XG4gICAgICAgICAgICAgICAgICAgIGF1ZGl0c1thdWRpdC5uYW1lXS5wdXNoKG5ld1J1bGUpO1xuICAgICAgICAgICAgICAgICAgICBkb25lKCk7XG5cbiAgICAgICAgICAgICAgICAgICAgYWxsRG9uZSArPSAxO1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWxsRG9uZSA9PT0gcHJvbWlzZXNDb3VudCkgeyByZXNvbHZlKGF1ZGl0cyk7IH1cblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmV3UnVsZTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChuZXdSdWxlID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZXJyID0gbmV3UnVsZS5yZXN1bHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUmVhZHlcbiAgICAgICAgICAgICAgICAgICAgYXVkaXRzW2F1ZGl0Lm5hbWVdLnB1c2gobmV3UnVsZSk7XG4gICAgICAgICAgICAgICAgICAgIGRvbmUoZXJyIGluc3RhbmNlb2YgRXJyb3IgPyBlcnIgOiBuZXcgRXJyb3IoSlNPTi5zdHJpbmdpZnkoZXJyLCBudWxsLCA0KSkpO1xuXG4gICAgICAgICAgICAgICAgICAgIGFsbERvbmUgKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGFsbERvbmUgPT09IHByb21pc2VzQ291bnQpIHsgcmVqZWN0KGF1ZGl0cyk7IH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gYXVkaXRzO1xufTtcblxuLyoqXG4gKiBCdWlsZCBhdWRpdHMgYXJyYXlcbiAqXG4gKiBAcGFyYW0ge2FycmF5fSBhdWRpdHNcbiAqIEByZXR1cm5zIHthcnJheX1cbiAqL1xuY29uc3QgYnVpbGRBdWRpdHMgPSAoYXVkaXRzKSA9PiB7XG4gICAgYXVkaXRzID0gKHR5cGVvZiBhdWRpdHMgPT09ICdzdHJpbmcnKSA/IFthdWRpdHNdIDogYXVkaXRzO1xuICAgIGF1ZGl0cyA9IGF1ZGl0cy5tYXAodmFsID0+IHtcbiAgICAgICAgdmFsID0gKHR5cGVvZiB2YWwgPT09ICdvYmplY3QnKSA/IHZhbCA6IHsgc3JjOiB2YWwgfTtcblxuICAgICAgICAvLyBMZXRzIHJlcXVpcmVcbiAgICAgICAgbGV0IG1vZCA9IG1vZHVsZXNbdmFsLnNyY10gfHwgcmVxdWlyZShnZXRQd2QodmFsLnNyYykpO1xuICAgICAgICBtb2QgPSAodHlwZW9mIG1vZCA9PT0gJ29iamVjdCcgJiYgbW9kLmRlZmF1bHQpID8gbW9kLmRlZmF1bHQgOiBtb2Q7XG5cbiAgICAgICAgLy8gTm93IHNldCBhbGwgYXMgc2hvdWxkXG4gICAgICAgIHZhbC5uYW1lID0gbW9kLm5hbWU7XG4gICAgICAgIHZhbC5ydWxlcyA9IG1vZC5ydWxlcy5tYXAoKHJ1bGUpID0+IHtcbiAgICAgICAgICAgIGlmICh0eXBlb2YgcnVsZSAhPT0gJ29iamVjdCcgfHwgaXNBcnJheShydWxlKSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSBydWxlIG5lZWRzIHRvIGJlIGFuIG9iamVjdCcpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXJ1bGUubmFtZSkge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignQSBydWxlIG5lZWRzIGEgbmFtZScpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoIXJ1bGUuZm4pIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0EgcnVsZSBuZWVkcyBhIGZ1bmN0aW9uJyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHJldHVybiBydWxlO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFsLmlnbm9yZSA9IHZhbC5pZ25vcmUgfHwgW107XG5cbiAgICAgICAgcmV0dXJuIHZhbDtcbiAgICB9KTtcblxuICAgIHJldHVybiBhdWRpdHM7XG59O1xuXG4vKipcbiAqIEdhdGhlciBkYXRhXG4gKlxuICogQHBhcmFtIHthcnJheX0gZGF0YVxuICogQHJldHVybnMge3Byb21pc2V9XG4gKi9cbmNvbnN0IGdhdGhlckRhdGEgPSAoZGF0YSA9IFtdKSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgY29uc3QgcmVxRGF0YSA9IFtdO1xuICAgIGNvbnN0IHByb21pc2VzQ291bnQgPSBkYXRhLmxlbmd0aDtcbiAgICBsZXQgYWxsRG9uZSA9IDA7XG5cbiAgICAvLyBObyBuZWVkIHRvIGdvIGZ1cnRoZXIgd2l0aG91dCBkYXRhXG4gICAgaWYgKCFkYXRhLmxlbmd0aCkgeyByZXR1cm4gcmVzb2x2ZSgpOyB9XG5cbiAgICAvLyBHbyB0aHJvdWdoIGVhY2ggcmVxdWVzdFxuICAgIGRhdGEuZm9yRWFjaCgocmVxKSA9PiBkZXNUZXN0KCdSZXF1ZXN0aW5nIHNyYycsICgpID0+IGl0VGVzdCgnR2F0aGVyaW5nIGRhdGEuLi4nLCBmdW5jdGlvbiAoZG9uZSkge1xuICAgICAgICB0aGlzLnRpbWVvdXQoMTAwMDApO1xuXG4gICAgICAgIC8vIExldHMgZ2V0IHRoZSBzY3JhcGVyIGRhdGFcbiAgICAgICAgcnVuU2NyYXBlcihyZXEpLnRoZW4oKHNjcmFwRGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgbmV3UmVxID0gbWVyZ2UocmVxLCB7XG4gICAgICAgICAgICAgICAgYXVkaXRzRGF0YTogYnVpbGRBdWRpdHMocmVxLmF1ZGl0cyksXG4gICAgICAgICAgICAgICAgc3JjRGF0YTogc2NyYXBEYXRhXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLy8gUmVhZHlcbiAgICAgICAgICAgIHJlcURhdGEucHVzaChuZXdSZXEpO1xuICAgICAgICAgICAgZG9uZSgpO1xuXG4gICAgICAgICAgICBhbGxEb25lICs9IDE7XG4gICAgICAgICAgICBpZiAoYWxsRG9uZSA9PT0gcHJvbWlzZXNDb3VudCkgeyByZXNvbHZlKHJlcURhdGEpOyB9XG5cbiAgICAgICAgICAgIHJldHVybiBuZXdSZXE7XG4gICAgICAgIH0pXG4gICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdSZXEgPSBtZXJnZShyZXEsIHsgZXJyIH0pO1xuXG4gICAgICAgICAgICAvLyBSZWFkeVxuICAgICAgICAgICAgcmVxRGF0YS5wdXNoKG5ld1JlcSk7XG4gICAgICAgICAgICBkb25lKGVycik7XG5cbiAgICAgICAgICAgIGFsbERvbmUgKz0gMTtcbiAgICAgICAgICAgIGlmIChhbGxEb25lID09PSBwcm9taXNlc0NvdW50KSB7IHJlamVjdChyZXFEYXRhKTsgfVxuICAgICAgICB9KTtcbiAgICB9KSkpO1xufSk7XG5cbi8qKlxuICogSW5pdGlhbGl6ZSBhdWRpdHNcbiAqXG4gKiBAcGFyYW0ge29iamVjdHxzdHJpbmd9IGNvbmZpZ1xuICogQHJldHVybnMge3Byb21pc2V9XG4gKi9cbmNvbnN0IHJ1biA9IChjb25maWcpID0+IHtcbiAgICBjb25maWcgPSBjb25maWdHZXQoY29uZmlnKTtcblxuICAgIC8vIExldHMgZ2F0aGVyIGRhdGEgZnJvbSB0aGUgc3JjXG4gICAgcmV0dXJuIGdhdGhlckRhdGEoY29uZmlnLmRhdGEpXG4gICAgLnRoZW4oZGF0YSA9PiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XG4gICAgICAgIC8vIEdvIHRocm91Z2ggZWFjaCBlbGVtZW50IGluIGRhdGFcbiAgICAgICAgLy8gTGV0cyBydW4gYXVkaXRzIHBlciByZXF1ZXN0XG4gICAgICAgIGRhdGEuZm9yRWFjaChyZXEgPT4gcmVxLnNyY0RhdGEuZm9yRWFjaChzcmMgPT4ge1xuICAgICAgICAgICAgZGVzVGVzdChgQXVkaXRpbmc6ICR7c3JjLm9yaWdpbmFsU3JjfWAsICgpID0+IHtcbiAgICAgICAgICAgICAgICBydW5BdWRpdChyZXEuYXVkaXRzRGF0YSwgc3JjLCByZXNvbHZlLCByZWplY3QpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pKTtcbiAgICB9KSk7XG59O1xuXG4vKipcbiAqIFNldHMgdXAgdGhlIHRlc3RpbmcgZW52aXJvbm1lbnRcbiAqXG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXdEZXNcbiAqIEBwYXJhbSB7ZnVuY3Rpb259IG5ld0l0XG4gKiBAcGFyYW0ge2Z1bmN0aW9ufSBuZXdXYXJuXG4gKiBAcGFyYW0ge2Jvb2xlYW59IHJlc2V0XG4gKi9cbmNvbnN0IHNldHVwID0gKG5ld0RlcywgbmV3SXQsIG5ld1dhcm4sIHJlc2V0KSA9PiB7XG4gICAgaWYgKG5ld0RlcyAmJiB0eXBlb2YgbmV3RGVzICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRGVzY3JpYmUgbmVlZHMgdG8gYmUgYSBmdW5jdGlvbicpO1xuICAgIH1cblxuICAgIGlmIChuZXdJdCAmJiB0eXBlb2YgbmV3SXQgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJdCBuZWVkcyB0byBiZSBhIGZ1bmN0aW9uJyk7XG4gICAgfVxuXG4gICAgaWYgKG5ld1dhcm4gJiYgdHlwZW9mIG5ld1dhcm4gIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdXYXJuIG5lZWRzIHRvIGJlIGEgZnVuY3Rpb24nKTtcbiAgICB9XG5cbiAgICAvLyBSZXNldFxuICAgIGlmIChyZXNldCkge1xuICAgICAgICBkZXNUZXN0ID0gaXRUZXN0ID0gbG9nV2FybiA9IG51bGw7XG4gICAgfVxuXG4gICAgZGVzVGVzdCA9IG5ld0RlcyB8fCBkZXNUZXN0IHx8IGZ1bmN0aW9uIChtc2csIGNiKSB7XG4gICAgICAgIGNiKCk7XG4gICAgfTtcblxuICAgIGl0VGVzdCA9IG5ld0l0IHx8IGl0VGVzdCB8fCBmdW5jdGlvbiAobXNnLCBjYikge1xuICAgICAgICBjb25zdCBtb2R1bGUgPSB7XG4gICAgICAgICAgICBkb25lOiAoKSA9PiB7fSxcbiAgICAgICAgICAgIHRpbWVvdXQ6ICgpID0+IHt9XG4gICAgICAgIH07XG5cbiAgICAgICAgY2IuYmluZChtb2R1bGUpKG1vZHVsZS5kb25lKTtcbiAgICB9O1xuICAgIGl0VGVzdC5za2lwID0gbmV3SXQgJiYgbmV3SXQuc2tpcCB8fCBpdFRlc3QgJiYgaXRUZXN0LnNraXAgfHwgZnVuY3Rpb24gKG1zZywgY2IpIHtcbiAgICAgICAgY29uc3QgbW9kdWxlID0ge1xuICAgICAgICAgICAgZG9uZTogKCkgPT4ge30sXG4gICAgICAgICAgICB0aW1lb3V0OiAoKSA9PiB7fVxuICAgICAgICB9O1xuXG4gICAgICAgIGNiLmJpbmQobW9kdWxlKShtb2R1bGUuZG9uZSk7XG4gICAgfTtcblxuICAgIC8qIGVzbGludC1kaXNhYmxlIG5vLWNvbnNvbGUgKi9cbiAgICBsb2dXYXJuID0gbmV3V2FybiB8fCBsb2dXYXJuIHx8IGZ1bmN0aW9uIChtb2R1bGUsIC4uLm1zZykgeyBjb25zb2xlLndhcm4obW9kdWxlLCAuLi5tc2cpOyB9O1xuICAgIC8qIGVzbGludC1lbmFibGUgbm8tY29uc29sZSAqL1xufTtcblxuLy8tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG4vLyBSdW50aW1lXG5cbmlmIChhcmd2ICYmIGFyZ3YubW9jaGEpIHtcbiAgICAvKiBlc2xpbnQtZGlzYWJsZSBuby11bmRlZiAqL1xuICAgIHNldHVwKGRlc2NyaWJlLCBpdCk7XG4gICAgLyogZXNsaW50LWVuYWJsZSBuby11bmRlZiAqL1xufSBlbHNlIHtcbiAgICBzZXR1cCgpO1xufVxuYXJndiAmJiBhcmd2LmNvbmZpZyAmJiBydW4oYXJndi5jb25maWcpO1xuZXhwb3J0IHsgc2V0dXAgfTtcbmV4cG9ydCB7IHJ1biB9O1xuXG4vLyBFc3NlbnRpYWxseSBmb3IgdGVzdGluZyBwdXJwb3Nlc1xuZXhwb3J0IGNvbnN0IF9fdGVzdE1ldGhvZHNfXyA9IHsgcnVuLCBzZXR1cCwgZ2F0aGVyRGF0YSwgYnVpbGRBdWRpdHMsIHJ1bkF1ZGl0LCBydW5SdWxlIH07XG4iXX0= at SyntaxError: Unexpected character '#' (1:78)
    at Parser.pp$4.raise (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2221:15)
    at Parser.pp$7.getTokenFromCode (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2756:10)
    at Parser.pp$7.readToken (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2477:17)
    at Parser.readToken (/root/ExpoSE/lib/Tropigate/bin/Tokens.js:124:26)
    at Parser.pp$7.nextToken (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2468:15)
    at Parser.pp$7.next (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:2413:10)
    at Parser.pp.eat (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:536:12)
    at Parser.pp.semicolon (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:581:15)
    at Parser.pp$1.parseVarStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:918:10)
    at Parser.pp$1.parseStatement (/root/ExpoSE/lib/Tropigate/node_modules/acorn/dist/acorn.js:706:19)
*-- Replay with NO_COMPILE=1 expoSE replay '/root/ExpoSE/lib/Harness/src/harness.js' '{"_bound":0}'
*-- Coverage Data
*- File /root/ExpoSE/lib/Harness/src/harness.js. Coverage (Term): 18% Coverage (LOC): 24%
*- File /root/ExpoSE/lib/S$/bin/symbols.js. Coverage (Term): 16% Coverage (LOC): 34%
*- Re-run with EXPOSE_PRINT_COVERAGE=1 to print line by line coverage information
** ExpoSE Finished. 1 paths with 1 errors **
