{"_id":"53de3af62254d5a10461bf01","poster":"newghost","title":"Install NodeJS NPM and OurJS under Debian (Amazon EC2 free tier)","category":"Learn","verify":1,"keyword":"Share","summary":"<p>Here is the procedure to install nodejs, npm and ourjs on Debian.</p><p><b>1) Choose Amazon free tier EC2 instance</b></p><p>My choice is debian-squeeze-amd64-pvm-2014-07-21-ebs, </p><blockquote>Type t1.micro<br>Memory (GiB) 0.613</blockquote><p><br></p>","content":"<h1><b>Basic Install</b></h1><p><b style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\"><br></b></p><p><b style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">1) Choose Amazon free tier EC2 instance</b><br></p><p><span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">My choice is debian-squeeze-amd64-pvm-2014-07-21-ebs,&nbsp;</span></p><p> </p><p>Type&nbsp;<span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">t1.micro &nbsp;</span><span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">Memory (GiB) 0.613</span></p><p><b style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">2) Using admin to login SSH</b><br></p><p><span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">Etc: admin@youripaddress, <a href=\"https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/putty.html\">detail</a></span><br></p><p>After log on, switch to root user:</p><pre>sudo -i</pre><p><b>3) Install Node and npm</b></p><p>Follow these&nbsp;<a href=\"https://gist.github.com/isaacs/579814#file-node-and-npm-in-30-seconds-sh\">steps</a>,&nbsp;<span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">node version 0.10.30</span></p><p>   Need pre-install: curl, GCC (4.2+), GNU make (3.81+).  python (2.6 or 2.7) and build-essential, <a href=\"https://github.com/joyent/node/wiki/Installation\">detail</a></p><pre>apt-get update <br>apt-get install curl<br>apt-get install python<br>apt-get install gcc<br>apt-get install make<br>apt-get install build-essential     #(g++ and make included in it, <a href=\"http://packages.ubuntu.com/lucid/build-essential\">detail</a>)<br>apt-get install libssl-dev [optional]</pre><p>Check Version:</p><pre>$node --version<br>v0.10.30</pre><p><b>4)  Install OurJS</b></p><p>Choose a \"right\" place to run these shells, (etc: /var/www)</p><pre>npm install ourjs<br>cp -r node_modules/ourjs ./<br>chmod 755 ./ourjs/ourjs.sh &amp;&amp; ./ourjs/ourjs.sh</pre><p>If you are trying on Windows, there maybe some errors, like: Failed to locate: \"CL.exe\".  Don't worry it caused by a dependence of mongodb, we don't need that function.</p><p><b>6) Trying at http://localhost:8054</b></p><p>If you want to access your web via public IP, add TCP port 8054 to the security group.</p><p><br></p><p><span style=\"font-size: 24px; line-height: 1.4;\"><br></span></p><p><span style=\"font-size: 24px; line-height: 1.4;\"><br></span></p><p><span style=\"font-size: 24px; line-height: 1.4;\">Advance config</span><br></p><p><b>1) Install nginx</b></p><pre>apt-get install nginx</pre><p>Update config and save, see an <a href=\"https://raw.githubusercontent.com/newghost/ourjs/master/tools/nginx.conf\">example</a>, e<span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">dit:</span></p><pre>nano /etc/nginx/nginx.conf</pre><p>Testing config</p><pre>nginx -c /etc/nginx/nginx.conf -t</pre><p>Restart nginx</p><pre>/etc/init.d/nginx restart</pre><p><br></p><p><b>2) Auto start ourjs after reboot</b></p><p>Be careful, you'd better create&nbsp;<font face=\"inherit\"><span style=\"font-size: 1rem; line-height: 1.6;\">a&nbsp;</span></font>snapshot&nbsp;<span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">before doing this</span><span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">.</span></p><p>Create an init script under /etc/init.d, here is and&nbsp;<a href=\"https://raw.githubusercontent.com/newghost/ourjs/master/tools/ourjs\">example</a>.</p><pre>cp /var/www/ourjs/tools/ourjs /etc/init.d<br>chmod 755 /etc/init.d/ourjs<br>/etc/init.d/ourjs start</pre><p>If there is error, check the log and fix it</p><pre>cat /var/www/ourjs/error.log</pre><p>Add to the auto-start list</p><pre>update-rc.d ourjs defaults</pre><p><br></p><p><b>3) Disable debug mode</b></p><pre>sudo nano /var/www/ourjs/config.magazine.js</pre><p><span style=\"font-family: inherit; font-size: 1rem; line-height: 1.6;\">debug = false: Means ourjs will cache the templates and do not console log the debug information. This mode will reduce the unnecessary I/O operations.</span><br></p><blockquote>/*<br>* Configuration for theme \"magazine\"<br>*/<br>var debug = <b>false</b>;<br>var WEBSVR_CONFIG = {</blockquote><p><br></p><p><b>4) Setup ftp under Debian</b></p><p><a href=\"http://www.thomas-krenn.com/en/wiki/Setup_FTP_Server_under_Debian\">Detail</a></p><p>Add permission of web folder for ftp user&nbsp;</p><pre>sudo chmod -R 777 /var/www</pre>","description":"Hereistheproceduretoinstallnodejs,npmandourjsonDebian.1)ChooseAmazonfreetierEC2instanceMychoiceisdebian-squeeze-amd64-pvm-2014-07-21-ebs,Typ","url":"","postdate":1407073014435,"publishTime":1407073960832,"replies":[{"reply":"<p>&lt;script&gt;alert('hello,world!')&lt;/script&gt;</p>","poster":"sano","postdate":1407122208574,"deleted":true,"avatar":"9b7c526f7ba83653e62cbd3151a09fa9"},{"nickname":"rough_lake","reply":"<p>Looks Good!&nbsp;</p><p>Will try it.</p>","postdate":1407462879970}],"replyTime":1407462879970,"urlSlug":"install-nodejs-npm-and-ourjs-under-debian-amazon-ec2-free-tier-"}