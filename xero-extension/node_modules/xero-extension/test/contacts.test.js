'use strict';
var should = require('should');
var Xero = require('../').Xero;


var config = require('../config/config.json')['test'];

var fs = require('fs');

	var config = {	key:config.ConsumerKey, 
					secret:config.ConsumerSecret, 
					rsa_key: fs.readFileSync(config.Path, "utf-8")
				};



var xero = new Xero(config);


describe('Contacts', function(){
	 this.timeout(10000);
   describe('find contact like', function () {
     it('should find a contact like the search', function (done) {
       xero.contacts.findAll({
         query: {
           where: 'Name.contains("a")'
         }
        }).then(function (json) {
          should.exist(json);
          done();
        }).catch(done);
     });
   });

	 describe('findById', function(){
	 	it.only(' Should Find One Contact ', function(done){
	 		xero.contacts.findById('41a42865-f15a-4fa1-b643-47877608f557').then(function(json){
	 			
	 			should.exist(json);
	 			json.should.have.property('ContactID', '41a42865-f15a-4fa1-b643-47877608f557');
	 			done();
	 		}).catch(done);
	 	});

	 });
	 describe('create', function(){
	 	 it('Should Create new Contact', function(done){

	 	var cust = {
	 		Name: 'Paul Robinson',

	 	};
	 	xero.contacts.createOrUpdate(cust).then(function(json){
       should.exist(json);
       json.should.have.property('ContactID');
	 	  
	 		
	 		done();
	 	}).catch(done);
	 });

	 });
	
	
	describe('bulkCreate', function(){
		it('Should Create Multiple Customers', function(done){
		
		var custs = [{Name: 'Bilbo Bagins'}, {Name:'Sam Wise'}];

		xero.contacts.bulkCreate(custs).then(function(json){
			

	 		should.exist(json);
			done();
		}).catch(done);
	});
	});

	describe('bulkCreateOrUpdate', function(){
		it('Should Create or Update Multiple Customers', function(done){
		
		var custs = [{Name: 'Bilbo Bagins'}, {Name:'Sam Wise'}];

		xero.contacts.bulkCreateOrUpdate(custs).then(function(json){

	 		should.exist(json);
			done();
		}).catch(done);
	});

	});

	describe('findAll', function(){
		it('Should exist', function(done){
		
		xero.contacts.findAll().then(function(json){	 		
      should.exist(json);
      should.equal(json.length > 1, true);
			done();
		}).catch(done);
	});

	});

});