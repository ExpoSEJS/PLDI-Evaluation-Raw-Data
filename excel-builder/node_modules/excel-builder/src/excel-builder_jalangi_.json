{"8":[17,25,17,53],"9":[1,20,1,27],"10":[17,25,17,53],"16":[24,29,24,65],"17":[1,28,1,32],"18":[24,29,24,37],"24":[37,21,37,79],"25":[1,20,1,33],"26":[24,41,24,65],"32":[37,21,37,79],"33":[1,20,1,33],"34":[37,46,37,48],"40":[46,49,46,62],"41":[1,20,1,33],"42":[37,21,37,48],"49":[2,26,2,38],"50":[37,77,37,79],"57":[2,26,2,45],"58":[37,52,37,79],"65":[2,26,2,45],"73":[2,26,2,45],"81":[3,1,3,13],"89":[3,1,3,14],"97":[4,9,4,16],"105":[4,17,4,25],"113":[4,9,4,26],"121":[4,9,4,26],"129":[4,9,4,26],"137":[5,16,5,23],"145":[5,24,5,42],"153":[5,16,5,43],"161":[5,16,5,43],"169":[5,16,5,43],"177":[6,13,6,20],"185":[6,21,6,28],"193":[6,13,6,29],"201":[6,13,6,29],"209":[6,13,6,29],"217":[9,20,9,28],"225":[9,16,9,30],"233":[9,16,9,30],"241":[9,9,9,31],"249":[8,21,10,6],"257":[8,21,10,6],"265":[8,21,10,6],"273":[11,30,11,35],"281":[11,13,11,37],"289":[13,9,13,17],"297":[15,34,15,40],"305":[15,41,15,48],"313":[15,55,15,77],"321":[15,41,15,78],"323":[15,41,15,54],"329":[15,30,15,79],"337":[15,30,15,79],"345":[15,30,15,79],"353":[16,17,16,23],"361":[16,41,16,50],"369":[17,25,17,30],"377":[17,25,17,35],"385":[17,25,17,42],"393":[17,47,17,53],"401":[18,25,18,32],"409":[18,41,18,46],"417":[18,41,18,51],"425":[18,41,18,56],"433":[18,25,18,57],"435":[18,25,18,40],"441":[18,25,18,58],"449":[16,52,20,18],"457":[16,52,20,18],"465":[16,52,20,18],"473":[16,52,20,18],"481":[16,17,20,19],"483":[16,17,16,40],"489":[16,17,20,20],"497":[21,17,21,23],"505":[22,28,22,33],"513":[23,29,23,36],"521":[23,43,23,50],"529":[23,29,23,51],"531":[23,29,23,42],"537":[24,30,24,37],"545":[24,41,24,48],"553":[24,41,24,55],"561":[24,60,24,65],"569":[21,36,25,18],"577":[21,17,25,19],"579":[21,17,21,35],"585":[21,17,25,20],"593":[14,22,26,14],"601":[14,22,26,14],"609":[14,22,26,14],"617":[14,22,26,14],"625":[14,22,26,14],"633":[28,17,28,24],"641":[28,17,28,32],"643":[28,17,28,30],"649":[28,17,28,33],"657":[27,20,29,14],"665":[27,20,29,14],"673":[27,20,29,14],"681":[13,37,30,10],"689":[13,9,30,11],"691":[13,9,13,36],"697":[13,9,30,12],"705":[12,22,31,6],"713":[12,22,31,6],"721":[12,22,31,6],"729":[12,22,31,6],"737":[12,22,31,6],"745":[33,23,33,28],"753":[33,19,33,30],"761":[33,19,33,30],"769":[33,19,33,30],"777":[34,16,34,24],"785":[34,16,34,40],"787":[34,16,34,38],"793":[35,13,35,14],"801":[35,20,35,25],"809":[36,24,36,28],"817":[36,36,36,37],"825":[36,24,36,38],"827":[36,24,36,35],"833":[36,24,36,38],"841":[36,17,36,39],"849":[37,21,37,25],"857":[37,34,37,40],"865":[37,21,37,41],"867":[37,21,37,33],"873":[37,47,37,48],"881":[37,52,37,56],"889":[37,65,37,71],"897":[37,52,37,72],"899":[37,52,37,64],"905":[37,78,37,79],"913":[38,21,38,24],"921":[38,30,38,34],"929":[38,36,38,43],"937":[38,55,38,60],"945":[38,45,38,62],"953":[38,21,38,63],"955":[38,21,38,29],"961":[38,21,38,64],"969":[40,21,40,24],"977":[40,30,40,34],"985":[40,36,40,43],"993":[41,33,41,37],"1001":[42,33,42,37],"1009":[40,45,43,22],"1017":[40,21,43,23],"1019":[40,21,40,29],"1025":[40,21,43,24],"1033":[35,27,45,14],"1041":[35,27,45,14],"1049":[35,27,45,14],"1057":[35,27,45,14],"1065":[35,27,45,14],"1073":[35,13,45,15],"1075":[35,13,35,19],"1081":[35,13,45,16],"1089":[46,20,46,23],"1097":[46,38,46,39],"1105":[46,49,46,56],"1113":[46,60,46,62],"1121":[46,72,46,80],"1129":[46,64,46,82],"1137":[46,38,46,83],"1139":[46,38,46,48],"1145":[46,20,46,84],"1147":[46,20,46,37],"1153":[46,20,46,84],"1161":[46,13,46,85],"1169":[34,46,47,10],"1177":[34,46,47,10],"1185":[34,46,47,10],"1193":[34,46,47,10],"1201":[34,16,47,11],"1203":[34,16,34,45],"1209":[34,16,47,11],"1217":[34,9,47,12],"1225":[32,17,48,6],"1233":[32,17,48,6],"1241":[32,17,48,6],"1249":[32,17,48,6],"1257":[32,17,48,6],"1265":[32,17,48,6],"1273":[7,15,49,2],"1281":[7,15,49,2],"1289":[7,15,49,2],"1297":[50,1,50,7],"1305":[50,18,50,25],"1313":[50,1,50,25],"1321":[50,1,50,26],"1329":[1,1,50,26],"1337":[1,1,50,26],"1345":[1,1,50,26],"1353":[1,1,50,26],"1361":[1,1,50,26],"1369":[1,1,50,26],"1377":[1,1,50,26],"1385":[8,21,10,6],"1393":[8,21,10,6],"1401":[17,21,19,22],"1409":[16,52,20,18],"1417":[16,52,20,18],"1425":[14,22,26,14],"1433":[14,22,26,14],"1441":[27,20,29,14],"1449":[27,20,29,14],"1457":[12,22,31,6],"1465":[12,22,31,6],"1473":[37,17,44,18],"1481":[35,27,45,14],"1489":[35,27,45,14],"1497":[34,46,47,10],"1505":[34,46,47,10],"1513":[32,17,48,6],"1521":[32,17,48,6],"1529":[1,1,50,26],"1537":[1,1,50,26],"nBranches":10,"originalCodeFileName":"/home/blake/ExpoSE/Targets/excel-builder/node_modules/excel-builder/src/excel-builder.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/excel-builder/node_modules/excel-builder/src/excel-builder_jalangi_.js","code":"\"use strict\";\r\nvar _ = require('lodash');\r\nvar Workbook = require('./Excel/Workbook');\r\nvar JSZip = require('jszip');\r\n//var WorkbookWorker = require('./Worker');\r\n\r\n/**\r\n * @name Excel\r\n * @public\r\n * @author Stephen Liberty\r\n * @requires underscore\r\n * @requires Excel/Workbook\r\n * @requires JSZIP\r\n * @exports excel-builder\r\n */\r\nvar Factory = {\r\n    /**\r\n     * Creates a new workbook.\r\n     */\r\n    createWorkbook: function () {\r\n        return new Workbook();\r\n    },\r\n\r\n    config: {\r\n        forceUIThread: false\r\n    },\r\n\r\n    /**\r\n     * Turns a workbook into a downloadable file.\r\n     * @param {Excel/Workbook} workbook The workbook that is being converted\r\n     * @param {Object} options\r\n     * @param {Boolean} options.base64 Whether to 'return' the generated file as a base64 string\r\n     * @param {Function} options.success The callback function to run after workbook creation is successful.\r\n     * @param {Function} options.error The callback function to run if there is an error creating the workbook.\r\n     * @param {String} options.requireJsPath (Optional) The path to requirejs. Will use the id 'requirejs' to look up the script if not specified.\r\n     */\r\n    createFileAsync: function (workbook, options) {\r\n\r\n\r\n        workbook.generateFilesAsync({\r\n            success: function (files) {\r\n\r\n                var worker = new Worker(require.toUrl('./Excel/ZipWorker.js'));\r\n                worker.addEventListener('message', function(event) {\r\n                    if(event.data.status === 'done') {\r\n                        options.success(event.data.data);\r\n                    }\r\n                });\r\n                worker.postMessage({\r\n                    files: files,\r\n                    ziplib: require.toUrl('JSZip'),\r\n                    base64: (!options || options.base64 !== false)\r\n                });\r\n            },\r\n            error: function () {\r\n                options.error();\r\n            }\r\n        });\r\n    },\r\n\r\n    /**\r\n     * Turns a workbook into a downloadable file.\r\n     * @param {Excel/Workbook} workbook The workbook that is being converted\r\n     * @param {Object} options - options to modify how the zip is created. See http://stuk.github.io/jszip/#doc_generate_options\r\n     * @returns {Promise}\r\n     */\r\n    createFile: function (workbook, options) {\r\n        var zip = new JSZip();\r\n        return workbook.generateFiles().then(function (files) {\r\n            _.each(files, function (content, path) {\r\n                path = path.substr(1);\r\n                if(path.indexOf('.xml') !== -1 || path.indexOf('.rel') !== -1) {\r\n                    zip.file(path, content, {base64: false});\r\n                } else {\r\n                    zip.file(path, content, {base64: true, binary: true});\r\n                }\r\n            });\r\n            return zip.generateAsync(_.defaults(options || {}, {\r\n                type: \"base64\"\r\n            }));\r\n        });\r\n    }\r\n};\r\n\r\n\r\nmodule.exports = Factory;"}