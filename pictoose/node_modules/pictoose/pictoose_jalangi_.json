{"8":[74,9,74,35],"9":[1,20,1,27],"10":[89,9,89,36],"16":[81,9,81,35],"17":[1,28,1,32],"18":[90,38,90,64],"24":[89,9,89,36],"25":[1,20,1,33],"26":[93,13,93,44],"32":[93,13,93,44],"33":[1,20,1,33],"34":[100,9,100,14],"40":[100,9,100,14],"41":[1,20,1,33],"42":[103,30,103,32],"48":[103,9,103,32],"49":[2,26,2,38],"50":[103,9,103,32],"56":[106,9,106,51],"57":[2,26,2,45],"58":[106,9,106,51],"64":[114,26,114,31],"65":[2,26,2,45],"66":[114,26,114,31],"72":[119,9,119,43],"73":[2,26,2,45],"74":[114,33,114,36],"80":[123,13,123,31],"81":[3,1,3,13],"88":[124,10,124,16],"89":[3,1,3,14],"90":[115,53,115,69],"96":[127,10,127,16],"97":[4,10,4,17],"98":[115,36,115,70],"104":[130,10,130,16],"105":[4,18,4,22],"106":[115,19,115,72],"112":[145,13,145,16],"113":[4,10,4,23],"114":[119,9,119,43],"120":[146,10,146,15],"121":[4,10,4,23],"122":[123,28,123,30],"128":[149,10,149,15],"129":[4,10,4,23],"130":[134,34,134,52],"136":[152,10,152,15],"137":[5,12,5,19],"138":[162,33,162,44],"144":[165,20,165,46],"145":[5,20,5,26],"146":[162,33,162,55],"152":[165,20,165,46],"153":[5,12,5,27],"154":[165,32,165,46],"160":[163,13,163,37],"161":[5,12,5,27],"162":[166,58,166,69],"168":[183,25,183,127],"169":[5,12,5,27],"170":[166,58,166,80],"176":[185,33,185,36],"177":[6,11,6,18],"178":[166,20,166,81],"184":[183,25,183,127],"185":[6,19,6,24],"186":[180,28,180,70],"192":[194,25,194,28],"193":[6,11,6,25],"194":[180,28,180,82],"200":[179,17,179,26],"201":[6,11,6,25],"202":[181,28,181,39],"208":[205,20,205,101],"209":[6,11,6,25],"210":[181,28,181,50],"216":[208,21,208,24],"217":[8,23,8,30],"218":[182,71,182,82],"224":[216,20,216,48],"225":[8,31,8,51],"226":[182,71,182,93],"232":[216,20,216,70],"233":[8,23,8,52],"234":[182,27,182,94],"240":[218,21,218,24],"241":[8,23,8,52],"242":[183,94,183,105],"248":[225,20,225,41],"249":[8,23,8,52],"250":[183,94,183,116],"256":[216,20,216,70],"257":[10,23,10,27],"258":[183,50,183,117],"264":[205,20,205,101],"265":[10,23,10,27],"266":[184,79,184,90],"272":[176,13,176,31],"273":[10,23,10,27],"274":[184,79,184,101],"280":[246,17,246,97],"281":[9,3,11,2],"282":[184,35,184,102],"288":[249,17,249,105],"289":[13,28,13,42],"290":[186,45,186,111],"296":[253,21,253,24],"297":[14,27,14,37],"298":[186,125,186,136],"304":[279,9,279,42],"305":[15,24,15,37],"306":[186,125,186,147],"312":[279,9,279,42],"313":[12,16,16,2],"314":[186,45,186,148],"320":[287,20,287,89],"321":[12,16,16,2],"322":[193,30,193,71],"328":[287,20,287,157],"329":[12,16,16,2],"330":[195,37,195,108],"336":[287,20,287,172],"337":[17,24,17,30],"338":[195,37,195,119],"344":[287,20,287,172],"345":[17,31,17,109],"346":[197,36,197,47],"352":[285,13,285,19],"353":[17,20,17,110],"354":[197,36,197,58],"361":[17,20,17,110],"362":[203,29,203,60],"369":[17,20,17,110],"370":[205,59,205,100],"377":[18,31,18,37],"378":[205,44,205,101],"385":[18,38,18,80],"386":[206,24,206,35],"393":[18,27,18,81],"394":[206,24,206,46],"401":[18,27,18,81],"402":[207,30,207,71],"409":[18,27,18,81],"410":[209,33,209,95],"417":[21,20,21,25],"418":[209,33,209,106],"425":[22,15,22,22],"426":[211,32,211,43],"433":[20,18,23,6],"434":[211,32,211,54],"441":[25,20,25,25],"442":[216,20,216,31],"449":[26,15,26,22],"450":[216,35,216,48],"457":[24,18,27,6],"458":[216,52,216,70],"465":[29,20,29,26],"466":[217,67,217,78],"473":[30,15,30,22],"474":[217,67,217,89],"481":[28,19,31,6],"482":[217,23,217,90],"489":[33,20,33,25],"490":[219,33,219,100],"497":[34,15,34,22],"498":[219,114,219,125],"505":[32,18,35,6],"506":[219,114,219,136],"513":[37,20,37,25],"514":[219,33,219,137],"521":[38,15,38,22],"522":[224,24,224,35],"529":[36,28,39,6],"530":[224,24,224,46],"537":[41,20,41,25],"538":[226,24,226,35],"545":[42,15,42,22],"546":[226,24,226,46],"553":[40,18,43,6],"554":[228,27,228,53],"561":[45,20,45,26],"562":[235,19,235,34],"569":[46,15,46,22],"570":[235,19,235,45],"577":[44,19,47,6],"578":[246,69,246,84],"585":[49,20,49,25],"586":[246,69,246,95],"593":[50,15,50,22],"594":[246,32,246,96],"601":[48,18,51,6],"602":[246,17,246,97],"609":[53,20,53,25],"610":[249,68,249,83],"617":[54,15,54,22],"618":[249,68,249,94],"625":[52,18,55,6],"626":[249,31,249,95],"633":[57,20,57,25],"634":[249,17,249,105],"641":[58,15,58,22],"642":[252,60,252,75],"649":[56,22,59,6],"650":[252,60,252,86],"657":[61,20,61,25],"658":[252,23,252,87],"665":[62,15,62,22],"666":[254,33,254,84],"673":[60,24,63,6],"674":[254,91,254,106],"681":[65,20,65,25],"682":[254,91,254,117],"689":[66,15,66,22],"690":[254,33,254,118],"697":[64,24,67,6],"698":[282,20,282,38],"705":[69,20,69,26],"706":[282,20,282,57],"713":[70,15,70,22],"714":[282,20,282,77],"721":[68,19,71,6],"722":[284,15,284,56],"729":[19,13,72,2],"730":[286,26,286,66],"737":[19,13,72,2],"738":[287,37,287,89],"745":[19,13,72,2],"746":[287,107,287,156],"753":[74,9,74,14],"754":[290,42,290,91],"761":[74,30,74,34],"762":[297,30,297,71],"769":[74,9,74,35],"770":[298,26,298,66],"771":[74,9,74,29],"777":[75,16,75,21],"778":[300,26,300,74],"785":[75,22,75,26],"793":[75,16,75,27],"801":[75,16,75,37],"809":[75,16,75,37],"817":[75,9,75,38],"825":[77,16,77,21],"833":[77,16,77,21],"841":[77,9,77,22],"849":[73,24,79,2],"857":[73,24,79,2],"865":[73,24,79,2],"873":[73,24,79,2],"881":[73,24,79,2],"889":[73,24,79,2],"897":[81,9,81,14],"905":[81,30,81,34],"913":[81,9,81,35],"915":[81,9,81,29],"921":[82,16,82,21],"929":[82,22,82,26],"937":[82,16,82,27],"945":[82,16,82,32],"953":[82,16,82,32],"961":[82,9,82,33],"969":[84,16,84,21],"977":[84,16,84,21],"985":[84,9,84,22],"993":[80,19,86,2],"1001":[80,19,86,2],"1009":[80,19,86,2],"1017":[80,19,86,2],"1025":[80,19,86,2],"1033":[80,19,86,2],"1041":[88,21,88,24],"1049":[88,21,88,24],"1057":[88,21,88,24],"1065":[89,9,89,18],"1073":[89,27,89,30],"1081":[89,9,89,31],"1083":[89,9,89,26],"1089":[89,35,89,36],"1097":[90,21,90,30],"1105":[90,38,90,47],"1113":[90,56,90,59],"1121":[90,38,90,60],"1123":[90,38,90,55],"1129":[90,63,90,64],"1137":[90,21,90,65],"1139":[90,21,90,37],"1145":[90,21,90,65],"1153":[90,9,90,66],"1161":[92,19,92,24],"1169":[93,13,93,18],"1177":[93,19,93,20],"1185":[93,13,93,21],"1193":[93,13,93,31],"1201":[93,35,93,44],"1209":[94,20,94,25],"1217":[94,26,94,27],"1225":[94,20,94,28],"1233":[94,20,94,33],"1241":[94,20,94,33],"1249":[94,13,94,34],"1257":[92,19,92,24],"1265":[92,5,96,6],"1273":[92,5,96,6],"1281":[97,12,97,17],"1289":[97,12,97,17],"1297":[97,5,97,18],"1305":[87,30,98,2],"1313":[87,30,98,2],"1321":[87,30,98,2],"1329":[87,30,98,2],"1337":[87,30,98,2],"1345":[87,30,98,2],"1353":[87,30,98,2],"1361":[87,30,98,2],"1369":[100,10,100,14],"1377":[101,16,101,21],"1385":[101,16,101,21],"1393":[101,9,101,22],"1401":[103,9,103,13],"1409":[103,22,103,25],"1417":[103,9,103,26],"1419":[103,9,103,21],"1425":[103,31,103,32],"1433":[104,16,104,21],"1441":[104,16,104,21],"1449":[104,9,104,22],"1457":[106,9,106,13],"1465":[106,22,106,25],"1473":[106,9,106,26],"1475":[106,9,106,21],"1481":[106,30,106,34],"1489":[106,47,106,50],"1497":[106,30,106,51],"1499":[106,30,106,46],"1505":[107,16,107,21],"1513":[107,16,107,21],"1521":[107,9,107,22],"1529":[109,13,109,17],"1537":[109,24,109,27],"1545":[109,13,109,28],"1547":[109,13,109,23],"1553":[109,29,109,30],"1561":[109,13,109,31],"1569":[109,13,109,31],"1577":[109,13,109,31],"1585":[110,12,110,24],"1593":[110,30,110,31],"1601":[110,12,110,32],"1603":[110,12,110,29],"1609":[110,12,110,32],"1617":[110,5,110,33],"1625":[99,19,111,2],"1633":[99,19,111,2],"1641":[99,19,111,2],"1649":[99,19,111,2],"1657":[99,19,111,2],"1665":[99,19,111,2],"1673":[99,19,111,2],"1681":[113,18,113,20],"1689":[113,18,113,20],"1697":[113,18,113,20],"1705":[114,18,114,24],"1713":[114,18,114,24],"1721":[114,18,114,24],"1729":[114,26,114,27],"1737":[114,30,114,31],"1753":[114,35,114,36],"1761":[114,33,114,36],"1769":[115,19,115,24],"1777":[115,25,115,29],"1785":[115,36,115,40],"1793":[115,36,115,49],"1795":[115,36,115,47],"1801":[115,53,115,58],"1809":[115,53,115,65],"1817":[115,68,115,69],"1825":[115,25,115,71],"1827":[115,25,115,35],"1833":[115,19,115,72],"1841":[115,9,115,15],"1849":[115,9,115,72],"1857":[115,9,115,73],"1865":[116,12,116,18],"1873":[116,12,116,18],"1881":[116,5,116,19],"1889":[112,20,117,2],"1897":[112,20,117,2],"1905":[112,20,117,2],"1913":[112,20,117,2],"1921":[112,20,117,2],"1929":[112,20,117,2],"1937":[112,20,117,2],"1945":[112,20,117,2],"1953":[112,20,117,2],"1961":[119,10,119,29],"1969":[119,35,119,42],"1977":[119,10,119,43],"1979":[119,10,119,34],"1985":[120,16,120,21],"1993":[120,16,120,21],"2001":[120,9,120,22],"2009":[123,13,123,20],"2017":[123,29,123,30],"2025":[123,13,123,31],"2027":[123,13,123,27],"2033":[125,16,125,28],"2041":[125,16,125,28],"2049":[125,9,125,29],"2057":[124,10,124,16],"2065":[128,16,128,27],"2073":[128,16,128,27],"2081":[128,9,128,28],"2089":[127,10,127,16],"2097":[131,16,131,22],"2105":[131,16,131,22],"2113":[131,9,131,23],"2121":[130,10,130,16],"2129":[134,16,134,23],"2137":[134,31,134,32],"2145":[134,34,134,41],"2153":[134,34,134,48],"2161":[134,51,134,52],"2169":[134,16,134,53],"2171":[134,16,134,30],"2177":[134,16,134,53],"2185":[134,16,134,53],"2193":[135,16,135,20],"2201":[135,27,135,30],"2209":[135,16,135,31],"2211":[135,16,135,26],"2217":[135,16,135,31],"2225":[135,16,135,31],"2233":[137,16,137,24],"2241":[137,25,137,29],"2249":[137,30,137,31],"2257":[137,25,137,32],"2265":[137,16,137,33],"2273":[138,17,138,25],"2281":[138,26,138,30],"2289":[138,31,138,32],"2297":[138,26,138,33],"2305":[138,17,138,34],"2313":[139,15,139,19],"2321":[136,12,140,6],"2329":[136,12,140,6],"2337":[136,5,140,7],"2345":[118,26,141,2],"2353":[118,26,141,2],"2361":[118,26,141,2],"2369":[118,26,141,2],"2377":[118,26,141,2],"2385":[118,26,141,2],"2393":[118,26,141,2],"2401":[118,26,141,2],"2409":[143,15,143,24],"2417":[143,15,143,38],"2419":[143,15,143,36],"2425":[143,15,143,38],"2433":[143,15,143,38],"2441":[145,13,145,16],"2449":[147,18,147,23],"2457":[147,18,147,23],"2465":[147,9,147,24],"2473":[146,10,146,15],"2481":[150,18,150,23],"2489":[150,18,150,23],"2497":[150,9,150,24],"2505":[149,10,149,15],"2513":[153,18,153,23],"2521":[153,18,153,23],"2529":[153,9,153,24],"2537":[152,10,152,15],"2545":[156,18,156,24],"2553":[156,18,156,24],"2561":[156,9,156,25],"2569":[158,12,158,18],"2577":[158,12,158,18],"2585":[158,5,158,19],"2593":[142,32,159,2],"2601":[142,32,159,2],"2609":[142,32,159,2],"2617":[142,32,159,2],"2625":[142,32,159,2],"2633":[142,32,159,2],"2641":[142,32,159,2],"2649":[142,32,159,2],"2657":[162,24,162,28],"2665":[162,33,162,36],"2673":[162,39,162,44],"2681":[162,47,162,55],"2689":[162,24,162,56],"2691":[162,24,162,32],"2697":[162,24,162,56],"2705":[162,24,162,56],"2713":[163,13,163,16],"2721":[163,23,163,31],"2729":[163,13,163,32],"2731":[163,13,163,22],"2737":[163,13,163,37],"2745":[164,20,164,28],"2753":[164,20,164,28],"2761":[164,13,164,29],"2769":[165,20,165,28],"2777":[165,32,165,40],"2785":[165,44,165,46],"2793":[166,20,166,28],"2801":[166,20,166,46],"2809":[166,49,166,53],"2817":[166,58,166,61],"2825":[166,64,166,69],"2833":[166,72,166,80],"2841":[166,49,166,81],"2843":[166,49,166,57],"2849":[166,20,166,81],"2857":[166,13,166,82],"2865":[168,20,168,22],"2873":[168,20,168,22],"2881":[168,13,168,23],"2889":[161,12,170,6],"2897":[161,12,170,6],"2905":[161,12,170,6],"2913":[161,12,170,6],"2921":[161,12,170,6],"2929":[161,5,170,7],"2937":[160,21,171,2],"2945":[160,21,171,2],"2953":[160,21,171,2],"2961":[160,21,171,2],"2969":[160,21,171,2],"2977":[160,21,171,2],"2985":[174,22,174,26],"2993":[174,22,174,26],"3001":[174,22,174,26],"3009":[175,24,175,28],"3017":[175,38,175,43],"3025":[175,24,175,44],"3027":[175,24,175,37],"3033":[175,24,175,44],"3041":[175,24,175,44],"3049":[176,13,176,24],"3057":[176,25,176,30],"3065":[176,13,176,31],"3073":[177,28,177,33],"3081":[177,41,177,42],"3089":[177,28,177,43],"3091":[177,28,177,40],"3097":[177,50,177,53],"3105":[177,28,177,54],"3107":[177,28,177,49],"3113":[177,55,177,56],"3121":[177,28,177,57],"3129":[177,28,177,57],"3137":[177,28,177,57],"3145":[178,29,178,45],"3153":[178,46,178,54],"3161":[178,29,178,55],"3169":[178,29,178,55],"3177":[178,29,178,55],"3185":[179,17,179,26],"3193":[180,28,180,40],"3201":[180,41,180,43],"3209":[180,45,180,63],"3217":[180,28,180,64],"3225":[180,67,180,70],"3233":[180,73,180,82],"3241":[180,28,180,82],"3249":[180,17,180,83],"3257":[181,17,181,23],"3265":[181,28,181,31],"3273":[181,34,181,39],"3281":[181,42,181,50],"3289":[181,52,181,60],"3297":[181,17,181,61],"3299":[181,17,181,27],"3305":[181,17,181,62],"3313":[182,17,182,19],"3321":[182,27,182,35],"3329":[182,27,182,57],"3337":[182,60,182,66],"3345":[182,71,182,74],"3353":[182,77,182,82],"3361":[182,85,182,93],"3369":[182,60,182,94],"3371":[182,60,182,70],"3377":[183,25,183,33],"3385":[183,37,183,39],"3393":[183,50,183,58],"3401":[183,50,183,80],"3409":[183,83,183,89],"3417":[183,94,183,97],"3425":[183,100,183,105],"3433":[183,108,183,116],"3441":[183,83,183,117],"3443":[183,83,183,93],"3449":[183,37,183,118],"3451":[183,37,183,49],"3457":[183,37,183,127],"3459":[183,37,183,125],"3465":[184,25,184,27],"3473":[184,35,184,43],"3481":[184,35,184,65],"3489":[184,68,184,74],"3497":[184,79,184,82],"3505":[184,85,184,90],"3513":[184,93,184,101],"3521":[184,68,184,102],"3523":[184,68,184,78],"3529":[185,33,185,36],"3537":[186,33,186,40],"3545":[186,45,186,78],"3553":[186,81,186,89],"3561":[186,81,186,111],"3569":[186,114,186,120],"3577":[186,125,186,128],"3585":[186,131,186,136],"3593":[186,139,186,147],"3601":[186,114,186,148],"3603":[186,114,186,124],"3609":[186,33,186,149],"3611":[186,33,186,44],"3617":[186,33,186,150],"3625":[187,33,187,40],"3633":[187,47,187,50],"3641":[187,33,187,51],"3643":[187,33,187,46],"3649":[187,33,187,52],"3657":[188,33,188,40],"3665":[188,33,188,40],"3673":[184,104,190,26],"3681":[184,104,190,26],"3689":[184,104,190,26],"3697":[184,104,190,26],"3705":[184,25,190,27],"3707":[184,25,184,34],"3713":[184,25,190,28],"3721":[182,96,192,18],"3729":[182,96,192,18],"3737":[182,96,192,18],"3745":[182,96,192,18],"3753":[182,17,192,19],"3755":[182,17,182,26],"3761":[182,17,192,20],"3769":[193,17,193,19],"3777":[193,30,193,38],"3785":[193,30,193,60],"3793":[193,63,193,71],"3801":[193,73,193,78],"3809":[193,85,193,88],"3817":[193,73,193,89],"3819":[193,73,193,84],"3825":[193,90,193,91],"3833":[193,73,193,92],"3841":[193,94,193,102],"3849":[194,25,194,28],"3857":[195,25,195,32],"3865":[195,37,195,75],"3873":[195,78,195,86],"3881":[195,78,195,108],"3889":[195,111,195,119],"3897":[195,25,195,120],"3899":[195,25,195,36],"3905":[195,25,195,121],"3913":[196,25,196,32],"3921":[196,39,196,42],"3929":[196,25,196,43],"3931":[196,25,196,38],"3937":[196,25,196,44],"3945":[197,25,197,31],"3953":[197,36,197,39],"3961":[197,42,197,47],"3969":[197,50,197,58],"3977":[197,60,197,62],"3985":[197,25,197,63],"3987":[197,25,197,35],"3993":[197,25,197,64],"4001":[198,25,198,32],"4009":[198,25,198,32],"4017":[200,21,200,27],"4025":[200,21,200,34],"4027":[200,21,200,32],"4033":[200,21,200,35],"4041":[193,104,201,18],"4049":[193,104,201,18],"4057":[193,104,201,18],"4065":[193,104,201,18],"4073":[193,17,201,19],"4075":[193,17,193,29],"4081":[193,17,201,20],"4089":[203,17,203,24],"4097":[203,29,203,49],"4105":[203,52,203,60],"4113":[203,17,203,61],"4115":[203,17,203,28],"4121":[203,17,203,62],"4129":[205,20,205,22],"4137":[205,34,205,39],"4145":[205,20,205,40],"4147":[205,20,205,33],"4153":[205,45,205,47],"4161":[205,59,205,67],"4169":[205,59,205,89],"4177":[205,92,205,100],"4185":[205,45,205,101],"4187":[205,45,205,58],"4193":[206,13,206,19],"4201":[206,24,206,27],"4209":[206,30,206,35],"4217":[206,38,206,46],"4225":[206,48,206,56],"4233":[206,13,206,57],"4235":[206,13,206,23],"4241":[206,13,206,58],"4249":[207,13,207,15],"4257":[207,23,207,28],"4265":[207,30,207,38],"4273":[207,30,207,60],"4281":[207,63,207,71],"4289":[208,21,208,24],"4297":[209,21,209,28],"4305":[209,33,209,62],"4313":[209,65,209,73],"4321":[209,65,209,95],"4329":[209,98,209,106],"4337":[209,21,209,107],"4339":[209,21,209,32],"4345":[209,21,209,108],"4353":[210,21,210,28],"4361":[210,35,210,38],"4369":[210,21,210,39],"4371":[210,21,210,34],"4377":[210,21,210,40],"4385":[211,21,211,27],"4393":[211,32,211,35],"4401":[211,38,211,43],"4409":[211,46,211,54],"4417":[211,56,211,58],"4425":[211,21,211,59],"4427":[211,21,211,31],"4433":[211,21,211,60],"4441":[212,21,212,28],"4449":[212,21,212,28],"4457":[214,17,214,23],"4465":[214,17,214,30],"4467":[214,17,214,28],"4473":[214,17,214,31],"4481":[207,73,215,14],"4489":[207,73,215,14],"4497":[207,73,215,14],"4505":[207,73,215,14],"4513":[207,13,215,15],"4515":[207,13,207,22],"4521":[207,13,215,16],"4529":[216,20,216,25],"4537":[216,29,216,31],"4545":[216,35,216,40],"4553":[216,44,216,48],"4561":[216,52,216,57],"4569":[216,61,216,70],"4577":[217,13,217,15],"4585":[217,23,217,31],"4593":[217,23,217,53],"4601":[217,56,217,62],"4609":[217,67,217,70],"4617":[217,73,217,78],"4625":[217,81,217,89],"4633":[217,56,217,90],"4635":[217,56,217,66],"4641":[218,21,218,24],"4649":[219,21,219,28],"4657":[219,33,219,67],"4665":[219,70,219,78],"4673":[219,70,219,100],"4681":[219,103,219,109],"4689":[219,114,219,117],"4697":[219,120,219,125],"4705":[219,128,219,136],"4713":[219,103,219,137],"4715":[219,103,219,113],"4721":[219,21,219,138],"4723":[219,21,219,32],"4729":[219,21,219,139],"4737":[220,21,220,28],"4745":[220,35,220,38],"4753":[220,21,220,39],"4755":[220,21,220,34],"4761":[220,21,220,40],"4769":[221,21,221,28],"4777":[221,21,221,28],"4785":[217,92,223,14],"4793":[217,92,223,14],"4801":[217,92,223,14],"4809":[217,92,223,14],"4817":[217,13,223,15],"4819":[217,13,217,22],"4825":[217,13,223,16],"4833":[224,13,224,19],"4841":[224,24,224,27],"4849":[224,30,224,35],"4857":[224,38,224,46],"4865":[224,48,224,50],"4873":[224,13,224,51],"4875":[224,13,224,23],"4881":[224,13,224,52],"4889":[225,20,225,23],"4897":[225,30,225,35],"4905":[225,20,225,36],"4907":[225,20,225,29],"4913":[225,20,225,41],"4921":[226,13,226,19],"4929":[226,24,226,27],"4937":[226,30,226,35],"4945":[226,38,226,46],"4953":[226,48,226,53],"4961":[226,13,226,54],"4963":[226,13,226,23],"4969":[226,13,226,55],"4977":[228,13,228,20],"4985":[228,27,228,45],"4993":[228,48,228,53],"5001":[228,13,228,54],"5003":[228,13,228,26],"5009":[228,13,228,55],"5017":[173,12,230,6],"5025":[173,12,230,6],"5033":[173,12,230,6],"5041":[173,12,230,6],"5049":[173,12,230,6],"5057":[173,12,230,6],"5065":[173,12,230,6],"5073":[173,12,230,6],"5081":[173,12,230,6],"5089":[173,5,230,7],"5097":[172,21,231,2],"5105":[172,21,231,2],"5113":[172,21,231,2],"5121":[172,21,231,2],"5129":[172,21,231,2],"5137":[172,21,231,2],"5145":[233,21,233,23],"5153":[233,21,233,23],"5161":[233,21,233,23],"5169":[234,19,234,25],"5177":[235,9,235,18],"5185":[235,19,235,22],"5193":[235,25,235,31],"5201":[235,32,235,33],"5209":[235,25,235,34],"5217":[235,37,235,45],"5225":[236,19,236,25],"5233":[237,22,237,24],"5241":[238,21,238,25],"5249":[235,49,239,10],"5257":[235,9,239,10],"5265":[235,9,239,11],"5273":[234,19,234,25],"5281":[234,5,240,6],"5289":[234,5,240,6],"5297":[241,12,241,21],"5305":[241,12,241,21],"5313":[241,5,241,22],"5321":[232,27,242,2],"5329":[232,27,242,2],"5337":[232,27,242,2],"5345":[232,27,242,2],"5353":[232,27,242,2],"5361":[232,27,242,2],"5369":[232,27,242,2],"5377":[232,27,242,2],"5385":[245,23,245,29],"5393":[246,18,246,20],"5401":[246,32,246,40],"5409":[246,32,246,62],"5417":[246,65,246,68],"5425":[246,69,246,72],"5433":[246,75,246,81],"5441":[246,82,246,83],"5449":[246,75,246,84],"5457":[246,87,246,95],"5465":[246,65,246,96],"5473":[246,18,246,97],"5475":[246,18,246,31],"5481":[247,17,247,24],"5489":[247,17,247,24],"5497":[249,18,249,20],"5505":[249,31,249,39],"5513":[249,31,249,61],"5521":[249,64,249,67],"5529":[249,68,249,71],"5537":[249,74,249,80],"5545":[249,81,249,82],"5553":[249,74,249,83],"5561":[249,86,249,94],"5569":[249,64,249,95],"5577":[249,18,249,96],"5579":[249,18,249,30],"5585":[249,18,249,105],"5587":[249,18,249,103],"5593":[250,17,250,24],"5601":[250,17,250,24],"5609":[252,13,252,15],"5617":[252,23,252,31],"5625":[252,23,252,53],"5633":[252,56,252,59],"5641":[252,60,252,63],"5649":[252,66,252,72],"5657":[252,73,252,74],"5665":[252,66,252,75],"5673":[252,78,252,86],"5681":[252,56,252,87],"5689":[253,21,253,24],"5697":[254,21,254,28],"5705":[254,33,254,51],"5713":[254,54,254,62],"5721":[254,54,254,84],"5729":[254,87,254,90],"5737":[254,91,254,94],"5745":[254,97,254,103],"5753":[254,104,254,105],"5761":[254,97,254,106],"5769":[254,109,254,117],"5777":[254,87,254,118],"5785":[254,21,254,119],"5787":[254,21,254,32],"5793":[254,21,254,120],"5801":[255,21,255,28],"5809":[255,35,255,38],"5817":[255,21,255,39],"5819":[255,21,255,34],"5825":[255,21,255,40],"5833":[252,89,257,14],"5841":[252,89,257,14],"5849":[252,89,257,14],"5857":[252,89,257,14],"5865":[252,13,257,15],"5867":[252,13,252,22],"5873":[252,13,257,16],"5881":[245,23,245,29],"5889":[245,9,258,10],"5897":[245,9,258,10],"5905":[244,12,259,6],"5913":[244,12,259,6],"5921":[244,12,259,6],"5929":[244,12,259,6],"5937":[244,12,259,6],"5945":[244,12,259,6],"5953":[244,5,259,7],"5961":[243,22,260,2],"5969":[243,22,260,2],"5977":[243,22,260,2],"5985":[243,22,260,2],"5993":[243,22,260,2],"6001":[243,22,260,2],"6009":[262,19,262,25],"6017":[263,9,263,15],"6025":[263,24,263,30],"6033":[263,31,263,32],"6041":[263,24,263,33],"6049":[263,9,263,34],"6051":[263,9,263,23],"6057":[263,39,263,52],"6065":[263,53,263,59],"6073":[263,60,263,61],"6081":[263,53,263,62],"6089":[263,39,263,63],"6097":[263,9,263,64],"6099":[263,9,263,38],"6105":[263,9,263,65],"6113":[264,9,264,15],"6121":[264,24,264,30],"6129":[264,31,264,32],"6137":[264,24,264,33],"6145":[264,9,264,34],"6147":[264,9,264,23],"6153":[264,39,264,52],"6161":[264,53,264,59],"6169":[264,60,264,61],"6177":[264,53,264,62],"6185":[264,39,264,63],"6193":[264,9,264,64],"6195":[264,9,264,38],"6201":[264,9,264,65],"6209":[262,19,262,25],"6217":[262,5,265,6],"6225":[262,5,265,6],"6233":[266,5,266,11],"6241":[266,16,266,24],"6249":[266,38,266,42],"6257":[266,26,266,44],"6265":[266,5,266,45],"6267":[266,5,266,15],"6273":[266,5,266,46],"6281":[267,5,267,11],"6289":[267,16,267,26],"6297":[267,40,267,44],"6305":[267,28,267,46],"6313":[267,5,267,47],"6315":[267,5,267,15],"6321":[267,5,267,48],"6329":[268,5,268,11],"6337":[268,16,268,35],"6345":[268,36,268,42],"6353":[268,16,268,43],"6361":[268,5,268,44],"6363":[268,5,268,15],"6369":[268,5,268,45],"6377":[269,5,269,11],"6385":[269,17,269,25],"6393":[269,27,269,41],"6401":[269,42,269,48],"6409":[269,27,269,49],"6417":[269,5,269,50],"6419":[269,5,269,16],"6425":[269,5,269,51],"6433":[261,14,270,2],"6441":[261,14,270,2],"6449":[261,14,270,2],"6457":[261,14,270,2],"6465":[261,14,270,2],"6473":[261,14,270,2],"6481":[261,14,270,2],"6489":[261,14,270,2],"6497":[272,5,272,13],"6505":[272,14,272,17],"6513":[272,21,272,26],"6521":[272,5,272,26],"6529":[272,5,272,27],"6537":[271,14,273,2],"6545":[271,14,273,2],"6553":[271,14,273,2],"6561":[271,14,273,2],"6569":[271,14,273,2],"6577":[271,14,273,2],"6585":[271,14,273,2],"6593":[275,20,275,23],"6601":[275,20,275,30],"6609":[275,20,275,36],"6617":[275,20,275,36],"6625":[275,20,275,36],"6633":[276,25,276,43],"6641":[276,44,276,47],"6649":[276,44,276,53],"6657":[276,44,276,60],"6665":[276,25,276,61],"6673":[276,25,276,61],"6681":[276,25,276,61],"6689":[279,9,279,12],"6697":[279,9,279,18],"6705":[279,9,279,25],"6713":[279,29,279,42],"6721":[280,29,280,37],"6729":[280,45,280,53],"6737":[280,66,280,69],"6745":[280,45,280,70],"6747":[280,45,280,65],"6753":[280,29,280,71],"6755":[280,29,280,44],"6761":[280,29,280,71],"6769":[280,9,280,72],"6777":[281,24,281,32],"6785":[281,40,281,41],"6793":[281,43,281,51],"6801":[281,64,281,67],"6809":[281,43,281,68],"6811":[281,43,281,63],"6817":[281,24,281,69],"6819":[281,24,281,39],"6825":[281,24,281,69],"6833":[281,9,281,70],"6841":[282,20,282,32],"6849":[282,35,282,38],"6857":[282,41,282,44],"6865":[282,41,282,50],"6873":[282,41,282,57],"6881":[282,60,282,77],"6889":[282,20,282,77],"6897":[282,9,282,78],"6905":[284,5,284,7],"6913":[284,15,284,23],"6921":[284,15,284,45],"6929":[284,48,284,56],"6937":[285,13,285,19],"6945":[286,13,286,16],"6953":[286,26,286,34],"6961":[286,26,286,55],"6969":[286,58,286,66],"6977":[286,13,286,67],"6979":[286,13,286,25],"6985":[286,13,286,68],"6993":[287,20,287,33],"7001":[287,37,287,59],"7009":[287,60,287,77],"7017":[287,37,287,78],"7025":[287,82,287,89],"7033":[287,93,287,95],"7041":[287,107,287,115],"7049":[287,107,287,137],"7057":[287,140,287,143],"7065":[287,140,287,150],"7073":[287,140,287,156],"7081":[287,93,287,157],"7083":[287,93,287,106],"7089":[287,161,287,172],"7097":[288,26,288,50],"7105":[288,51,288,68],"7113":[288,26,288,69],"7121":[288,26,288,69],"7129":[288,26,288,69],"7137":[289,33,289,44],"7145":[290,26,290,28],"7153":[290,42,290,50],"7161":[290,42,290,72],"7169":[290,75,290,78],"7177":[290,75,290,85],"7185":[290,75,290,91],"7193":[290,26,290,92],"7195":[290,26,290,41],"7201":[291,24,291,37],"7209":[291,24,291,43],"7217":[292,25,292,38],"7225":[292,25,292,45],"7233":[293,30,293,43],"7241":[293,30,293,48],"7249":[294,26,294,28],"7257":[295,25,295,31],"7265":[289,53,296,14],"7273":[289,33,296,15],"7275":[289,33,289,52],"7281":[289,33,296,15],"7289":[289,33,296,15],"7297":[297,13,297,15],"7305":[297,30,297,38],"7313":[297,30,297,60],"7321":[297,63,297,71],"7329":[297,73,297,86],"7337":[297,13,297,87],"7339":[297,13,297,29],"7345":[297,13,297,88],"7353":[298,13,298,16],"7361":[298,26,298,34],"7369":[298,26,298,55],"7377":[298,58,298,66],"7385":[298,13,298,67],"7387":[298,13,298,25],"7393":[298,13,298,68],"7401":[300,13,300,16],"7409":[300,26,300,34],"7417":[300,26,300,55],"7425":[300,58,300,61],"7433":[300,58,300,68],"7441":[300,58,300,74],"7449":[300,13,300,75],"7451":[300,13,300,25],"7457":[300,13,300,76],"7465":[284,58,302,6],"7473":[284,58,302,6],"7481":[284,58,302,6],"7489":[284,58,302,6],"7497":[284,58,302,6],"7505":[284,58,302,6],"7513":[284,5,302,7],"7515":[284,5,284,14],"7521":[284,5,302,8],"7529":[274,23,303,2],"7537":[274,23,303,2],"7545":[274,23,303,2],"7553":[274,23,303,2],"7561":[274,23,303,2],"7569":[274,23,303,2],"7577":[274,23,303,2],"7585":[274,23,303,2],"7593":[274,23,303,2],"7601":[274,23,303,2],"7609":[274,23,303,2],"7617":[304,1,304,7],"7625":[305,13,305,19],"7633":[306,13,306,19],"7641":[307,22,307,37],"7649":[304,18,308,2],"7657":[304,1,308,2],"7665":[304,1,308,3],"7673":[1,1,308,3],"7681":[1,1,308,3],"7689":[1,1,308,3],"7697":[1,1,308,3],"7705":[1,1,308,3],"7713":[1,1,308,3],"7721":[1,1,308,3],"7729":[1,1,308,3],"7737":[1,1,308,3],"7745":[1,1,308,3],"7753":[1,1,308,3],"7761":[1,1,308,3],"7769":[1,1,308,3],"7777":[1,1,308,3],"7785":[1,1,308,3],"7793":[1,1,308,3],"7801":[1,1,308,3],"7809":[1,1,308,3],"7817":[1,1,308,3],"7825":[1,1,308,3],"7833":[1,1,308,3],"7841":[1,1,308,3],"7849":[1,1,308,3],"7857":[1,1,308,3],"7865":[1,1,308,3],"7873":[74,5,78,6],"7881":[73,24,79,2],"7889":[73,24,79,2],"7897":[81,5,85,6],"7905":[80,19,86,2],"7913":[80,19,86,2],"7921":[89,5,91,6],"7929":[93,9,95,10],"7937":[87,30,98,2],"7945":[87,30,98,2],"7953":[100,5,102,6],"7961":[103,5,105,6],"7969":[106,5,108,6],"7977":[99,19,111,2],"7985":[99,19,111,2],"7993":[114,5,115,73],"8001":[114,5,115,73],"8009":[112,20,117,2],"8017":[112,20,117,2],"8025":[119,5,121,6],"8033":[123,13,123,31],"8041":[124,10,124,16],"8049":[127,10,127,16],"8057":[130,10,130,16],"8065":[118,26,141,2],"8073":[118,26,141,2],"8081":[145,13,145,16],"8089":[146,10,146,15],"8097":[149,10,149,15],"8105":[152,10,152,15],"8113":[142,32,159,2],"8121":[142,32,159,2],"8129":[165,16,169,10],"8137":[163,9,169,10],"8145":[161,12,170,6],"8153":[161,12,170,6],"8161":[160,21,171,2],"8169":[160,21,171,2],"8177":[185,29,189,30],"8185":[184,104,190,26],"8193":[184,104,190,26],"8201":[183,21,191,22],"8209":[182,96,192,18],"8217":[182,96,192,18],"8225":[194,21,199,22],"8233":[193,104,201,18],"8241":[193,104,201,18],"8249":[179,13,204,14],"8257":[208,17,213,18],"8265":[207,73,215,14],"8273":[207,73,215,14],"8281":[218,17,222,18],"8289":[217,92,223,14],"8297":[217,92,223,14],"8305":[225,16,229,10],"8313":[216,16,229,10],"8321":[205,16,229,10],"8329":[176,9,229,10],"8337":[173,12,230,6],"8345":[173,12,230,6],"8353":[172,21,231,2],"8361":[172,21,231,2],"8369":[232,27,242,2],"8377":[232,27,242,2],"8385":[246,13,248,14],"8393":[249,13,251,14],"8401":[253,17,256,18],"8409":[252,89,257,14],"8417":[252,89,257,14],"8425":[244,12,259,6],"8433":[244,12,259,6],"8441":[243,22,260,2],"8449":[243,22,260,2],"8457":[261,14,270,2],"8465":[261,14,270,2],"8473":[271,14,273,2],"8481":[271,14,273,2],"8489":[279,5,283,6],"8497":[287,16,301,10],"8505":[285,9,301,10],"8513":[284,58,302,6],"8521":[284,58,302,6],"8529":[274,23,303,2],"8537":[274,23,303,2],"8545":[1,1,308,3],"8553":[1,1,308,3],"nBranches":88,"originalCodeFileName":"/home/blake/ExpoSE/Targets/pictoose/node_modules/pictoose/pictoose.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/pictoose/node_modules/pictoose/pictoose_jalangi_.js","code":"//     ______ _      _                       \n//     | ___ (_)    | |                      \n//     | |_/ /_  ___| |_ ___   ___  ___  ___ \n//     |  __/| |/ __| __/ _ \\ / _ \\/ __|/ _ \\\n//     | |   | | (__| || (_) | (_) \\__ \\  __/\n//     \\_|   |_|\\___|\\__\\___/ \\___/|___/\\___|\n//\n//  Carlos Fernández (@sirikon) - Seis Cocos S.L.\n\n/* use strict & requirements */\n'use strict';\nvar fs \t\t\t\t= require('fs');\nvar path \t\t\t= require('path');\nvar url \t\t\t= require('url');\ntry {\n\tvar imagemagick = require('imagemagick-native');\n}catch(err){\n\tvar imagemagick = null;\n}\n\n\n/* Settings */\nvar Settings = {\n\tRESOURCE_STORAGE_ROOT: \t\"./resources/\",\n\tRESOURCE_STORAGE_URL: \t\"/public/\",\n\tRESOURCE_MAIN_URL: \t\t\"/resources/\"\n}\n\n/* Regular expression to check if a string is base64 */\nvar base64RegExp \t\t\t= new RegExp(\"^([A-Za-z0-9+/]{4})*([A-Za-z0-9+/]{4}|[A-Za-z0-9+/]{3}=|[A-Za-z0-9+/]{2}==)$\");\nvar resizeOptionsRegExp \t= new RegExp(\"^[0-9]{1,4}x[0-9]{1,4}(afit|afil|fill)*$\");\n\n/* Allowed MimeTypes list */\nvar mimes = {\n\t\"image/png\"\t\t\t\t: {extension: \"png\", \ttype: \"image\"},\n\t\"image/jpg\"\t\t\t\t: {extension: \"jpg\", \ttype: \"image\"},\n\t\"image/jpeg\"\t\t\t: {extension: \"jpeg\", \ttype: \"image\"},\n\t\"image/gif\"\t\t\t\t: {extension: \"gif\", \ttype: \"image\"},\n\t\"image/x-windows-bmp\"\t: {extension: \"bmp\", \ttype: \"image\"},\n\t\"image/bmp\"\t\t\t\t: {extension: \"bmp\", \ttype: \"image\"},\n\t\"image/webp\"\t\t\t: {extension: \"webp\", \ttype: \"image\"},\n\t\"video/mp4\"\t\t\t\t: {extension: \"mp4\", \ttype: \"video\"},\n\t\"video/avi\"\t\t\t\t: {extension: \"avi\", \ttype: \"video\"},\n\t\"video/msvideo\"\t\t\t: {extension: \"avi\", \ttype: \"video\"},\n\t\"video/x-msvideo\"\t\t: {extension: \"avi\", \ttype: \"video\"},\n\t\"video/quicktime\"\t\t: {extension: \"mov\", \ttype: \"video\"},\n\t\"video/mpeg\"\t\t\t: {extension: \"mpeg\", \ttype: \"video\"},\n}\n\n/**\n * Checks if a given mimetype is valid\n * Returns the extension or false if it's not valid \n */\nvar GetMimeExtension = function(mime){\n\t// If the mimetype exists in the object...\n\tif ( mimes.hasOwnProperty(mime) ){\n\t\treturn mimes[mime].extension;\n\t}else{\n\t\treturn false;\n\t}\n}\n\n/**\n * Checks if a given mimetype is valid.\n * Returns the type or false if it's not valid \n */\nvar GetMimeType = function(mime){\n\t// If the mimetype exists in the object...\n\tif ( mimes.hasOwnProperty(mime) ){\n\t\treturn mimes[mime].type;\n\t}else{\n\t\treturn false;\n\t}\n}\n\n/**\n * Checks if a given mimetype is valid.\n * Returns the type or false if it's not valid \n */\nvar GetMimeTypeByExtension = function(ext){\n\tvar extension = ext;\n\tif(extension.indexOf('.') >= 0){\n\t\textension = extension.substr( extension.indexOf('.')+1 );\n\t}\n\tfor (var x in mimes){\n\t\tif( mimes[x].extension == extension ){\n\t\t\treturn mimes[x].type;\n\t\t}\n\t}\n\treturn false;\n}\n\n/**\n * Checks if a given base64 string is valid.\n * Returns true/false\n */\nvar CheckBase64 = function(data){\n\n\t/*\n\t * A string is base64 when:\n\t * 1.- is not undefined/false\n\t * 2.- have a single comma\n\t * 3.- matches the regular expression\n\t */\n\tif ( !data ){\n\t\treturn false;\n\t}\n\n\tif( data.indexOf(\",\") == -1 ){\n\t\treturn false;\n\t}\n\n\tif(  data.indexOf(\",\") != data.lastIndexOf(\",\") ){\n\t\treturn false;\n\t}\n\n\tvar d = data.split(',')[1];\n\n\treturn base64RegExp.test(d);\n}\n\n/**\n * Returns a random string with the given lenght and allowed chars\n */\nvar randomString = function(length, chars) {\n    var result = '';\n    for (var i = length; i > 0; --i) result += chars[Math.round(Math.random() * (chars.length - 1))];\n    return result;\n}\n\nvar ParseResizeOptions = function(options){\n\tif( !resizeOptionsRegExp.test(options) ){\n\t\treturn false;\n\t}\n\n\tvar mode;\n\tswitch(options.substr(-4)) {\n\t\tcase 'afil':\n\t\t\tmode = 'aspectfill';\n\t\t\tbreak;\n\t\tcase 'afit':\n\t\t\tmode = 'aspectfit';\n\t\t\tbreak;\n\t\tcase 'fill':\n\t\t\tmode = 'fill';\n\t\t\tbreak;\n\t}\n\n\tvar rest = options.substr(0, options.length-4);\n\tvar rest = rest.split('x');\n\n\treturn {\n\t\twidth: parseInt(rest[0]),\n\t\theight: parseInt(rest[1]),\n\t\tmode: mode\n\t}\n}\n\nvar ParseFormatFromExtension = function(extension){\n\tvar ext = extension.toLowerCase();\n\tvar result;\n\tswitch(ext){\n\t\tcase 'png':\n\t\t\tresult = 'PNG';\n\t\t\tbreak;\n\t\tcase 'gif':\n\t\t\tresult = 'GIF';\n\t\t\tbreak;\n\t\tcase 'bmp':\n\t\t\tresult = 'BMP';\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tresult = 'JPEG';\n\t}\n\treturn result;\n}\n\n/**\n * Mongoose Getter\n */\nvar PictureGetter = function(field){\n\treturn function(){\n\t\tvar filename = this.get(\"_\"+field+\"_resid\");\n\t\tif ( url.parse(filename).host ){\n\t\t\treturn filename;\n\t\t}else if( filename && filename != \"\" ){\n\t\t\treturn Settings.RESOURCE_MAIN_URL+this.get(\"_\"+field+\"_resid\");\n\t\t}else{\n\t\t\treturn \"\";\n\t\t}\n\t}\n}\n\n/**\n * Mongoose Setter\n */\nvar PictureSetter = function(field){\n\treturn function(value){\n\t\tvar anchor = this;\n\t\tvar filename = path.basename(value)\n\n\t\tif(CheckBase64(value)){\n\t\t\t// It's base64, save it!\n\t\t\tvar mimetype = value.substr(5).split(\";\")[0];\n\t\t\tvar extension = GetMimeExtension(mimetype);\n\t\t\tif(extension){\n\t\t\t\tfilename = randomString(32,'abcdef1234567890')+\".\"+extension;\n\t\t\t\tanchor.set(\"_\"+field+\"_resid\", filename);\n\n\t\t\t\tfs.exists(Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\"), function(existsit){\n\t\t\t\t\tif(existsit && fs.lstatSync(Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\")).isFile()){\n\t\t\t\t\t\tfs.unlink(Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\"), function(err){\n\t\t\t\t\t\t\tif(err){\n\t\t\t\t\t\t\t\tconsole.log('Error removing previous image: '+Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\"));\n\t\t\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t\n\t\t\t\tfs.writeFile(Settings.RESOURCE_STORAGE_ROOT+filename, value.split(',')[1], 'base64', function(err){\n\t\t\t\t\tif(err){\n\t\t\t\t\t\tconsole.log('Error writing on disk the new file: '+Settings.RESOURCE_STORAGE_ROOT+filename);\n\t\t\t\t\t\tconsole.error(err);\n\t\t\t\t\t\tanchor.set(\"_\"+field+\"_resid\", '');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tanchor.save();\n\t\t\t\t});\n\t\t\t}else{\n\t\t\t\tconsole.log('invalid mimetype: '+mimetype);\n\t\t\t}\n\t\t}else if(fs.existsSync(value) && !fs.existsSync(Settings.RESOURCE_STORAGE_ROOT+filename)){\n\t\t\t// It's a path, move it!\n\t\t\tanchor.set(\"_\"+field+\"_resid\", filename);\n\t\t\tfs.rename(value, Settings.RESOURCE_STORAGE_ROOT+filename, function(err){\n\t\t\t\tif(err){\n\t\t\t\t\tconsole.log('Error moving the new file: '+Settings.RESOURCE_STORAGE_ROOT+filename);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\tanchor.set(\"_\"+field+\"_resid\", '');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tanchor.save();\n\t\t\t});\n\t\t}else if(value == '' || value == null || value == undefined){\n\t\t\tfs.unlink(Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\"), function(err){\n\t\t\t\tif(err){\n\t\t\t\t\tconsole.log('Error removing the actual file: '+Settings.RESOURCE_STORAGE_ROOT+anchor.get(\"_\"+field+\"_resid\"))\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t});\n\t\t\tanchor.set(\"_\"+field+\"_resid\", '');\n\t\t}else if( url.parse(value).host ){\n\t\t\tanchor.set(\"_\"+field+\"_resid\", value);\n\t\t}else{\n\t\t\t// Unknown\n\t\t\tconsole.error('Could not save: ' + value);\n\t\t}\t\t\n\t}\n}\n\n/**\n * Fields creator of the given field names\n */\nvar PictureFieldCreator = function(fields){\n\tvar newFields = {};\n\tfor (var i in fields){\n\t\tnewFields[\"_\"+fields[i]+\"_resid\"] = {type: String, default: \"\", select: true};\n\t}\n\treturn newFields;\n}\n\n/**\n * Mongoose Post Remove\n */\nvar PictureRemover = function(fields){\n\treturn function(doc){\n\t\tfor(var x in fields){\n\t\t\tif( !fs.existsSync( Settings.RESOURCE_STORAGE_ROOT+doc[\"_\"+fields[x]+\"_resid\"] ) ){ return; }\n\t\t\tif( !fs.lstatSync(Settings.RESOURCE_STORAGE_ROOT+doc[\"_\"+fields[x]+\"_resid\"]).isFile() ){ return; }\n\t\t\tfs.unlink(Settings.RESOURCE_STORAGE_ROOT+doc[\"_\"+fields[x]+\"_resid\"], function(err){\n\t\t\t\tif(err){\n\t\t\t\t\tconsole.log('Error removing: ' + Settings.RESOURCE_STORAGE_ROOT+doc[\"_\"+fields[x]+\"_resid\"]);\n\t\t\t\t\tconsole.error(err);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\n/**\n * Mongoose Plugin\n */\nvar Plugin = function(schema,fields){\n\tfor(var i in fields){\n\t\tschema.virtual(fields[i]).get(PictureGetter(fields[i]));\n\t\tschema.virtual(fields[i]).set(PictureSetter(fields[i]));\n\t}\n\tschema.set('toJSON', {virtuals: true});\n\tschema.set('toObject', {virtuals: true});\n\tschema.add(PictureFieldCreator(fields));\n\tschema.post('remove', PictureRemover(fields));\n}\n\n/**\n * Given a key/value, stores it in Settings\n */\nvar Config = function(key,value){\n\tSettings[key] = value;\n}\n\n/**\n * Express Route Controller\n * Will return an image or redirect to a image\n */\nvar RouteController = function(req,res){\n\tvar filename = req.params.resid;\n\tvar parsedOptions = ParseResizeOptions(req.query.resize);\n\tvar filenameExtension;\n\tvar filenameName;\n\tif(req.query.resize && parsedOptions){\n\t\tfilenameExtension = filename.substr(filename.lastIndexOf('.'));\n\t\tfilenameName = filename.substr(0,filename.lastIndexOf('.'));\n\t\tfilename = filenameName+\"_\"+req.query.resize+filenameExtension;\n\t}\n\tfs.exists(Settings.RESOURCE_STORAGE_ROOT+filename, function(exists){\n\t\tif(exists){\n\t\t\tres.redirect(Settings.RESOURCE_STORAGE_URL+filename);\n\t\t}else if(parsedOptions && GetMimeTypeByExtension(filenameExtension) == 'image' && fs.existsSync(Settings.RESOURCE_STORAGE_ROOT+req.params.resid) && imagemagick){\n\t\t\tvar format = ParseFormatFromExtension(filenameExtension);\n\t\t\tvar resizedBuffer = imagemagick.convert({\n\t\t\t\tsrcData: fs.readFileSync(Settings.RESOURCE_STORAGE_ROOT+req.params.resid),\n\t\t\t\twidth: parsedOptions.width,\n\t\t\t\theight: parsedOptions.height,\n\t\t\t\tresizeStyle: parsedOptions.mode,\n\t\t\t\tquality: 75,\n\t\t\t\tformat: format\n\t\t\t});\n\t\t\tfs.writeFileSync(Settings.RESOURCE_STORAGE_ROOT+filename,resizedBuffer);\n\t\t\tres.redirect(Settings.RESOURCE_STORAGE_URL+filename);\n\t\t}else{\n\t\t\tres.redirect(Settings.RESOURCE_STORAGE_URL+req.params.resid);\n\t\t}\n\t})\n}\n\n/**\n * Module exports\n */\nmodule.exports = {\n\tPlugin: Plugin,\n\tConfig: Config,\n\tRouteController: RouteController\n}"}