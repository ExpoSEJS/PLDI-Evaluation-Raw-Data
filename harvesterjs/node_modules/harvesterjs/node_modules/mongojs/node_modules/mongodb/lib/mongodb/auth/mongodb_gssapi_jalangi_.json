{"8":[16,15,16,28],"9":[1,20,1,27],"10":[17,9,17,25],"16":[17,9,17,25],"17":[1,28,1,32],"18":[19,9,19,38],"24":[19,9,19,38],"25":[1,20,1,33],"26":[25,23,25,52],"32":[25,23,25,52],"33":[1,20,1,33],"34":[27,21,27,44],"40":[26,29,26,70],"41":[1,20,1,33],"42":[27,46,27,49],"48":[30,17,30,20],"49":[2,26,2,38],"56":[36,17,36,74],"57":[2,26,2,45],"58":[27,46,27,49],"64":[39,21,39,68],"65":[2,26,2,45],"66":[29,35,29,58],"72":[42,28,42,107],"73":[2,26,2,45],"74":[34,44,34,72],"80":[42,28,42,127],"81":[3,17,3,24],"82":[36,17,36,41],"88":[42,28,42,127],"89":[3,25,3,49],"90":[36,45,36,60],"96":[39,21,39,68],"97":[3,17,3,50],"98":[36,45,36,74],"104":[36,17,36,74],"105":[3,17,3,60],"106":[39,21,39,40],"112":[27,21,27,44],"113":[3,70,3,77],"114":[39,44,39,68],"120":[55,13,55,16],"121":[3,78,3,88],"122":[42,28,42,56],"128":[58,17,58,20],"129":[3,70,3,89],"130":[42,60,42,107],"136":[72,13,72,16],"137":[3,100,3,107],"144":[77,17,77,20],"145":[3,108,3,114],"152":[90,13,90,16],"153":[3,100,3,115],"160":[94,17,94,20],"161":[3,100,3,122],"168":[107,13,107,16],"169":[3,17,3,60],"176":[110,17,110,20],"177":[3,17,3,60],"185":[3,70,3,89],"193":[3,70,3,89],"201":[3,100,3,122],"209":[3,100,3,122],"217":[4,16,4,20],"225":[4,16,4,20],"233":[4,16,4,20],"241":[5,24,5,28],"249":[5,24,5,28],"257":[5,24,5,28],"265":[7,16,7,23],"273":[7,24,7,34],"281":[7,16,7,35],"289":[7,16,7,44],"297":[7,16,7,44],"305":[7,5,7,45],"313":[8,24,8,31],"321":[8,32,8,42],"329":[8,24,8,43],"337":[8,24,8,53],"345":[8,24,8,70],"353":[8,24,8,70],"361":[8,5,8,71],"369":[9,3,10,2],"377":[12,31,12,32],"385":[12,31,12,32],"393":[12,31,12,32],"401":[13,23,13,27],"409":[13,23,13,27],"417":[13,23,13,27],"425":[14,36,14,37],"433":[14,36,14,37],"441":[14,36,14,37],"449":[15,28,15,33],"457":[15,28,15,33],"465":[15,28,15,33],"473":[16,15,16,22],"481":[16,26,16,28],"489":[16,15,16,28],"497":[16,5,16,29],"505":[17,9,17,17],"513":[17,21,17,25],"521":[18,16,18,24],"529":[18,29,18,34],"537":[18,35,18,70],"545":[18,25,18,71],"553":[18,16,18,72],"561":[18,16,18,72],"569":[18,9,18,73],"577":[19,9,19,16],"585":[19,17,19,29],"593":[19,9,19,30],"601":[19,34,19,38],"609":[20,31,20,32],"617":[20,31,20,32],"625":[20,9,20,33],"633":[22,31,22,33],"641":[22,31,22,46],"649":[22,31,22,66],"651":[22,31,22,64],"657":[22,31,22,73],"665":[22,31,22,73],"673":[22,9,22,74],"681":[23,9,23,16],"689":[23,17,23,24],"697":[23,28,23,32],"705":[23,9,23,32],"713":[23,9,23,33],"721":[25,23,25,30],"729":[25,31,25,43],"737":[25,23,25,44],"745":[25,48,25,52],"753":[25,56,25,63],"761":[25,64,25,76],"769":[25,56,25,77],"777":[25,55,25,78],"785":[25,81,25,83],"793":[25,81,25,96],"801":[25,81,25,116],"803":[25,81,25,114],"809":[25,23,25,116],"817":[25,23,25,116],"825":[26,29,26,36],"833":[26,37,26,56],"841":[26,29,26,57],"849":[26,61,26,70],"857":[26,29,26,70],"865":[26,29,26,70],"873":[27,18,27,19],"881":[27,18,27,19],"889":[27,18,27,19],"897":[27,21,27,22],"905":[27,25,27,44],"921":[27,46,27,47],"929":[27,46,27,49],"945":[28,9,28,25],"953":[28,26,28,28],"961":[28,30,28,38],"969":[28,40,28,48],"977":[28,50,28,56],"985":[28,58,28,75],"993":[28,77,28,88],"1001":[28,89,28,90],"1009":[28,77,28,91],"1017":[29,35,29,54],"1025":[29,57,29,58],"1033":[29,35,29,58],"1041":[29,13,29,59],"1049":[30,17,30,20],"1057":[31,31,31,34],"1065":[31,31,31,34],"1073":[31,17,31,35],"1081":[33,36,33,40],"1089":[33,36,33,40],"1097":[33,17,33,41],"1105":[34,44,34,68],"1113":[34,71,34,72],"1121":[34,44,34,72],"1129":[34,17,34,73],"1137":[36,17,36,36],"1145":[36,40,36,41],"1153":[36,52,36,60],"1161":[36,64,36,74],"1169":[37,40,37,48],"1177":[37,40,37,48],"1185":[37,40,37,48],"1193":[38,28,38,32],"1201":[38,28,38,32],"1209":[38,17,38,33],"1217":[39,21,39,32],"1225":[39,36,39,40],"1233":[39,44,39,63],"1241":[39,67,39,68],"1249":[40,21,40,23],"1257":[40,21,40,36],"1265":[40,21,40,41],"1273":[40,46,40,54],"1281":[40,56,40,58],"1289":[40,56,40,71],"1297":[40,73,40,81],"1305":[40,83,40,91],"1313":[40,93,40,99],"1321":[40,101,40,118],"1329":[40,21,40,119],"1331":[40,21,40,45],"1337":[40,21,40,120],"1345":[41,28,41,44],"1353":[41,45,41,49],"1361":[41,51,41,55],"1369":[41,28,41,56],"1377":[41,28,41,56],"1385":[41,21,41,57],"1393":[42,28,42,52],"1401":[42,55,42,56],"1409":[42,60,42,84],"1417":[42,88,42,107],"1425":[42,111,42,127],"1433":[43,21,43,23],"1441":[43,21,43,36],"1449":[43,21,43,41],"1457":[43,46,43,54],"1465":[43,56,43,58],"1473":[43,56,43,71],"1481":[43,73,43,81],"1489":[43,83,43,91],"1497":[43,93,43,99],"1505":[43,101,43,118],"1513":[43,21,43,119],"1515":[43,21,43,45],"1521":[43,21,43,120],"1529":[44,28,44,44],"1537":[44,45,44,49],"1545":[44,51,44,55],"1553":[44,28,44,56],"1561":[44,28,44,56],"1569":[44,21,44,57],"1577":[46,28,46,44],"1585":[46,45,46,56],"1593":[46,58,46,63],"1601":[46,28,46,64],"1609":[46,28,46,64],"1617":[46,21,46,65],"1625":[28,93,49,10],"1633":[28,93,49,10],"1641":[28,93,49,10],"1649":[28,93,49,10],"1657":[28,93,49,10],"1665":[28,93,49,10],"1673":[28,9,49,11],"1681":[28,9,49,12],"1689":[11,20,51,2],"1697":[11,20,51,2],"1705":[11,20,51,2],"1713":[11,20,51,2],"1721":[11,20,51,2],"1729":[11,20,51,2],"1737":[11,20,51,2],"1745":[11,20,51,2],"1753":[11,20,51,2],"1761":[11,20,51,2],"1769":[11,20,51,2],"1777":[11,20,51,2],"1785":[11,20,51,2],"1793":[11,20,51,2],"1801":[11,20,51,2],"1809":[11,20,51,2],"1817":[11,20,51,2],"1825":[11,20,51,2],"1833":[53,34,53,50],"1841":[53,51,53,61],"1849":[53,51,53,75],"1857":[53,51,53,80],"1865":[53,82,53,92],"1873":[53,82,53,106],"1881":[53,82,53,111],"1889":[53,113,53,130],"1897":[53,30,53,131],"1905":[53,30,53,131],"1913":[53,30,53,131],"1921":[54,5,54,23],"1929":[54,29,54,37],"1937":[54,39,54,47],"1945":[55,13,55,16],"1953":[56,20,56,28],"1961":[56,29,56,32],"1969":[56,34,56,39],"1977":[56,20,56,40],"1985":[56,20,56,40],"1993":[56,13,56,41],"2001":[57,9,57,27],"2009":[57,39,57,41],"2017":[58,17,58,20],"2025":[59,24,59,32],"2033":[59,33,59,36],"2041":[59,38,59,43],"2049":[59,24,59,44],"2057":[59,24,59,44],"2065":[59,17,59,45],"2073":[60,13,60,35],"2081":[60,36,60,54],"2089":[60,56,60,63],"2097":[60,65,60,67],"2105":[60,69,60,77],"2113":[60,79,60,87],"2121":[60,89,60,95],"2129":[60,97,60,107],"2137":[60,109,60,117],"2145":[60,13,60,118],"2153":[60,13,60,119],"2161":[57,43,61,10],"2169":[57,43,61,10],"2177":[57,43,61,10],"2185":[57,43,61,10],"2193":[57,43,61,10],"2201":[57,9,61,11],"2203":[57,9,57,38],"2209":[57,9,61,12],"2217":[54,49,62,6],"2225":[54,49,62,6],"2233":[54,49,62,6],"2241":[54,49,62,6],"2249":[54,49,62,6],"2257":[54,5,62,7],"2259":[54,5,54,28],"2265":[54,5,62,8],"2273":[52,24,63,2],"2281":[52,24,63,2],"2289":[52,24,63,2],"2297":[52,24,63,2],"2305":[52,24,63,2],"2313":[52,24,63,2],"2321":[52,24,63,2],"2329":[52,24,63,2],"2337":[52,24,63,2],"2345":[52,24,63,2],"2353":[52,24,63,2],"2361":[52,24,63,2],"2369":[52,24,63,2],"2377":[66,20,66,21],"2385":[67,20,67,28],"2393":[68,18,68,25],"2401":[69,24,69,25],"2409":[65,19,70,6],"2417":[65,19,70,6],"2425":[65,19,70,6],"2433":[71,5,71,7],"2441":[71,29,71,38],"2449":[71,55,71,57],"2457":[71,59,71,66],"2465":[71,68,71,70],"2473":[71,72,71,83],"2481":[71,29,71,84],"2483":[71,29,71,54],"2489":[71,100,71,110],"2497":[71,86,71,112],"2505":[72,13,72,16],"2513":[73,20,73,28],"2521":[73,29,73,32],"2529":[73,34,73,39],"2537":[73,20,73,40],"2545":[73,20,73,40],"2553":[73,13,73,41],"2561":[74,15,74,18],"2569":[74,15,74,28],"2577":[74,29,74,30],"2585":[74,15,74,31],"2593":[74,15,74,31],"2601":[74,9,74,32],"2609":[75,26,75,29],"2617":[75,26,75,37],"2625":[75,26,75,37],"2633":[75,26,75,37],"2641":[76,9,76,27],"2649":[76,39,76,42],"2657":[76,39,76,50],"2665":[77,17,77,20],"2673":[78,24,78,32],"2681":[78,33,78,36],"2689":[78,38,78,43],"2697":[78,24,78,44],"2705":[78,24,78,44],"2713":[78,17,78,45],"2721":[79,13,79,36],"2729":[79,37,79,55],"2737":[79,57,79,64],"2745":[79,66,79,69],"2753":[79,71,79,73],"2761":[79,75,79,83],"2769":[79,85,79,93],"2777":[79,95,79,101],"2785":[79,103,79,113],"2793":[79,115,79,123],"2801":[79,13,79,124],"2809":[79,13,79,125],"2817":[76,52,80,10],"2825":[76,52,80,10],"2833":[76,52,80,10],"2841":[76,52,80,10],"2849":[76,52,80,10],"2857":[76,9,80,11],"2859":[76,9,76,38],"2865":[76,9,80,12],"2873":[71,114,81,6],"2881":[71,114,81,6],"2889":[71,114,81,6],"2897":[71,114,81,6],"2905":[71,114,81,6],"2913":[71,114,81,6],"2921":[71,5,81,7],"2923":[71,5,71,28],"2929":[71,5,81,8],"2937":[64,30,82,2],"2945":[64,30,82,2],"2953":[64,30,82,2],"2961":[64,30,82,2],"2969":[64,30,82,2],"2977":[64,30,82,2],"2985":[64,30,82,2],"2993":[64,30,82,2],"3001":[64,30,82,2],"3009":[64,30,82,2],"3017":[64,30,82,2],"3025":[64,30,82,2],"3033":[64,30,82,2],"3041":[64,30,82,2],"3049":[85,23,85,24],"3057":[86,25,86,28],"3065":[86,25,86,43],"3073":[87,18,87,25],"3081":[84,19,88,6],"3089":[84,19,88,6],"3097":[84,19,88,6],"3105":[89,5,89,7],"3113":[89,29,89,38],"3121":[89,55,89,57],"3129":[89,59,89,66],"3137":[89,68,89,70],"3145":[89,72,89,83],"3153":[89,29,89,84],"3155":[89,29,89,54],"3161":[89,100,89,110],"3169":[89,86,89,112],"3177":[90,13,90,16],"3185":[91,20,91,28],"3193":[91,29,91,32],"3201":[91,34,91,39],"3209":[91,20,91,40],"3217":[91,20,91,40],"3225":[91,13,91,41],"3233":[92,15,92,18],"3241":[92,15,92,28],"3249":[92,29,92,30],"3257":[92,15,92,31],"3265":[92,15,92,31],"3273":[92,9,92,32],"3281":[93,9,93,27],"3289":[93,39,93,42],"3297":[93,39,93,50],"3305":[94,17,94,20],"3313":[95,24,95,32],"3321":[95,33,95,36],"3329":[95,38,95,43],"3337":[95,24,95,44],"3345":[95,24,95,44],"3353":[95,17,95,45],"3361":[96,13,96,35],"3369":[96,36,96,54],"3377":[96,56,96,63],"3385":[96,65,96,68],"3393":[96,70,96,72],"3401":[96,74,96,82],"3409":[96,84,96,92],"3417":[96,94,96,100],"3425":[96,102,96,112],"3433":[96,114,96,122],"3441":[96,13,96,123],"3449":[96,13,96,124],"3457":[93,52,97,10],"3465":[93,52,97,10],"3473":[93,52,97,10],"3481":[93,52,97,10],"3489":[93,52,97,10],"3497":[93,9,97,11],"3499":[93,9,93,38],"3505":[93,9,97,12],"3513":[89,114,98,6],"3521":[89,114,98,6],"3529":[89,114,98,6],"3537":[89,114,98,6],"3545":[89,114,98,6],"3553":[89,5,98,7],"3555":[89,5,89,28],"3561":[89,5,98,8],"3569":[83,31,99,2],"3577":[83,31,99,2],"3585":[83,31,99,2],"3593":[83,31,99,2],"3601":[83,31,99,2],"3609":[83,31,99,2],"3617":[83,31,99,2],"3625":[83,31,99,2],"3633":[83,31,99,2],"3641":[83,31,99,2],"3649":[83,31,99,2],"3657":[83,31,99,2],"3665":[83,31,99,2],"3673":[83,31,99,2],"3681":[83,31,99,2],"3689":[102,23,102,24],"3697":[103,25,103,28],"3705":[103,25,103,43],"3713":[104,18,104,25],"3721":[101,19,105,6],"3729":[101,19,105,6],"3737":[101,19,105,6],"3745":[106,5,106,7],"3753":[106,29,106,38],"3761":[106,55,106,57],"3769":[106,59,106,66],"3777":[106,68,106,70],"3785":[106,72,106,83],"3793":[106,29,106,84],"3795":[106,29,106,54],"3801":[106,100,106,110],"3809":[106,86,106,112],"3817":[107,13,107,16],"3825":[108,20,108,28],"3833":[108,29,108,32],"3841":[108,34,108,39],"3849":[108,20,108,40],"3857":[108,20,108,40],"3865":[108,13,108,41],"3873":[109,9,109,27],"3881":[109,39,109,43],"3889":[110,17,110,20],"3897":[111,24,111,32],"3905":[111,33,111,36],"3913":[111,38,111,43],"3921":[111,24,111,44],"3929":[111,24,111,44],"3937":[111,17,111,45],"3945":[112,13,112,21],"3953":[112,22,112,26],"3961":[112,28,112,32],"3969":[112,13,112,33],"3977":[112,13,112,34],"3985":[109,45,113,10],"3993":[109,45,113,10],"4001":[109,45,113,10],"4009":[109,45,113,10],"4017":[109,45,113,10],"4025":[109,9,113,11],"4027":[109,9,109,38],"4033":[109,9,113,12],"4041":[106,114,114,6],"4049":[106,114,114,6],"4057":[106,114,114,6],"4065":[106,114,114,6],"4073":[106,114,114,6],"4081":[106,5,114,7],"4083":[106,5,106,28],"4089":[106,5,114,8],"4097":[100,30,115,2],"4105":[100,30,115,2],"4113":[100,30,115,2],"4121":[100,30,115,2],"4129":[100,30,115,2],"4137":[100,30,115,2],"4145":[100,30,115,2],"4153":[100,30,115,2],"4161":[100,30,115,2],"4169":[100,30,115,2],"4177":[100,30,115,2],"4185":[100,30,115,2],"4193":[100,30,115,2],"4201":[100,30,115,2],"4209":[100,30,115,2],"4217":[116,1,116,8],"4225":[116,24,116,36],"4233":[116,1,116,36],"4241":[116,1,116,37],"4249":[1,1,116,37],"4257":[1,1,116,37],"4265":[1,1,116,37],"4273":[1,1,116,37],"4281":[1,1,116,37],"4289":[1,1,116,37],"4297":[1,1,116,37],"4305":[1,1,116,37],"4313":[1,1,116,37],"4321":[1,1,116,37],"4329":[1,1,116,37],"4337":[1,1,116,37],"4345":[1,1,116,37],"4353":[17,5,18,73],"4361":[19,5,24,6],"4369":[25,23,25,116],"4377":[30,13,35,14],"4385":[42,24,47,18],"4393":[39,17,47,18],"4401":[36,13,48,14],"4409":[28,93,49,10],"4417":[28,93,49,10],"4425":[27,5,50,6],"4433":[27,5,50,6],"4441":[11,20,51,2],"4449":[11,20,51,2],"4457":[55,9,56,41],"4465":[58,13,59,45],"4473":[57,43,61,10],"4481":[57,43,61,10],"4489":[54,49,62,6],"4497":[54,49,62,6],"4505":[52,24,63,2],"4513":[52,24,63,2],"4521":[72,9,73,41],"4529":[77,13,78,45],"4537":[76,52,80,10],"4545":[76,52,80,10],"4553":[71,114,81,6],"4561":[71,114,81,6],"4569":[64,30,82,2],"4577":[64,30,82,2],"4585":[90,9,91,41],"4593":[94,13,95,45],"4601":[93,52,97,10],"4609":[93,52,97,10],"4617":[89,114,98,6],"4625":[89,114,98,6],"4633":[83,31,99,2],"4641":[83,31,99,2],"4649":[107,9,108,41],"4657":[110,13,111,45],"4665":[109,45,113,10],"4673":[109,45,113,10],"4681":[106,114,114,6],"4689":[106,114,114,6],"4697":[100,30,115,2],"4705":[100,30,115,2],"4713":[1,1,116,37],"4721":[1,1,116,37],"nBranches":44,"originalCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongojs/node_modules/mongodb/lib/mongodb/auth/mongodb_gssapi.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongojs/node_modules/mongodb/lib/mongodb/auth/mongodb_gssapi_jalangi_.js","code":"var DbCommand = require('../commands/db_command').DbCommand\n  , utils = require('../utils')\n  , format = require('util').format;\n\n// Kerberos class\nvar Kerberos = null;\nvar MongoAuthProcess = null;\n// Try to grab the Kerberos class\ntry {\n  Kerberos = require('kerberos').Kerberos\n  // Authentication process for Mongo\n  MongoAuthProcess = require('kerberos').processes.MongoAuthProcess\n} catch(err) {}\n\nvar authenticate = function(db, username, password, authdb, options, callback) {\n  var numberOfConnections = 0;\n  var errorObject = null;  \n  var numberOfValidConnections = 0;\n  var credentialsValid = false;\n  options = options || {};\n  \n  // We don't have the Kerberos library\n  if(Kerberos == null) return callback(new Error(\"Kerberos library is not installed\"));  \n\n  if(options['connection'] != null) {\n    //if a connection was explicitly passed on options, then we have only one...\n    numberOfConnections = 1;\n  } else {\n    // Get the amount of connections in the pool to ensure we have authenticated all comments\n    numberOfConnections = db.serverConfig.allRawConnections().length;\n    options['onAll'] = true;\n  }\n\n  // Grab all the connections\n  var connections = options['connection'] != null ? [options['connection']] : db.serverConfig.allRawConnections();\n  var gssapiServiceName = options['gssapiServiceName'] || 'mongodb';\n\n  // Authenticate all connections\n  for(var i = 0; i < numberOfConnections; i++) {\n\n    // Start Auth process for a connection\n    GSSAPIInitialize(db, username, password, authdb, gssapiServiceName, connections[i], function(err, result) {\n      // Adjust number of connections left to connect\n      numberOfConnections = numberOfConnections - 1;\n\n      // Ensure we save any error\n      if(err) { \n        errorObject = err;\n      } else {\n        credentialsValid = true;\n        numberOfValidConnections = numberOfValidConnections + 1;\n      }\n\n      // Work around the case where the number of connections are 0\n      if(numberOfConnections <= 0 && typeof callback == 'function') {\n        var internalCallback = callback;\n        callback = null;\n\n        // We are done\n        if(errorObject == null && numberOfConnections == 0) {\n          // We authenticated correctly save the credentials\n          db.serverConfig.auth.add('GSSAPI', db.databaseName, username, password, authdb, gssapiServiceName);\n          // Return valid callback\n          return internalCallback(null, true);\n        } else if(numberOfValidConnections > 0 && numberOfValidConnections != numberOfConnections\n          && credentialsValid) {\n            // We authenticated correctly save the credentials\n            db.serverConfig.auth.add('GSSAPI', db.databaseName, username, password, authdb, gssapiServiceName);\n            // Return valid callback\n            return internalCallback(null, true);\n        } else {\n          return internalCallback(errorObject, false);        \n        }\n      }\n    });    \n  }\n}\n\n//\n// Initialize step\nvar GSSAPIInitialize = function(db, username, password, authdb, gssapiServiceName, connection, callback) {\n  // Create authenticator\n  var mongo_auth_process = new MongoAuthProcess(connection.socketOptions.host, connection.socketOptions.port, gssapiServiceName);\n\n  // Perform initialization\n  mongo_auth_process.init(username, password, function(err, context) {\n    if(err) return callback(err, false);\n\n    // Perform the first step\n    mongo_auth_process.transition('', function(err, payload) {\n      if(err) return callback(err, false);\n\n      // Call the next db step\n      MongoDBGSSAPIFirstStep(mongo_auth_process, payload, db, username, password, authdb, connection, callback);\n    });\n  });\n}\n\n//\n// Perform first step against mongodb\nvar MongoDBGSSAPIFirstStep = function(mongo_auth_process, payload, db, username, password, authdb, connection, callback) {\n  // Build the sasl start command\n  var command = {\n      saslStart: 1\n    , mechanism: 'GSSAPI'\n    , payload: payload\n    , autoAuthorize: 1\n  };\n\n  // Execute first sasl step\n  db._executeQueryCommand(DbCommand.createDbCommand(db, command, {}, '$external'), {connection:connection}, function(err, doc) {\n    if(err) return callback(err, false);\n    // Get the payload\n    doc = doc.documents[0];\n    var db_payload = doc.payload;\n\n    mongo_auth_process.transition(doc.payload, function(err, payload) {\n      if(err) return callback(err, false);\n\n      // MongoDB API Second Step\n      MongoDBGSSAPISecondStep(mongo_auth_process, payload, doc, db, username, password, authdb, connection, callback);\n    });\n  });\n}\n\n//\n// Perform first step against mongodb\nvar MongoDBGSSAPISecondStep = function(mongo_auth_process, payload, doc, db, username, password, authdb, connection, callback) {\n  // Build Authentication command to send to MongoDB\n  var command = {\n      saslContinue: 1\n    , conversationId: doc.conversationId\n    , payload: payload\n  };\n\n  // Execute the command\n  db._executeQueryCommand(DbCommand.createDbCommand(db, command, {}, '$external'), {connection:connection}, function(err, doc) {\n    if(err) return callback(err, false);\n\n    // Get the result document\n    doc = doc.documents[0];\n\n    // Call next transition for kerberos\n    mongo_auth_process.transition(doc.payload, function(err, payload) {\n      if(err) return callback(err, false);\n\n      // Call the last and third step\n      MongoDBGSSAPIThirdStep(mongo_auth_process, payload, doc, db, username, password, authdb, connection, callback);\n    });    \n  });\n}\n\nvar MongoDBGSSAPIThirdStep = function(mongo_auth_process, payload, doc, db, username, password, authdb, connection, callback) {\n  // Build final command\n  var command = {\n      saslContinue: 1\n    , conversationId: doc.conversationId\n    , payload: payload\n  };\n\n  // Let's finish the auth process against mongodb\n  db._executeQueryCommand(DbCommand.createDbCommand(db, command, {}, '$external'), {connection:connection}, function(err, doc) {\n    if(err) return callback(err, false);\n\n    mongo_auth_process.transition(null, function(err, payload) {\n      if(err) return callback(err, false);\n      callback(null, true);\n    });\n  });\n}\n\nexports.authenticate = authenticate;"}