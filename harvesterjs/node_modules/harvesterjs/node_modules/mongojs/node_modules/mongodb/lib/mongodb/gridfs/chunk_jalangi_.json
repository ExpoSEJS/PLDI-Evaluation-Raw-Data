{"8":[5,9,5,33],"9":[1,20,1,27],"10":[5,11,5,32],"16":[9,28,9,47],"17":[1,28,1,32],"18":[5,9,5,33],"24":[10,25,10,49],"25":[1,20,1,33],"26":[9,28,9,47],"32":[11,21,11,49],"33":[1,20,1,33],"34":[11,21,11,49],"40":[12,24,12,50],"41":[1,20,1,33],"42":[12,24,12,50],"48":[23,16,23,103],"49":[2,26,2,38],"50":[14,9,14,38],"56":[23,16,23,181],"57":[2,26,2,45],"58":[15,16,15,44],"64":[25,16,25,54],"65":[2,26,2,45],"66":[15,16,15,56],"72":[23,16,23,181],"73":[2,26,2,45],"74":[23,16,23,55],"80":[19,16,19,52],"81":[3,14,3,21],"82":[23,59,23,103],"88":[15,16,15,56],"89":[3,22,3,28],"90":[23,107,23,181],"96":[14,9,14,38],"97":[3,14,3,29],"98":[34,9,34,25],"104":[34,9,34,25],"105":[3,14,3,36],"106":[39,14,39,28],"112":[39,14,39,43],"113":[3,49,3,56],"114":[39,32,39,43],"120":[39,14,39,43],"121":[3,57,3,63],"122":[40,9,40,46],"128":[40,9,40,60],"129":[3,49,3,64],"130":[40,9,40,50],"136":[51,13,51,37],"137":[3,49,3,73],"138":[40,9,40,60],"144":[49,9,49,56],"145":[3,14,3,36],"146":[42,33,42,63],"152":[64,12,64,50],"153":[3,14,3,36],"154":[49,9,49,46],"160":[75,9,75,37],"161":[3,49,3,73],"162":[49,9,49,56],"168":[80,13,80,16],"169":[3,49,3,73],"170":[51,13,51,37],"176":[88,17,88,20],"177":[4,13,4,20],"178":[52,66,52,96],"184":[90,17,90,39],"185":[5,11,5,15],"186":[57,33,57,63],"192":[112,9,112,30],"193":[5,27,5,32],"194":[64,12,64,50],"201":[6,20,6,25],"202":[75,9,75,23],"209":[6,26,6,30],"210":[75,9,75,37],"217":[6,32,6,43],"218":[90,17,90,39],"225":[6,16,6,44],"226":[112,9,112,30],"233":[6,16,6,44],"234":[128,28,128,38],"241":[6,9,6,45],"249":[7,5,7,9],"257":[7,17,7,21],"265":[7,5,7,21],"273":[7,5,7,22],"281":[8,16,8,20],"289":[8,16,8,20],"297":[8,16,8,20],"305":[9,28,9,39],"313":[9,43,9,47],"321":[9,50,9,52],"329":[9,55,9,66],"337":[9,28,9,66],"345":[9,28,9,66],"353":[10,5,10,9],"361":[10,25,10,37],"369":[10,46,10,47],"377":[10,41,10,49],"385":[10,5,10,49],"393":[10,5,10,50],"401":[11,5,11,9],"409":[11,21,11,37],"417":[11,21,11,41],"425":[11,45,11,49],"433":[11,56,11,64],"441":[11,52,11,66],"449":[11,69,11,85],"457":[11,69,11,89],"465":[11,5,11,89],"473":[11,5,11,90],"481":[12,5,12,9],"489":[12,24,12,40],"497":[12,24,12,42],"505":[12,46,12,50],"513":[12,53,12,54],"521":[12,57,12,73],"529":[12,57,12,75],"537":[12,5,12,75],"545":[12,5,12,76],"553":[13,5,13,9],"561":[13,21,13,27],"569":[13,17,13,29],"577":[13,5,13,29],"585":[13,5,13,30],"593":[14,9,14,25],"601":[14,9,14,30],"609":[14,34,14,38],"617":[15,23,15,39],"625":[15,23,15,44],"633":[15,48,15,56],"641":[16,26,16,32],"649":[16,33,16,49],"657":[16,33,16,54],"665":[16,33,16,61],"673":[16,22,16,62],"681":[16,22,16,62],"689":[16,22,16,62],"697":[17,9,17,15],"705":[17,22,17,38],"713":[17,22,17,43],"721":[17,45,17,53],"729":[17,55,17,56],"737":[17,9,17,57],"739":[17,9,17,21],"745":[17,9,17,58],"753":[18,9,18,13],"761":[18,25,18,31],"769":[18,32,18,38],"777":[18,21,18,39],"785":[18,9,18,39],"793":[18,9,18,40],"801":[19,16,19,21],"809":[19,30,19,46],"817":[19,30,19,51],"825":[19,16,19,52],"827":[19,16,19,29],"833":[20,26,20,32],"841":[20,33,20,49],"849":[20,33,20,54],"857":[20,33,20,61],"865":[20,22,20,62],"873":[20,22,20,62],"881":[20,22,20,62],"889":[21,9,21,15],"897":[21,22,21,38],"905":[21,22,21,43],"913":[21,49,21,51],"921":[21,22,21,52],"923":[21,22,21,48],"929":[21,54,21,62],"937":[21,64,21,65],"945":[21,9,21,66],"947":[21,9,21,21],"953":[21,9,21,67],"961":[22,9,22,13],"969":[22,25,22,31],"977":[22,32,22,38],"985":[22,21,22,39],"993":[22,9,22,39],"1001":[22,9,22,40],"1009":[23,16,23,32],"1017":[23,16,23,37],"1025":[23,49,23,55],"1033":[23,59,23,75],"1041":[23,59,23,80],"1049":[23,59,23,90],"1057":[23,95,23,103],"1065":[23,107,23,113],"1073":[23,107,23,123],"1081":[23,107,23,132],"1089":[23,138,23,154],"1097":[23,138,23,159],"1105":[23,107,23,160],"1107":[23,107,23,137],"1113":[23,164,23,181],"1121":[24,9,24,13],"1129":[24,21,24,37],"1137":[24,21,24,42],"1145":[24,9,24,42],"1153":[24,9,24,43],"1161":[25,16,25,22],"1169":[25,32,25,48],"1177":[25,32,25,53],"1185":[25,16,25,54],"1187":[25,16,25,31],"1193":[27,15,27,20],"1201":[27,21,27,43],"1209":[27,15,27,44],"1217":[27,15,27,44],"1225":[27,9,27,45],"1233":[29,5,29,9],"1241":[29,29,29,30],"1249":[29,5,29,30],"1257":[29,5,29,31],"1265":[4,29,30,2],"1273":[4,29,30,2],"1281":[4,29,30,2],"1289":[4,29,30,2],"1297":[4,29,30,2],"1305":[4,29,30,2],"1313":[4,29,30,2],"1321":[4,29,30,2],"1329":[4,29,30,2],"1337":[4,13,30,2],"1345":[4,13,30,2],"1353":[4,13,30,2],"1361":[31,1,31,6],"1369":[31,1,31,16],"1377":[32,5,32,9],"1385":[32,5,32,14],"1393":[32,21,32,25],"1401":[32,27,32,31],"1409":[32,27,32,48],"1417":[32,5,32,49],"1419":[32,5,32,20],"1425":[32,5,32,50],"1433":[33,5,33,9],"1441":[33,29,33,33],"1449":[33,29,33,38],"1457":[33,29,33,47],"1459":[33,29,33,45],"1465":[33,5,33,47],"1473":[33,5,33,48],"1481":[34,9,34,17],"1489":[34,21,34,25],"1497":[35,16,35,24],"1505":[35,25,35,29],"1513":[35,31,35,35],"1521":[35,16,35,36],"1529":[35,16,35,36],"1537":[35,9,35,37],"1545":[36,12,36,16],"1553":[36,12,36,16],"1561":[36,5,36,17],"1569":[31,25,37,2],"1577":[31,25,37,2],"1585":[31,25,37,2],"1593":[31,25,37,2],"1601":[31,25,37,2],"1609":[31,1,37,2],"1617":[31,1,37,3],"1625":[38,1,38,6],"1633":[38,1,38,16],"1641":[39,14,39,20],"1649":[39,24,39,28],"1657":[39,32,39,38],"1665":[39,42,39,43],"1673":[39,46,39,50],"1681":[39,46,39,59],"1683":[39,46,39,57],"1689":[39,62,39,68],"1697":[39,14,39,68],"1705":[39,5,39,69],"1713":[40,9,40,13],"1721":[40,9,40,22],"1723":[40,9,40,20],"1729":[40,25,40,29],"1737":[40,25,40,46],"1745":[40,49,40,50],"1753":[40,54,40,60],"1761":[41,20,41,24],"1769":[41,20,41,29],"1777":[41,35,41,39],"1785":[41,35,41,56],"1793":[41,58,41,64],"1801":[41,20,41,65],"1803":[41,20,41,34],"1809":[41,20,41,65],"1817":[41,20,41,65],"1825":[42,9,42,13],"1833":[42,33,42,37],"1841":[42,33,42,54],"1849":[42,57,42,63],"1857":[42,9,42,63],"1865":[42,9,42,64],"1873":[43,16,43,20],"1881":[43,16,43,20],"1889":[43,9,43,21],"1897":[45,16,45,18],"1905":[45,16,45,18],"1913":[45,9,45,19],"1921":[38,24,47,2],"1929":[38,24,47,2],"1937":[38,24,47,2],"1945":[38,24,47,2],"1953":[38,24,47,2],"1961":[38,1,47,2],"1969":[38,1,47,3],"1977":[48,1,48,6],"1985":[48,1,48,16],"1993":[49,9,49,13],"2001":[49,9,49,22],"2003":[49,9,49,20],"2009":[49,25,49,29],"2017":[49,25,49,46],"2025":[49,50,49,56],"2033":[50,20,50,24],"2041":[50,20,50,24],"2049":[50,20,50,24],"2057":[51,13,51,17],"2065":[51,13,51,22],"2073":[51,13,51,29],"2081":[51,33,51,37],"2089":[52,20,52,24],"2097":[52,20,52,29],"2105":[52,20,52,36],"2113":[52,43,52,47],"2121":[52,43,52,64],"2129":[52,66,52,70],"2137":[52,66,52,87],"2145":[52,90,52,96],"2153":[52,20,52,97],"2155":[52,20,52,42],"2161":[52,20,52,97],"2169":[52,13,52,98],"2177":[54,24,54,30],"2185":[54,31,54,37],"2193":[54,20,54,38],"2201":[54,20,54,38],"2209":[54,13,54,39],"2217":[55,22,55,26],"2225":[55,22,55,31],"2233":[55,41,55,45],"2241":[55,47,55,51],"2249":[55,47,55,68],"2257":[55,22,55,69],"2259":[55,22,55,40],"2265":[55,22,55,69],"2273":[55,13,55,70],"2281":[57,9,57,13],"2289":[57,33,57,37],"2297":[57,33,57,54],"2305":[57,57,57,63],"2313":[57,9,57,63],"2321":[57,9,57,64],"2329":[58,16,58,20],"2337":[58,16,58,20],"2345":[58,9,58,21],"2353":[60,16,60,20],"2361":[60,16,60,20],"2369":[60,9,60,21],"2377":[48,29,62,2],"2385":[48,29,62,2],"2393":[48,29,62,2],"2401":[48,29,62,2],"2409":[48,29,62,2],"2417":[48,1,62,2],"2425":[48,1,62,3],"2433":[63,1,63,6],"2441":[63,1,63,16],"2449":[64,12,64,16],"2457":[64,12,64,33],"2465":[64,37,64,41],"2473":[64,37,64,50],"2475":[64,37,64,48],"2481":[64,53,64,57],"2489":[64,60,64,65],"2497":[64,12,64,65],"2505":[64,5,64,66],"2513":[63,23,65,2],"2521":[63,23,65,2],"2529":[63,23,65,2],"2537":[63,1,65,2],"2545":[63,1,65,3],"2553":[66,1,66,6],"2561":[66,1,66,16],"2569":[67,12,67,16],"2577":[67,22,67,23],"2585":[67,12,67,24],"2587":[67,12,67,21],"2593":[67,12,67,24],"2601":[67,5,67,25],"2609":[66,24,68,2],"2617":[66,24,68,2],"2625":[66,24,68,2],"2633":[66,1,68,2],"2641":[66,1,68,3],"2649":[69,1,69,6],"2657":[69,1,69,16],"2665":[70,5,70,9],"2673":[70,29,70,30],"2681":[70,5,70,30],"2689":[70,5,70,31],"2697":[71,5,71,9],"2705":[71,21,71,27],"2713":[71,17,71,29],"2721":[71,5,71,29],"2729":[71,5,71,30],"2737":[69,26,72,2],"2745":[69,26,72,2],"2753":[69,26,72,2],"2761":[69,1,72,2],"2769":[69,1,72,3],"2777":[73,1,73,6],"2785":[73,1,73,16],"2793":[74,16,74,20],"2801":[74,16,74,20],"2809":[74,16,74,20],"2817":[75,16,75,23],"2825":[75,27,75,37],"2833":[76,20,76,27],"2841":[76,20,76,27],"2849":[76,9,76,28],"2857":[77,19,77,21],"2865":[77,19,77,21],"2873":[77,9,77,22],"2881":[79,5,79,9],"2889":[79,5,79,14],"2897":[80,13,80,16],"2905":[81,20,81,28],"2913":[81,29,81,32],"2921":[81,20,81,33],"2929":[81,20,81,33],"2937":[81,13,81,34],"2945":[82,28,82,30],"2953":[82,28,82,30],"2961":[82,28,82,30],"2969":[83,26,83,33],"2977":[84,13,84,25],"2985":[84,26,84,30],"2993":[84,34,84,41],"3001":[84,42,84,46],"3009":[84,34,84,47],"3017":[84,13,84,47],"3025":[84,13,84,48],"3033":[83,26,83,33],"3041":[83,9,84,48],"3049":[83,9,84,48],"3057":[85,26,85,30],"3065":[85,26,85,43],"3073":[86,13,86,25],"3081":[86,26,86,30],"3089":[86,34,86,38],"3097":[86,34,86,51],"3105":[86,52,86,56],"3113":[86,34,86,57],"3121":[86,13,86,57],"3129":[86,13,86,58],"3137":[85,26,85,43],"3145":[85,9,86,58],"3153":[85,9,86,58],"3161":[87,9,87,19],"3169":[87,36,87,40],"3177":[87,36,87,49],"3185":[87,27,87,51],"3193":[87,53,87,65],"3201":[88,17,88,20],"3209":[89,24,89,32],"3217":[89,33,89,36],"3225":[89,24,89,37],"3233":[89,24,89,37],"3241":[89,17,89,38],"3249":[90,17,90,21],"3257":[90,17,90,26],"3265":[90,17,90,35],"3267":[90,17,90,33],"3273":[90,38,90,39],"3281":[91,17,91,21],"3289":[92,58,92,62],"3297":[92,35,92,64],"3305":[92,35,92,64],"3313":[92,35,92,64],"3321":[93,38,93,42],"3329":[93,38,93,55],"3337":[94,25,94,32],"3345":[94,33,94,37],"3353":[94,41,94,45],"3361":[94,41,94,58],"3369":[94,59,94,63],"3377":[94,41,94,64],"3385":[94,25,94,64],"3393":[94,25,94,65],"3401":[93,38,93,55],"3409":[93,21,95,22],"3417":[93,21,95,22],"3425":[96,21,96,31],"3433":[96,39,96,50],"3441":[96,52,96,64],"3449":[97,25,97,33],"3457":[97,34,97,37],"3465":[97,39,97,43],"3473":[97,25,97,44],"3481":[97,25,97,45],"3489":[96,66,98,22],"3497":[96,66,98,22],"3505":[96,66,98,22],"3513":[96,66,98,22],"3521":[96,66,98,22],"3529":[96,21,98,23],"3531":[96,21,96,38],"3537":[96,21,98,24],"3545":[91,39,99,18],"3553":[91,39,99,18],"3561":[91,39,99,18],"3569":[91,39,99,18],"3577":[91,39,99,18],"3585":[91,39,99,18],"3593":[91,17,99,19],"3595":[91,17,91,38],"3601":[91,17,99,20],"3609":[101,17,101,25],"3617":[101,26,101,30],"3625":[101,32,101,36],"3633":[101,17,101,37],"3641":[101,17,101,38],"3649":[87,67,103,10],"3657":[87,67,103,10],"3665":[87,67,103,10],"3673":[87,67,103,10],"3681":[87,67,103,10],"3689":[87,9,103,11],"3691":[87,9,87,26],"3697":[87,9,103,12],"3705":[79,31,104,6],"3713":[79,31,104,6],"3721":[79,31,104,6],"3729":[79,31,104,6],"3737":[79,31,104,6],"3745":[79,31,104,6],"3753":[79,31,104,6],"3761":[79,5,104,7],"3763":[79,5,79,30],"3769":[79,5,104,8],"3777":[73,24,105,2],"3785":[73,24,105,2],"3793":[73,24,105,2],"3801":[73,24,105,2],"3809":[73,24,105,2],"3817":[73,24,105,2],"3825":[73,1,105,2],"3833":[73,1,105,3],"3841":[106,1,106,6],"3849":[106,1,106,16],"3857":[108,21,108,25],"3865":[108,21,108,30],"3873":[108,21,108,37],"3881":[109,14,109,18],"3889":[109,14,109,30],"3897":[110,17,110,21],"3905":[110,17,110,26],"3913":[107,23,111,6],"3921":[107,23,111,6],"3929":[107,23,111,6],"3937":[112,9,112,13],"3945":[112,9,112,22],"3953":[112,26,112,30],"3961":[113,9,113,20],"3969":[113,27,113,31],"3977":[113,27,113,40],"3985":[113,9,113,40],"3993":[113,9,113,41],"4001":[114,5,114,13],"4009":[114,14,114,25],"4017":[114,5,114,26],"4025":[114,5,114,27],"4033":[106,36,115,2],"4041":[106,36,115,2],"4049":[106,36,115,2],"4057":[106,36,115,2],"4065":[106,36,115,2],"4073":[106,1,115,2],"4081":[106,1,115,3],"4089":[116,1,116,6],"4097":[116,1,116,16],"4105":[117,12,117,16],"4113":[117,12,117,21],"4121":[117,12,117,30],"4123":[117,12,117,28],"4129":[117,12,117,30],"4137":[117,5,117,31],"4145":[116,26,118,2],"4153":[116,26,118,2],"4161":[116,26,118,2],"4169":[116,1,118,2],"4177":[116,1,118,3],"4185":[119,1,119,7],"4193":[119,23,119,28],"4201":[119,23,119,38],"4209":[119,40,119,50],"4217":[120,17,120,21],"4225":[122,16,122,20],"4233":[122,16,122,37],"4241":[122,16,122,37],"4249":[122,9,122,38],"4257":[121,10,123,6],"4265":[121,10,123,6],"4273":[121,10,123,6],"4281":[125,9,125,13],"4289":[125,33,125,38],"4297":[125,9,125,38],"4305":[125,9,125,39],"4313":[124,10,126,6],"4321":[124,10,126,6],"4329":[124,10,126,6],"4337":[124,10,126,6],"4345":[119,52,127,2],"4353":[119,1,127,3],"4355":[119,1,119,22],"4361":[119,1,127,4],"4369":[128,1,128,6],"4377":[128,28,128,32],"4385":[128,35,128,38],"4393":[128,1,128,38],"4401":[128,1,128,39],"4409":[1,1,128,39],"4417":[1,1,128,39],"4425":[1,1,128,39],"4433":[1,1,128,39],"4441":[1,1,128,39],"4449":[1,1,128,39],"4457":[5,5,6,45],"4465":[9,28,9,66],"4473":[11,21,11,89],"4481":[12,24,12,75],"4489":[25,12,28,6],"4497":[23,12,28,6],"4505":[19,12,28,6],"4513":[15,12,28,6],"4521":[14,5,28,6],"4529":[4,29,30,2],"4537":[4,29,30,2],"4545":[34,5,35,37],"4553":[31,25,37,2],"4561":[31,25,37,2],"4569":[39,14,39,68],"4577":[40,5,46,6],"4585":[38,24,47,2],"4593":[38,24,47,2],"4601":[51,9,56,10],"4609":[49,5,61,6],"4617":[48,29,62,2],"4625":[48,29,62,2],"4633":[64,12,64,65],"4641":[63,23,65,2],"4649":[63,23,65,2],"4657":[66,24,68,2],"4665":[66,24,68,2],"4673":[69,26,72,2],"4681":[69,26,72,2],"4689":[75,5,78,6],"4697":[80,9,81,34],"4705":[88,13,89,38],"4713":[96,66,98,22],"4721":[96,66,98,22],"4729":[91,39,99,18],"4737":[91,39,99,18],"4745":[90,13,102,14],"4753":[87,67,103,10],"4761":[87,67,103,10],"4769":[79,31,104,6],"4777":[79,31,104,6],"4785":[73,24,105,2],"4793":[73,24,105,2],"4801":[112,5,113,41],"4809":[106,36,115,2],"4817":[106,36,115,2],"4825":[116,26,118,2],"4833":[116,26,118,2],"4841":[121,10,123,6],"4849":[121,10,123,6],"4857":[124,10,126,6],"4865":[124,10,126,6],"4873":[1,1,128,39],"4881":[1,1,128,39],"nBranches":48,"originalCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongojs/node_modules/mongodb/lib/mongodb/gridfs/chunk.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongojs/node_modules/mongodb/lib/mongodb/gridfs/chunk_jalangi_.js","code":"var Binary = require('bson').Binary,\n  ObjectID = require('bson').ObjectID;\n\n/**\n * Class for representing a single chunk in GridFS.\n *\n * @class\n *\n * @param file {GridStore} The {@link GridStore} object holding this chunk.\n * @param mongoObject {object} The mongo object representation of this chunk.\n *\n * @throws Error when the type of data field for {@link mongoObject} is not\n *     supported. Currently supported types for data field are instances of\n *     {@link String}, {@link Array}, {@link Binary} and {@link Binary}\n *     from the bson module\n *\n * @see Chunk#buildMongoObject\n */\nvar Chunk = exports.Chunk = function(file, mongoObject, writeConcern) {\n  if(!(this instanceof Chunk)) return new Chunk(file, mongoObject);\n\n  this.file = file;\n  var self = this;\n  var mongoObjectFinal = mongoObject == null ? {} : mongoObject;\n  this.writeConcern = writeConcern || {w:1};\n  this.objectId = mongoObjectFinal._id == null ? new ObjectID() : mongoObjectFinal._id;\n  this.chunkNumber = mongoObjectFinal.n == null ? 0 : mongoObjectFinal.n;\n  this.data = new Binary();\n\n  if(mongoObjectFinal.data == null) {\n  } else if(typeof mongoObjectFinal.data == \"string\") {\n    var buffer = new Buffer(mongoObjectFinal.data.length);\n    buffer.write(mongoObjectFinal.data, 'binary', 0);\n    this.data = new Binary(buffer);\n  } else if(Array.isArray(mongoObjectFinal.data)) {\n    var buffer = new Buffer(mongoObjectFinal.data.length);\n    buffer.write(mongoObjectFinal.data.join(''), 'binary', 0);\n    this.data = new Binary(buffer);\n  } else if(mongoObjectFinal.data instanceof Binary || mongoObjectFinal.data._bsontype === 'Binary' || Object.prototype.toString.call(mongoObjectFinal.data) == \"[object Binary]\") {\n    this.data = mongoObjectFinal.data;\n  } else if(Buffer.isBuffer(mongoObjectFinal.data)) {\n  } else {\n    throw Error(\"Illegal chunk format\");\n  }\n  \n  // Update position\n  this.internalPosition = 0;\n};\n\n/**\n * Writes a data to this object and advance the read/write head.\n *\n * @param data {string} the data to write \n * @param callback {function(*, GridStore)} This will be called after executing\n *     this method. The first parameter will contain null and the second one\n *     will contain a reference to this object.\n */\nChunk.prototype.write = function(data, callback) {\n  this.data.write(data, this.internalPosition);\n  this.internalPosition = this.data.length();\n  if(callback != null) return callback(null, this);\n  return this;\n};\n\n/**\n * Reads data and advances the read/write head.\n *\n * @param length {number} The length of data to read.\n *\n * @return {string} The data read if the given length will not exceed the end of\n *     the chunk. Returns an empty String otherwise.\n */\nChunk.prototype.read = function(length) {\n  // Default to full read if no index defined\n  length = length == null || length == 0 ? this.length() : length;\n\n  if(this.length() - this.internalPosition + 1 >= length) {\n    var data = this.data.read(this.internalPosition, length);\n    this.internalPosition = this.internalPosition + length;\n    return data;\n  } else {\n    return '';\n  }\n};\n\nChunk.prototype.readSlice = function(length) {\n  if ((this.length() - this.internalPosition) >= length) {\n    var data = null;\n    if (this.data.buffer != null) { //Pure BSON\n      data = this.data.buffer.slice(this.internalPosition, this.internalPosition + length);\n    } else { //Native BSON\n      data = new Buffer(length);\n      length = this.data.readInto(data, this.internalPosition);\n    }\n    this.internalPosition = this.internalPosition + length;\n    return data;\n  } else {\n    return null;\n  }\n};\n\n/**\n * Checks if the read/write head is at the end.\n *\n * @return {boolean} Whether the read/write head has reached the end of this\n *     chunk.\n */\nChunk.prototype.eof = function() {\n  return this.internalPosition == this.length() ? true : false;\n};\n\n/**\n * Reads one character from the data of this chunk and advances the read/write\n * head.\n *\n * @return {string} a single character data read if the the read/write head is\n *     not at the end of the chunk. Returns an empty String otherwise.\n */\nChunk.prototype.getc = function() {\n  return this.read(1);\n};\n\n/**\n * Clears the contents of the data in this chunk and resets the read/write head\n * to the initial position.\n */\nChunk.prototype.rewind = function() {\n  this.internalPosition = 0;\n  this.data = new Binary();\n};\n\n/**\n * Saves this chunk to the database. Also overwrites existing entries having the\n * same id as this chunk.\n *\n * @param callback {function(*, GridStore)} This will be called after executing\n *     this method. The first parameter will contain null and the second one\n *     will contain a reference to this object.\n */\nChunk.prototype.save = function(options, callback) {\n  var self = this;\n  if(typeof options == 'function') {\n    callback = options;\n    options = {};\n  }\n\n  self.file.chunkCollection(function(err, collection) {\n    if(err) return callback(err);\n\n    // Merge the options\n    var writeOptions = {};\n    for(var name in options) writeOptions[name] = options[name];\n    for(var name in self.writeConcern) writeOptions[name] = self.writeConcern[name];    \n\n    // collection.remove({'_id':self.objectId}, self.writeConcern, function(err, result) {\n    collection.remove({'_id':self.objectId}, writeOptions, function(err, result) {\n      if(err) return callback(err);\n\n      if(self.data.length() > 0) {\n        self.buildMongoObject(function(mongoObject) {\n          var options = {forceServerObjectId:true};\n          for(var name in self.writeConcern) {\n            options[name] = self.writeConcern[name];\n          }\n\n          collection.insert(mongoObject, writeOptions, function(err, collection) {\n            callback(err, self);\n          });\n        });\n      } else {\n        callback(null, self);\n      }\n    });\n  });\n};\n\n/**\n * Creates a mongoDB object representation of this chunk.\n *\n * @param callback {function(Object)} This will be called after executing this \n *     method. The object will be passed to the first parameter and will have\n *     the structure:\n *        \n *        <pre><code>\n *        {\n *          '_id' : , // {number} id for this chunk\n *          'files_id' : , // {number} foreign key to the file collection\n *          'n' : , // {number} chunk number\n *          'data' : , // {bson#Binary} the chunk data itself\n *        }\n *        </code></pre>\n *\n * @see <a href=\"http://www.mongodb.org/display/DOCS/GridFS+Specification#GridFSSpecification-{{chunks}}\">MongoDB GridFS Chunk Object Structure</a>\n */\nChunk.prototype.buildMongoObject = function(callback) {\n  var mongoObject = {\n    'files_id': this.file.fileId,\n    'n': this.chunkNumber,\n    'data': this.data};\n  // If we are saving using a specific ObjectId\n  if(this.objectId != null) mongoObject._id = this.objectId;\n\n  callback(mongoObject);\n};\n\n/**\n * @return {number} the length of the data\n */\nChunk.prototype.length = function() {\n  return this.data.length();\n};\n\n/**\n * The position of the read/write head\n * @name position\n * @lends Chunk#\n * @field\n */\nObject.defineProperty(Chunk.prototype, \"position\", { enumerable: true\n  , get: function () {\n      return this.internalPosition;\n    }\n  , set: function(value) {\n      this.internalPosition = value;\n    }\n});\n\n/**\n * The default chunk size\n * @constant\n */\nChunk.DEFAULT_CHUNK_SIZE = 1024 * 255;\n"}