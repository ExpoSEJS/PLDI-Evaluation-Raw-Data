{"8":[7,9,7,18],"9":[1,20,1,27],"10":[25,9,25,28],"16":[25,9,25,28],"17":[1,28,1,32],"18":[41,9,41,28],"24":[27,9,27,19],"25":[1,20,1,33],"26":[44,9,44,25],"32":[36,9,36,19],"33":[1,20,1,33],"34":[46,13,46,17],"40":[41,9,41,28],"41":[1,20,1,33],"42":[47,29,47,127],"48":[46,13,46,17],"49":[2,26,2,38],"50":[75,9,75,23],"56":[44,9,44,25],"57":[2,26,2,45],"58":[80,9,80,21],"64":[53,9,53,11],"65":[2,26,2,45],"66":[80,9,80,37],"72":[75,9,75,23],"73":[2,26,2,45],"74":[95,9,95,23],"80":[80,9,80,37],"81":[3,16,3,23],"82":[99,9,99,21],"88":[89,9,89,14],"89":[3,24,3,46],"90":[99,9,99,37],"96":[95,9,95,23],"97":[3,16,3,47],"98":[111,9,111,21],"104":[99,9,99,37],"105":[3,16,3,49],"106":[111,9,111,37],"112":[112,16,112,101],"113":[3,16,3,49],"114":[112,16,112,50],"120":[111,9,111,37],"121":[3,16,3,49],"122":[112,54,112,101],"128":[117,9,117,31],"129":[4,15,4,22],"130":[121,9,121,16],"136":[121,9,121,16],"137":[4,23,4,29],"138":[129,9,129,27],"144":[123,12,123,27],"145":[4,15,4,30],"146":[131,13,131,29],"152":[131,13,131,29],"153":[4,15,4,38],"154":[139,13,139,36],"160":[134,16,134,31],"161":[4,15,4,38],"162":[143,19,143,42],"168":[139,13,139,36],"169":[4,15,4,38],"170":[143,19,143,49],"176":[129,9,129,27],"177":[5,23,5,30],"184":[143,12,143,16],"185":[5,31,5,52],"193":[5,23,5,53],"201":[5,23,5,53],"209":[5,23,5,53],"217":[7,9,7,18],"225":[8,9,8,13],"233":[8,30,8,39],"241":[8,9,8,39],"249":[8,9,8,40],"257":[9,9,9,13],"265":[9,25,9,34],"273":[9,25,9,42],"281":[9,9,9,42],"289":[9,9,9,43],"297":[11,9,11,13],"305":[11,30,11,39],"313":[11,9,11,39],"321":[11,9,11,40],"329":[12,9,12,13],"337":[12,25,12,34],"345":[12,9,12,34],"353":[12,9,12,35],"361":[14,5,14,9],"369":[14,20,14,25],"377":[14,5,14,25],"385":[14,5,14,26],"393":[15,5,15,13],"401":[15,19,15,23],"409":[15,25,15,28],"417":[15,30,15,36],"425":[15,38,15,44],"433":[15,5,15,45],"435":[15,5,15,18],"441":[15,5,15,46],"449":[16,16,16,20],"457":[16,16,16,20],"465":[16,16,16,20],"473":[17,5,17,9],"481":[17,13,17,20],"489":[18,9,18,13],"497":[18,22,18,25],"505":[18,9,18,25],"513":[18,9,18,26],"521":[17,22,19,6],"529":[17,22,19,6],"537":[17,22,19,6],"545":[17,22,19,6],"553":[17,5,19,7],"555":[17,5,17,12],"561":[17,5,19,8],"569":[6,1,20,2],"577":[6,1,20,2],"585":[6,1,20,2],"593":[6,1,20,2],"601":[6,1,20,2],"609":[6,1,20,2],"617":[6,1,20,2],"625":[6,1,20,2],"633":[21,1,21,17],"641":[21,30,21,36],"649":[21,44,21,52],"657":[21,44,21,62],"665":[21,30,21,63],"667":[21,30,21,43],"673":[21,1,21,63],"681":[21,1,21,64],"689":[22,1,22,17],"697":[22,1,22,27],"705":[22,42,22,58],"713":[22,1,22,58],"721":[22,1,22,59],"729":[23,1,23,17],"737":[23,1,23,27],"745":[24,5,24,9],"753":[24,5,24,13],"761":[24,5,24,25],"769":[24,33,24,37],"777":[24,5,24,38],"779":[24,5,24,32],"785":[24,5,24,39],"793":[25,10,25,14],"801":[25,10,25,28],"809":[26,9,26,16],"817":[26,9,26,16],"825":[27,9,27,13],"833":[27,9,27,19],"841":[28,9,28,13],"849":[28,9,28,27],"857":[28,9,28,43],"859":[28,9,28,41],"865":[28,9,28,44],"873":[30,9,30,13],"881":[30,9,30,27],"889":[30,42,30,46],"897":[30,48,30,52],"905":[30,9,30,53],"907":[30,9,30,41],"913":[30,9,30,54],"921":[23,43,32,2],"929":[23,43,32,2],"937":[23,43,32,2],"945":[23,43,32,2],"953":[23,1,32,2],"961":[23,1,32,3],"969":[33,1,33,17],"977":[33,1,33,27],"985":[34,19,34,34],"993":[34,19,34,40],"995":[34,19,34,38],"1001":[34,19,34,40],"1009":[34,19,34,40],"1017":[35,16,35,23],"1025":[36,9,36,11],"1033":[36,15,36,17],"1041":[36,15,36,19],"1049":[36,9,36,20],"1057":[37,9,37,16],"1065":[37,9,37,18],"1073":[37,9,37,19],"1081":[35,28,38,6],"1089":[35,28,38,6],"1097":[35,28,38,6],"1105":[35,28,38,6],"1113":[35,12,38,7],"1115":[35,16,35,27],"1121":[35,12,38,7],"1129":[35,5,38,8],"1137":[33,35,39,2],"1145":[33,35,39,2],"1153":[33,35,39,2],"1161":[33,35,39,2],"1169":[33,35,39,2],"1177":[33,1,39,2],"1185":[33,1,39,3],"1193":[40,1,40,17],"1201":[40,1,40,27],"1209":[41,10,41,14],"1217":[41,10,41,28],"1225":[42,16,42,20],"1233":[42,16,42,20],"1241":[42,9,42,21],"1249":[44,10,44,14],"1257":[44,10,44,25],"1265":[45,15,45,19],"1273":[45,15,45,24],"1281":[45,15,45,28],"1289":[45,15,45,28],"1297":[45,9,45,29],"1305":[46,14,46,17],"1313":[47,23,47,28],"1321":[47,29,47,73],"1329":[47,76,47,127],"1337":[47,19,47,128],"1345":[47,19,47,128],"1353":[47,13,47,129],"1361":[49,9,49,13],"1369":[49,9,49,27],"1377":[49,40,49,43],"1385":[49,33,49,45],"1393":[49,9,49,46],"1395":[49,9,49,32],"1401":[49,9,49,47],"1409":[50,9,50,13],"1417":[50,27,50,31],"1425":[50,9,50,31],"1433":[50,9,50,32],"1441":[51,9,51,31],"1449":[51,32,51,36],"1457":[51,9,51,37],"1465":[51,9,51,38],"1473":[53,9,53,11],"1481":[54,9,54,11],"1489":[54,12,54,16],"1497":[54,9,54,17],"1505":[54,9,54,18],"1513":[55,12,55,16],"1521":[55,12,55,16],"1529":[55,5,55,17],"1537":[40,37,56,2],"1545":[40,37,56,2],"1553":[40,37,56,2],"1561":[40,37,56,2],"1569":[40,37,56,2],"1577":[40,1,56,2],"1585":[40,1,56,3],"1593":[58,17,58,20],"1601":[58,17,58,36],"1603":[58,17,58,34],"1609":[58,17,58,36],"1617":[58,17,58,36],"1625":[59,5,59,10],"1633":[59,14,59,20],"1641":[59,22,59,32],"1649":[59,5,59,33],"1651":[59,5,59,13],"1657":[59,5,59,34],"1665":[60,5,60,10],"1673":[60,14,60,22],"1681":[60,24,60,34],"1689":[60,5,60,35],"1691":[60,5,60,13],"1697":[60,5,60,36],"1705":[62,9,62,14],"1713":[62,30,62,36],"1721":[62,38,62,48],"1729":[62,9,62,49],"1731":[62,9,62,29],"1737":[62,9,62,50],"1745":[63,9,63,14],"1753":[63,30,63,38],"1761":[63,40,63,50],"1769":[63,9,63,51],"1771":[63,9,63,29],"1777":[63,9,63,52],"1785":[64,9,64,12],"1793":[64,18,64,26],"1801":[64,28,64,31],"1809":[64,9,64,32],"1811":[64,9,64,17],"1817":[64,9,64,33],"1825":[65,36,65,40],"1833":[65,36,65,40],"1841":[65,23,65,40],"1849":[65,17,65,40],"1857":[65,9,65,41],"1865":[61,5,66,6],"1873":[61,5,66,6],"1881":[57,1,67,2],"1889":[57,1,67,2],"1897":[57,1,67,2],"1905":[57,1,67,2],"1913":[61,5,66,6],"1921":[57,1,67,2],"1929":[68,1,68,17],"1937":[68,1,68,27],"1945":[69,15,69,20],"1953":[69,21,69,79],"1961":[69,11,69,80],"1969":[69,11,69,80],"1977":[69,5,69,81],"1985":[68,37,70,2],"1993":[68,37,70,2],"2001":[68,37,70,2],"2009":[68,1,70,2],"2017":[68,1,70,3],"2025":[71,1,71,17],"2033":[71,1,71,27],"2041":[72,12,72,19],"2049":[72,20,72,24],"2057":[72,20,72,35],"2059":[72,20,72,33],"2065":[72,12,72,36],"2073":[72,12,72,36],"2081":[72,5,72,37],"2089":[71,38,73,2],"2097":[71,38,73,2],"2105":[71,38,73,2],"2113":[71,1,73,2],"2121":[71,1,73,3],"2129":[74,1,74,17],"2137":[74,1,74,27],"2145":[75,10,75,14],"2153":[75,10,75,23],"2161":[76,19,76,92],"2169":[76,19,76,92],"2177":[76,19,76,92],"2185":[77,19,77,24],"2193":[77,25,77,28],"2201":[77,15,77,29],"2209":[77,15,77,29],"2217":[77,9,77,30],"2225":[79,17,79,21],"2233":[79,17,79,29],"2241":[79,17,79,29],"2249":[79,17,79,29],"2257":[80,16,80,21],"2265":[80,26,80,37],"2273":[81,26,81,30],"2281":[81,26,81,44],"2289":[81,26,81,50],"2297":[81,26,81,50],"2305":[81,26,81,50],"2313":[83,13,83,23],"2321":[84,13,84,18],"2329":[85,13,85,17],"2337":[82,24,86,10],"2345":[86,16,86,19],"2353":[82,24,86,20],"2355":[82,24,86,15],"2361":[82,24,86,20],"2369":[82,24,86,20],"2377":[87,9,87,13],"2385":[87,9,87,22],"2393":[87,34,87,42],"2401":[87,44,87,47],"2409":[87,49,87,52],"2417":[87,9,87,53],"2419":[87,9,87,33],"2425":[87,9,87,54],"2433":[89,9,89,14],"2441":[90,9,90,13],"2449":[90,9,90,17],"2457":[90,36,90,40],"2465":[90,36,90,56],"2467":[90,36,90,54],"2473":[90,36,90,60],"2481":[90,36,90,76],"2489":[90,9,90,76],"2497":[90,9,90,77],"2505":[92,12,92,16],"2513":[92,12,92,16],"2521":[92,5,92,17],"2529":[74,41,93,2],"2537":[74,41,93,2],"2545":[74,41,93,2],"2553":[74,41,93,2],"2561":[74,41,93,2],"2569":[74,41,93,2],"2577":[74,41,93,2],"2585":[74,41,93,2],"2593":[74,41,93,2],"2601":[74,41,93,2],"2609":[74,41,93,2],"2617":[74,1,93,2],"2625":[74,1,93,3],"2633":[94,1,94,17],"2641":[94,1,94,27],"2649":[95,10,95,14],"2657":[95,10,95,23],"2665":[96,9,96,16],"2673":[96,9,96,16],"2681":[98,17,98,21],"2689":[98,17,98,29],"2697":[98,17,98,29],"2705":[98,17,98,29],"2713":[99,16,99,21],"2721":[99,26,99,37],"2729":[100,26,100,30],"2737":[100,26,100,44],"2745":[100,26,100,50],"2753":[100,26,100,50],"2761":[100,26,100,50],"2769":[102,13,102,23],"2777":[103,13,103,18],"2785":[104,13,104,17],"2793":[101,24,105,10],"2801":[105,16,105,19],"2809":[101,24,105,20],"2811":[101,24,105,15],"2817":[101,24,105,20],"2825":[101,24,105,20],"2833":[106,9,106,13],"2841":[106,9,106,22],"2849":[106,34,106,42],"2857":[106,9,106,43],"2859":[106,9,106,33],"2865":[106,9,106,44],"2873":[94,41,108,2],"2881":[94,41,108,2],"2889":[94,41,108,2],"2897":[94,41,108,2],"2905":[94,41,108,2],"2913":[94,41,108,2],"2921":[94,41,108,2],"2929":[94,1,108,2],"2937":[94,1,108,3],"2945":[109,1,109,17],"2953":[109,1,109,27],"2961":[110,17,110,21],"2969":[110,17,110,29],"2977":[110,17,110,29],"2985":[110,17,110,29],"2993":[111,16,111,21],"3001":[111,26,111,37],"3009":[112,17,112,21],"3017":[112,17,112,30],"3025":[112,17,112,34],"3033":[112,17,112,50],"3041":[112,55,112,59],"3049":[112,55,112,68],"3057":[112,55,112,72],"3065":[112,55,112,88],"3073":[112,55,112,95],"3081":[112,96,112,100],"3089":[112,55,112,101],"3097":[112,16,112,101],"3105":[112,9,112,102],"3113":[114,12,114,16],"3121":[114,12,114,16],"3129":[114,5,114,17],"3137":[109,39,115,2],"3145":[109,39,115,2],"3153":[109,39,115,2],"3161":[109,39,115,2],"3169":[109,39,115,2],"3177":[109,1,115,2],"3185":[109,1,115,3],"3193":[116,1,116,17],"3201":[116,1,116,27],"3209":[117,9,117,13],"3217":[117,9,117,17],"3225":[117,9,117,31],"3233":[118,16,118,20],"3241":[118,16,118,24],"3249":[118,16,118,38],"3257":[118,16,118,38],"3265":[118,9,118,39],"3273":[120,18,120,22],"3281":[120,18,120,31],"3289":[120,18,120,31],"3297":[120,18,120,31],"3305":[121,10,121,16],"3313":[122,16,122,20],"3321":[122,16,122,20],"3329":[122,9,122,21],"3337":[123,12,123,18],"3345":[123,12,123,27],"3353":[124,18,124,24],"3361":[124,18,124,33],"3369":[124,18,124,33],"3377":[124,9,124,34],"3385":[126,12,126,16],"3393":[126,12,126,20],"3401":[126,37,126,43],"3409":[126,12,126,43],"3417":[126,12,126,43],"3425":[126,5,126,44],"3433":[116,44,127,2],"3441":[116,44,127,2],"3449":[116,44,127,2],"3457":[116,44,127,2],"3465":[116,1,127,2],"3473":[116,1,127,3],"3481":[128,1,128,17],"3489":[128,1,128,27],"3497":[129,10,129,14],"3505":[129,10,129,18],"3513":[129,10,129,27],"3521":[130,22,130,26],"3529":[130,22,130,26],"3537":[130,22,130,26],"3545":[131,14,131,20],"3553":[131,14,131,29],"3561":[132,20,132,24],"3569":[132,20,132,24],"3577":[132,13,132,25],"3585":[133,21,133,23],"3593":[133,21,133,23],"3601":[133,21,133,23],"3609":[134,16,134,22],"3617":[134,16,134,31],"3625":[135,13,135,18],"3633":[135,27,135,33],"3641":[135,27,135,47],"3649":[135,27,135,53],"3657":[135,13,135,54],"3659":[135,13,135,26],"3665":[135,13,135,55],"3673":[136,22,136,28],"3681":[136,22,136,37],"3689":[136,22,136,37],"3697":[136,13,136,38],"3705":[138,9,138,13],"3713":[138,9,138,17],"3721":[138,29,138,34],"3729":[138,40,138,43],"3737":[138,29,138,44],"3739":[138,29,138,39],"3745":[138,9,138,44],"3753":[138,9,138,45],"3761":[139,14,139,18],"3769":[139,14,139,22],"3777":[139,14,139,36],"3785":[140,13,140,17],"3793":[140,13,140,21],"3801":[140,38,140,44],"3809":[140,13,140,44],"3817":[140,13,140,45],"3825":[143,12,143,16],"3833":[143,19,143,23],"3841":[143,19,143,27],"3849":[143,19,143,36],"3857":[143,39,143,42],"3865":[143,45,143,49],"3873":[143,52,143,56],"3881":[143,52,143,60],"3889":[143,52,143,69],"3897":[143,12,143,69],"3905":[143,5,143,70],"3913":[128,42,144,2],"3921":[128,42,144,2],"3929":[128,42,144,2],"3937":[128,42,144,2],"3945":[128,42,144,2],"3953":[128,42,144,2],"3961":[128,1,144,2],"3969":[128,1,144,3],"3977":[145,1,145,17],"3985":[145,1,145,27],"3993":[146,12,146,16],"4001":[146,12,146,25],"4009":[146,12,146,25],"4017":[146,5,146,26],"4025":[145,37,147,2],"4033":[145,37,147,2],"4041":[145,37,147,2],"4049":[145,1,147,2],"4057":[145,1,147,3],"4065":[148,1,148,17],"4073":[148,1,148,27],"4081":[149,12,149,16],"4089":[149,12,149,30],"4097":[149,12,149,30],"4105":[149,5,149,31],"4113":[148,42,150,2],"4121":[148,42,150,2],"4129":[148,42,150,2],"4137":[148,1,150,2],"4145":[148,1,150,3],"4153":[151,1,151,7],"4161":[151,18,151,34],"4169":[151,1,151,34],"4177":[151,1,151,35],"4185":[1,1,151,35],"4193":[1,1,151,35],"4201":[1,1,151,35],"4209":[1,1,151,35],"4217":[1,1,151,35],"4225":[1,1,151,35],"4233":[6,1,20,2],"4241":[1,1,151,35],"4249":[57,1,67,2],"4257":[1,1,151,35],"4265":[7,5,13,6],"4273":[17,22,19,6],"4281":[17,22,19,6],"4289":[6,1,20,2],"4297":[6,1,20,2],"4305":[25,5,26,16],"4313":[27,5,31,6],"4321":[23,43,32,2],"4329":[23,43,32,2],"4337":[35,28,38,6],"4345":[35,28,38,6],"4353":[33,35,39,2],"4361":[33,35,39,2],"4369":[41,5,42,21],"4377":[46,9,48,10],"4385":[44,5,52,6],"4393":[53,5,54,18],"4401":[40,37,56,2],"4409":[40,37,56,2],"4417":[61,5,66,6],"4425":[61,5,66,6],"4433":[57,1,67,2],"4441":[57,1,67,2],"4449":[68,37,70,2],"4457":[68,37,70,2],"4465":[71,38,73,2],"4473":[71,38,73,2],"4481":[75,5,78,6],"4489":[80,5,88,6],"4497":[89,5,91,6],"4505":[74,41,93,2],"4513":[74,41,93,2],"4521":[95,5,97,6],"4529":[99,5,107,6],"4537":[94,41,108,2],"4545":[94,41,108,2],"4553":[111,5,113,6],"4561":[109,39,115,2],"4569":[109,39,115,2],"4577":[117,5,119,6],"4585":[121,5,122,21],"4593":[123,5,125,6],"4601":[116,44,127,2],"4609":[116,44,127,2],"4617":[131,9,132,25],"4625":[134,9,137,10],"4633":[139,9,141,10],"4641":[129,5,142,6],"4649":[143,12,143,69],"4657":[128,42,144,2],"4665":[128,42,144,2],"4673":[145,37,147,2],"4681":[145,37,147,2],"4689":[148,42,150,2],"4697":[148,42,150,2],"4705":[1,1,151,35],"4713":[1,1,151,35],"nBranches":46,"originalCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongoose/lib/types/embedded.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongoose/lib/types/embedded_jalangi_.js","code":"/* eslint no-func-assign: 1 */\n\n/*!\n * Module dependencies.\n */\n\nvar Document = require('../document_provider')();\nvar inspect = require('util').inspect;\nvar PromiseProvider = require('../promise_provider');\n\n/**\n * EmbeddedDocument constructor.\n *\n * @param {Object} obj js object returned from the db\n * @param {MongooseDocumentArray} parentArr the parent array of this document\n * @param {Boolean} skipId\n * @inherits Document\n * @api private\n */\n\nfunction EmbeddedDocument(obj, parentArr, skipId, fields, index) {\n  if (parentArr) {\n    this.__parentArray = parentArr;\n    this.__parent = parentArr._parent;\n  } else {\n    this.__parentArray = undefined;\n    this.__parent = undefined;\n  }\n  this.__index = index;\n\n  Document.call(this, obj, fields, skipId);\n\n  var self = this;\n  this.on('isNew', function(val) {\n    self.isNew = val;\n  });\n}\n\n/*!\n * Inherit from Document\n */\nEmbeddedDocument.prototype = Object.create( Document.prototype );\nEmbeddedDocument.prototype.constructor = EmbeddedDocument;\n\n/**\n * Marks the embedded doc modified.\n *\n * ####Example:\n *\n *     var doc = blogpost.comments.id(hexstring);\n *     doc.mixed.type = 'changed';\n *     doc.markModified('mixed.type');\n *\n * @param {String} path the path which changed\n * @api public\n * @receiver EmbeddedDocument\n */\n\nEmbeddedDocument.prototype.markModified = function(path) {\n  this.$__.activePaths.modify(path);\n  if (!this.__parentArray) return;\n\n  if (this.isNew) {\n    // Mark the WHOLE parent array as modified\n    // if this is a new document (i.e., we are initializing\n    // a document),\n    this.__parentArray._markModified();\n  } else {\n    this.__parentArray._markModified(this, path);\n  }\n};\n\n/**\n * Used as a stub for [hooks.js](https://github.com/bnoguchi/hooks-js/tree/31ec571cef0332e21121ee7157e0cf9728572cc3)\n *\n * ####NOTE:\n *\n * _This is a no-op. Does not actually save the doc to the db._\n *\n * @param {Function} [fn]\n * @return {Promise} resolved Promise\n * @api private\n */\n\nEmbeddedDocument.prototype.save = function(fn) {\n  var Promise = PromiseProvider.get();\n  return new Promise.ES6(function(resolve) {\n    fn && fn();\n    resolve();\n  });\n};\n\n/**\n * Removes the subdocument from its parent array.\n *\n * @param {Function} [fn]\n * @api public\n */\n\nEmbeddedDocument.prototype.remove = function(fn) {\n  if (!this.__parentArray) return this;\n\n  var _id;\n  if (!this.willRemove) {\n    _id = this._doc._id;\n    if (!_id) {\n      throw new Error('For your own good, Mongoose does not know ' +\n                      'how to remove an EmbeddedDocument that has no _id');\n    }\n    this.__parentArray.pull({ _id: _id });\n    this.willRemove = true;\n    registerRemoveListener(this);\n  }\n\n  if (fn)\n    fn(null);\n\n  return this;\n};\n\n/*!\n * Registers remove event listeners for triggering\n * on subdocuments.\n *\n * @param {EmbeddedDocument} sub\n * @api private\n */\n\nfunction registerRemoveListener(sub) {\n  var owner = sub.ownerDocument();\n\n  owner.on('save', emitRemove);\n  owner.on('remove', emitRemove);\n\n  function emitRemove() {\n    owner.removeListener('save', emitRemove);\n    owner.removeListener('remove', emitRemove);\n    sub.emit('remove', sub);\n    owner = sub = emitRemove = null;\n  }\n}\n\n/**\n * Override #update method of parent documents.\n * @api private\n */\n\nEmbeddedDocument.prototype.update = function() {\n  throw new Error('The #update method is not available on EmbeddedDocuments');\n};\n\n/**\n * Helper for console.log\n *\n * @api public\n */\n\nEmbeddedDocument.prototype.inspect = function() {\n  return inspect(this.toObject());\n};\n\n/**\n * Marks a path as invalid, causing validation to fail.\n *\n * @param {String} path the field to invalidate\n * @param {String|Error} err error which states the reason `path` was invalid\n * @return {Boolean}\n * @api public\n */\n\nEmbeddedDocument.prototype.invalidate = function(path, err, val, first) {\n  if (!this.__parent) {\n    var msg = 'Unable to invalidate a subdocument that has not been added to an array.';\n    throw new Error(msg);\n  }\n\n  var index = this.__index;\n  if (typeof index !== 'undefined') {\n    var parentPath = this.__parentArray._path;\n    var fullPath = [parentPath, index, path].join('.');\n    this.__parent.invalidate(fullPath, err, val);\n  }\n\n  if (first) {\n    this.$__.validationError = this.ownerDocument().$__.validationError;\n  }\n\n  return true;\n};\n\n/**\n * Marks a path as valid, removing existing validation errors.\n *\n * @param {String} path the field to mark as valid\n * @api private\n * @method $markValid\n * @receiver EmbeddedDocument\n */\n\nEmbeddedDocument.prototype.$markValid = function(path) {\n  if (!this.__parent) {\n    return;\n  }\n\n  var index = this.__index;\n  if (typeof index !== 'undefined') {\n    var parentPath = this.__parentArray._path;\n    var fullPath = [parentPath, index, path].join('.');\n    this.__parent.$markValid(fullPath);\n  }\n};\n\n/**\n * Checks if a path is invalid\n *\n * @param {String} path the field to check\n * @api private\n * @method $isValid\n * @receiver EmbeddedDocument\n */\n\nEmbeddedDocument.prototype.$isValid = function(path) {\n  var index = this.__index;\n  if (typeof index !== 'undefined') {\n\n    return !this.__parent.$__.validationError ||\n      !this.__parent.$__.validationError.errors[path];\n  }\n\n  return true;\n};\n\n/**\n * Returns the top level document of this sub-document.\n *\n * @return {Document}\n */\n\nEmbeddedDocument.prototype.ownerDocument = function() {\n  if (this.$__.ownerDocument) {\n    return this.$__.ownerDocument;\n  }\n\n  var parent = this.__parent;\n  if (!parent) return this;\n\n  while (parent.__parent) {\n    parent = parent.__parent;\n  }\n\n  return this.$__.ownerDocument = parent;\n};\n\n/**\n * Returns the full path to this document. If optional `path` is passed, it is appended to the full path.\n *\n * @param {String} [path]\n * @return {String}\n * @api private\n * @method $__fullPath\n * @memberOf EmbeddedDocument\n */\n\nEmbeddedDocument.prototype.$__fullPath = function(path) {\n  if (!this.$__.fullPath) {\n    var parent = this;\n    if (!parent.__parent) return path;\n\n    var paths = [];\n    while (parent.__parent) {\n      paths.unshift(parent.__parentArray._path);\n      parent = parent.__parent;\n    }\n\n    this.$__.fullPath = paths.join('.');\n\n    if (!this.$__.ownerDocument) {\n      // optimization\n      this.$__.ownerDocument = parent;\n    }\n  }\n\n  return path\n    ? this.$__.fullPath + '.' + path\n    : this.$__.fullPath;\n};\n\n/**\n * Returns this sub-documents parent document.\n *\n * @api public\n */\n\nEmbeddedDocument.prototype.parent = function() {\n  return this.__parent;\n};\n\n/**\n * Returns this sub-documents parent array.\n *\n * @api public\n */\n\nEmbeddedDocument.prototype.parentArray = function() {\n  return this.__parentArray;\n};\n\n/*!\n * Module exports.\n */\n\nmodule.exports = EmbeddedDocument;\n"}