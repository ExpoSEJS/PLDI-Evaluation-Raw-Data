{"8":[12,12,12,70],"9":[1,20,1,27],"10":[12,12,12,33],"16":[12,12,12,107],"17":[1,28,1,32],"18":[12,37,12,70],"24":[26,9,26,25],"25":[1,20,1,33],"26":[12,74,12,107],"32":[28,29,28,70],"33":[1,20,1,33],"34":[26,9,26,25],"40":[31,9,31,19],"41":[1,20,1,33],"42":[31,9,31,19],"48":[42,28,42,53],"49":[2,26,2,38],"50":[36,12,36,34],"56":[42,28,42,73],"57":[2,26,2,45],"58":[39,25,39,34],"64":[44,28,44,53],"65":[2,26,2,45],"66":[42,33,42,41],"72":[44,28,44,75],"73":[2,26,2,45],"74":[42,33,42,53],"80":[44,28,44,75],"81":[3,1,3,13],"82":[44,33,44,41],"88":[42,28,42,73],"89":[3,1,3,14],"90":[44,33,44,53],"96":[40,21,40,24],"97":[4,9,4,16],"98":[48,48,48,76],"104":[50,21,50,63],"105":[4,17,4,23],"106":[50,21,50,31],"112":[54,25,54,44],"113":[4,9,4,24],"114":[50,35,50,63],"120":[53,28,53,38],"121":[4,9,4,31],"122":[53,28,53,38],"128":[50,21,50,63],"129":[4,42,4,49],"130":[54,25,54,44],"136":[36,12,36,34],"137":[4,50,4,58],"138":[126,21,126,41],"144":[72,13,72,16],"145":[4,42,4,59],"146":[126,43,126,46],"152":[76,17,76,20],"153":[4,74,4,81],"160":[79,21,79,24],"161":[4,82,4,92],"162":[126,43,126,46],"168":[87,25,87,28],"169":[4,74,4,93],"170":[132,9,132,15],"176":[91,29,91,32],"177":[4,9,4,31],"178":[137,9,137,19],"184":[99,33,99,36],"185":[4,9,4,31],"186":[139,21,139,46],"192":[109,41,109,44],"193":[4,42,4,59],"194":[139,48,139,51],"200":[112,41,112,49],"201":[4,42,4,59],"208":[127,13,127,40],"209":[4,74,4,93],"210":[139,48,139,51],"216":[126,21,126,41],"217":[4,74,4,93],"218":[141,21,141,30],"224":[132,9,132,15],"225":[6,5,6,9],"226":[142,17,142,27],"232":[137,9,137,19],"233":[6,15,6,17],"240":[142,17,142,27],"241":[6,5,6,17],"248":[139,21,139,46],"249":[6,5,6,18],"257":[7,5,7,9],"265":[7,21,7,29],"273":[7,5,7,29],"281":[7,5,7,30],"289":[8,5,8,9],"297":[8,21,8,29],"305":[8,5,8,29],"313":[8,5,8,30],"321":[9,5,9,9],"329":[9,20,9,27],"337":[9,5,9,27],"345":[9,5,9,28],"353":[5,19,10,2],"361":[5,19,10,2],"369":[5,19,10,2],"377":[5,19,10,2],"385":[5,19,10,2],"393":[5,19,10,2],"401":[5,19,10,2],"409":[5,19,10,2],"417":[5,19,10,2],"425":[11,1,11,12],"433":[11,1,11,22],"441":[12,12,12,19],"449":[12,12,12,22],"457":[12,26,12,30],"465":[12,26,12,33],"473":[12,37,12,44],"481":[12,37,12,53],"489":[12,57,12,61],"497":[12,57,12,70],"505":[12,74,12,81],"513":[12,74,12,90],"521":[12,94,12,98],"529":[12,94,12,107],"537":[12,12,12,107],"545":[12,5,12,108],"553":[11,31,13,2],"561":[11,31,13,2],"569":[11,31,13,2],"577":[11,31,13,2],"585":[11,1,13,2],"593":[11,1,13,3],"601":[14,16,14,20],"609":[14,16,14,20],"617":[14,16,14,20],"625":[15,24,15,28],"633":[15,24,15,28],"641":[15,24,15,28],"649":[17,16,17,23],"657":[17,24,17,34],"665":[17,16,17,35],"673":[17,16,17,44],"681":[17,16,17,44],"689":[17,5,17,45],"697":[18,24,18,31],"705":[18,32,18,42],"713":[18,24,18,43],"721":[18,24,18,53],"729":[18,24,18,70],"737":[18,24,18,70],"745":[18,5,18,71],"753":[19,3,20,2],"761":[22,5,22,9],"769":[22,22,22,24],"777":[22,5,22,24],"785":[22,5,22,25],"793":[21,12,23,2],"801":[21,12,23,2],"809":[21,12,23,2],"817":[21,12,23,2],"825":[21,12,23,2],"833":[24,1,24,5],"841":[24,1,24,15],"849":[25,16,25,20],"857":[25,16,25,20],"865":[25,16,25,20],"873":[26,9,26,17],"881":[26,21,26,25],"889":[27,16,27,24],"897":[27,29,27,34],"905":[27,35,27,70],"913":[27,25,27,71],"921":[27,16,27,72],"929":[27,16,27,72],"937":[27,9,27,73],"945":[28,29,28,36],"953":[28,37,28,56],"961":[28,29,28,57],"969":[28,61,28,70],"977":[28,29,28,70],"985":[28,29,28,70],"993":[29,23,29,27],"1001":[29,23,29,36],"1003":[29,23,29,34],"1009":[29,23,29,36],"1017":[29,23,29,36],"1025":[30,17,30,28],"1033":[30,17,30,35],"1041":[30,17,30,35],"1049":[30,17,30,35],"1057":[31,9,31,14],"1065":[31,18,31,19],"1073":[32,16,32,24],"1081":[32,25,32,29],"1089":[32,31,32,35],"1097":[32,16,32,36],"1105":[32,16,32,36],"1113":[32,9,32,37],"1121":[33,36,33,37],"1129":[33,36,33,37],"1137":[33,36,33,37],"1145":[34,28,34,33],"1153":[34,28,34,33],"1161":[34,28,34,33],"1169":[35,23,35,27],"1177":[35,23,35,27],"1185":[35,23,35,27],"1193":[36,12,36,23],"1201":[36,12,36,30],"1209":[36,33,36,34],"1217":[38,13,38,29],"1225":[38,30,38,38],"1233":[38,40,38,48],"1241":[38,50,38,67],"1249":[38,69,38,75],"1257":[38,77,38,87],"1265":[39,25,39,30],"1273":[39,33,39,34],"1281":[39,25,39,34],"1289":[39,17,39,35],"1297":[40,21,40,24],"1305":[41,35,41,38],"1313":[41,35,41,38],"1321":[41,21,41,39],"1329":[42,28,42,29],"1337":[42,40,42,41],"1345":[42,45,42,53],"1353":[42,57,42,58],"1361":[42,57,42,65],"1369":[42,66,42,72],"1377":[42,57,42,73],"1385":[43,35,43,36],"1393":[43,35,43,43],"1401":[43,35,43,43],"1409":[43,21,43,44],"1417":[44,28,44,29],"1425":[44,40,44,41],"1433":[44,45,44,53],"1441":[44,57,44,58],"1449":[44,57,44,65],"1457":[44,66,44,74],"1465":[44,57,44,75],"1473":[45,35,45,36],"1481":[45,35,45,43],"1489":[45,35,45,43],"1497":[45,21,45,44],"1505":[47,40,47,44],"1513":[47,40,47,44],"1521":[47,21,47,45],"1529":[48,48,48,72],"1537":[48,75,48,76],"1545":[48,48,48,76],"1553":[48,21,48,77],"1561":[50,21,50,26],"1569":[50,30,50,31],"1577":[50,35,50,59],"1585":[50,62,50,63],"1593":[51,21,51,35],"1601":[51,36,51,40],"1609":[51,36,51,50],"1617":[51,56,51,67],"1625":[51,68,51,70],"1633":[51,72,51,80],"1641":[51,82,51,90],"1649":[51,92,51,99],"1657":[51,52,51,100],"1665":[51,21,51,101],"1673":[51,21,51,102],"1681":[52,21,52,29],"1689":[52,30,52,34],"1697":[52,36,52,40],"1705":[52,21,52,41],"1713":[52,21,52,42],"1721":[53,28,53,33],"1729":[53,37,53,38],"1737":[54,25,54,36],"1745":[54,40,54,44],"1753":[55,43,55,53],"1761":[55,54,55,55],"1769":[55,56,55,94],"1777":[55,54,55,95],"1785":[55,39,55,96],"1793":[55,39,55,96],"1801":[55,25,55,97],"1809":[56,21,56,29],"1817":[56,30,56,41],"1825":[56,43,56,48],"1833":[56,21,56,49],"1841":[56,21,56,50],"1849":[38,89,58,14],"1857":[38,89,58,14],"1865":[38,89,58,14],"1873":[38,89,58,14],"1881":[38,89,58,14],"1889":[38,13,58,15],"1897":[38,13,58,16],"1905":[37,23,59,10],"1913":[37,23,59,10],"1921":[37,23,59,10],"1929":[37,23,59,10],"1937":[37,23,59,10],"1945":[37,23,59,10],"1953":[60,9,60,16],"1961":[60,17,60,28],"1969":[60,17,60,36],"1971":[60,17,60,34],"1977":[60,9,60,37],"1985":[60,9,60,38],"1993":[24,23,62,2],"2001":[24,23,62,2],"2009":[24,23,62,2],"2017":[24,23,62,2],"2025":[24,23,62,2],"2033":[24,23,62,2],"2041":[24,23,62,2],"2049":[24,23,62,2],"2057":[24,23,62,2],"2065":[24,23,62,2],"2073":[24,23,62,2],"2081":[24,23,62,2],"2089":[24,23,62,2],"2097":[24,23,62,2],"2105":[24,23,62,2],"2113":[24,23,62,2],"2121":[24,23,62,2],"2129":[24,23,62,2],"2137":[24,1,62,2],"2145":[24,1,62,3],"2153":[65,20,65,21],"2161":[66,20,66,28],"2169":[67,18,67,20],"2177":[68,24,68,25],"2185":[64,19,69,6],"2193":[64,19,69,6],"2201":[64,19,69,6],"2209":[70,34,70,50],"2217":[70,51,70,61],"2225":[70,51,70,66],"2233":[70,68,70,78],"2241":[70,68,70,83],"2249":[70,85,70,102],"2257":[70,30,70,103],"2265":[70,30,70,103],"2273":[70,30,70,103],"2281":[71,5,71,11],"2289":[71,20,71,36],"2297":[71,38,71,45],"2305":[71,61,71,71],"2313":[71,47,71,73],"2321":[72,13,72,16],"2329":[73,20,73,28],"2337":[73,29,73,32],"2345":[73,34,73,39],"2353":[73,20,73,40],"2361":[73,20,73,40],"2369":[73,13,73,41],"2377":[74,19,74,20],"2385":[74,19,74,27],"2393":[74,19,74,27],"2401":[74,19,74,27],"2409":[75,9,75,27],"2417":[75,33,75,41],"2425":[75,43,75,51],"2433":[76,17,76,20],"2441":[77,24,77,32],"2449":[77,33,77,36],"2457":[77,24,77,37],"2465":[77,24,77,37],"2473":[77,17,77,38],"2481":[78,13,78,31],"2489":[78,43,78,46],"2497":[78,43,78,54],"2505":[79,21,79,24],"2513":[80,28,80,36],"2521":[80,37,80,40],"2529":[80,28,80,41],"2537":[80,28,80,41],"2545":[80,21,80,42],"2553":[82,35,82,36],"2561":[83,37,83,40],"2569":[83,37,83,55],"2577":[84,30,84,37],"2585":[81,31,85,18],"2593":[81,31,85,18],"2601":[81,31,85,18],"2609":[86,17,86,23],"2617":[86,32,86,48],"2625":[86,50,86,57],"2633":[86,73,86,83],"2641":[86,59,86,85],"2649":[87,25,87,28],"2657":[88,32,88,40],"2665":[88,41,88,44],"2673":[88,46,88,51],"2681":[88,32,88,52],"2689":[88,32,88,52],"2697":[88,25,88,53],"2705":[89,31,89,32],"2713":[89,31,89,39],"2721":[89,31,89,39],"2729":[89,31,89,39],"2737":[90,21,90,39],"2745":[90,51,90,54],"2753":[90,51,90,62],"2761":[91,29,91,32],"2769":[92,36,92,44],"2777":[92,45,92,48],"2785":[92,36,92,49],"2793":[92,36,92,49],"2801":[92,29,92,50],"2809":[94,43,94,44],"2817":[95,45,95,48],"2825":[95,45,95,63],"2833":[96,38,96,45],"2841":[93,39,97,26],"2849":[93,39,97,26],"2857":[93,39,97,26],"2865":[98,25,98,31],"2873":[98,40,98,56],"2881":[98,58,98,65],"2889":[98,81,98,91],"2897":[98,67,98,93],"2905":[99,33,99,36],"2913":[100,40,100,48],"2921":[100,49,100,52],"2929":[100,54,100,59],"2937":[100,40,100,60],"2945":[100,40,100,60],"2953":[100,33,100,61],"2961":[101,39,101,40],"2969":[101,39,101,47],"2977":[101,39,101,47],"2985":[101,39,101,47],"2993":[102,29,102,47],"3001":[102,59,102,62],"3009":[102,59,102,70],"3017":[104,51,104,52],"3025":[105,53,105,56],"3033":[105,53,105,71],"3041":[106,46,106,53],"3049":[103,47,107,34],"3057":[103,47,107,34],"3065":[103,47,107,34],"3073":[108,33,108,39],"3081":[108,48,108,64],"3089":[108,66,108,73],"3097":[108,89,108,99],"3105":[108,75,108,101],"3113":[109,41,109,44],"3121":[110,48,110,56],"3129":[110,57,110,60],"3137":[110,62,110,67],"3145":[110,48,110,68],"3153":[110,48,110,68],"3161":[110,41,110,69],"3169":[111,47,111,48],"3177":[111,47,111,55],"3185":[111,47,111,55],"3193":[111,47,111,55],"3201":[112,41,112,44],"3209":[112,41,112,49],"3217":[113,48,113,56],"3225":[113,57,113,61],"3233":[113,63,113,67],"3241":[113,48,113,68],"3249":[113,48,113,68],"3257":[113,41,113,69],"3265":[114,37,114,45],"3273":[114,50,114,55],"3281":[114,56,114,79],"3289":[114,46,114,80],"3297":[114,82,114,87],"3305":[114,37,114,88],"3313":[114,37,114,89],"3321":[108,103,115,34],"3329":[108,103,115,34],"3337":[108,103,115,34],"3345":[108,103,115,34],"3353":[108,103,115,34],"3361":[108,103,115,34],"3369":[108,33,115,35],"3371":[108,33,108,47],"3377":[108,33,115,36],"3385":[102,72,116,30],"3393":[102,72,116,30],"3401":[102,72,116,30],"3409":[102,72,116,30],"3417":[102,72,116,30],"3425":[102,72,116,30],"3433":[102,29,116,31],"3435":[102,29,102,58],"3441":[102,29,116,32],"3449":[98,95,117,26],"3457":[98,95,117,26],"3465":[98,95,117,26],"3473":[98,95,117,26],"3481":[98,95,117,26],"3489":[98,95,117,26],"3497":[98,25,117,27],"3499":[98,25,98,39],"3505":[98,25,117,28],"3513":[90,64,118,22],"3521":[90,64,118,22],"3529":[90,64,118,22],"3537":[90,64,118,22],"3545":[90,64,118,22],"3553":[90,64,118,22],"3561":[90,21,118,23],"3563":[90,21,90,50],"3569":[90,21,118,24],"3577":[86,87,119,18],"3585":[86,87,119,18],"3593":[86,87,119,18],"3601":[86,87,119,18],"3609":[86,87,119,18],"3617":[86,87,119,18],"3625":[86,17,119,19],"3627":[86,17,86,31],"3633":[86,17,119,20],"3641":[78,56,120,14],"3649":[78,56,120,14],"3657":[78,56,120,14],"3665":[78,56,120,14],"3673":[78,56,120,14],"3681":[78,56,120,14],"3689":[78,13,120,15],"3691":[78,13,78,42],"3697":[78,13,120,16],"3705":[75,53,121,10],"3713":[75,53,121,10],"3721":[75,53,121,10],"3729":[75,53,121,10],"3737":[75,9,121,11],"3739":[75,9,75,32],"3745":[75,9,121,12],"3753":[71,75,122,6],"3761":[71,75,122,6],"3769":[71,75,122,6],"3777":[71,75,122,6],"3785":[71,75,122,6],"3793":[71,75,122,6],"3801":[71,5,122,7],"3803":[71,5,71,19],"3809":[71,5,122,8],"3817":[63,24,123,2],"3825":[63,24,123,2],"3833":[63,24,123,2],"3841":[63,24,123,2],"3849":[63,24,123,2],"3857":[63,24,123,2],"3865":[63,24,123,2],"3873":[63,24,123,2],"3881":[63,24,123,2],"3889":[63,24,123,2],"3897":[63,24,123,2],"3905":[63,24,123,2],"3913":[63,24,123,2],"3921":[125,17,125,22],"3929":[125,17,125,22],"3937":[125,17,125,22],"3945":[126,18,126,19],"3953":[126,18,126,19],"3961":[126,18,126,19],"3969":[126,21,126,22],"3977":[126,25,126,34],"3985":[126,25,126,41],"4001":[126,43,126,44],"4009":[126,43,126,46],"4025":[127,13,127,22],"4033":[127,23,127,24],"4041":[127,13,127,25],"4049":[127,32,127,39],"4057":[127,13,127,40],"4059":[127,13,127,31],"4065":[128,21,128,25],"4073":[128,21,128,25],"4081":[128,13,128,26],"4089":[132,10,132,15],"4097":[133,9,133,18],"4105":[133,24,133,31],"4113":[133,9,133,32],"4115":[133,9,133,23],"4121":[133,9,133,33],"4129":[124,22,134,2],"4137":[124,22,134,2],"4145":[124,22,134,2],"4153":[124,22,134,2],"4161":[124,22,134,2],"4169":[124,22,134,2],"4177":[124,22,134,2],"4185":[124,22,134,2],"4193":[124,22,134,2],"4201":[135,1,135,5],"4209":[135,1,135,15],"4217":[136,17,136,21],"4225":[136,17,136,31],"4233":[136,17,136,38],"4241":[136,17,136,38],"4249":[136,17,136,38],"4257":[137,9,137,14],"4265":[137,18,137,19],"4273":[138,16,138,24],"4281":[138,25,138,29],"4289":[138,31,138,35],"4297":[138,16,138,36],"4305":[138,16,138,36],"4313":[138,9,138,37],"4321":[139,18,139,19],"4329":[139,18,139,19],"4337":[139,18,139,19],"4345":[139,21,139,22],"4353":[139,25,139,29],"4361":[139,25,139,39],"4369":[139,25,139,46],"4385":[139,48,139,49],"4393":[139,48,139,51],"4409":[140,9,140,13],"4417":[140,19,140,25],"4425":[140,27,140,31],"4433":[140,33,140,37],"4441":[140,33,140,47],"4449":[140,48,140,49],"4457":[140,33,140,50],"4465":[140,33,140,53],"4473":[140,55,140,59],"4481":[140,55,140,69],"4489":[140,70,140,71],"4497":[140,55,140,72],"4505":[140,55,140,81],"4513":[140,83,140,87],"4521":[140,83,140,97],"4529":[140,98,140,99],"4537":[140,83,140,100],"4545":[140,83,140,109],"4553":[140,111,140,115],"4561":[140,111,140,125],"4569":[140,126,140,127],"4577":[140,111,140,128],"4585":[140,111,140,136],"4593":[141,21,141,26],"4601":[141,29,141,30],"4609":[141,21,141,30],"4617":[141,13,141,31],"4625":[142,17,142,22],"4633":[142,26,142,27],"4641":[143,17,143,25],"4649":[143,26,143,30],"4657":[143,32,143,36],"4665":[143,17,143,37],"4673":[143,17,143,38],"4681":[140,138,145,10],"4689":[140,138,145,10],"4697":[140,138,145,10],"4705":[140,138,145,10],"4713":[140,138,145,10],"4721":[140,9,145,11],"4723":[140,9,140,18],"4729":[140,9,145,12],"4737":[135,33,147,2],"4745":[135,33,147,2],"4753":[135,33,147,2],"4761":[135,33,147,2],"4769":[135,33,147,2],"4777":[135,33,147,2],"4785":[135,33,147,2],"4793":[135,33,147,2],"4801":[135,1,147,2],"4809":[135,1,147,3],"4817":[148,1,148,7],"4825":[148,18,148,22],"4833":[148,1,148,22],"4841":[148,1,148,23],"4849":[1,1,148,23],"4857":[1,1,148,23],"4865":[1,1,148,23],"4873":[1,1,148,23],"4881":[1,1,148,23],"4889":[1,1,148,23],"4897":[1,1,148,23],"4905":[1,1,148,23],"4913":[1,1,148,23],"4921":[1,1,148,23],"4929":[1,1,148,23],"4937":[1,1,148,23],"4945":[5,19,10,2],"4953":[5,19,10,2],"4961":[11,31,13,2],"4969":[11,31,13,2],"4977":[21,12,23,2],"4985":[21,12,23,2],"4993":[26,5,27,73],"5001":[31,5,32,37],"5009":[44,24,49,18],"5017":[42,24,49,18],"5025":[40,17,49,18],"5033":[54,21,55,97],"5041":[53,24,57,18],"5049":[50,17,57,18],"5057":[38,89,58,14],"5065":[38,89,58,14],"5073":[37,23,59,10],"5081":[37,23,59,10],"5089":[36,5,61,6],"5097":[24,23,62,2],"5105":[24,23,62,2],"5113":[72,9,73,41],"5121":[76,13,77,38],"5129":[79,17,80,42],"5137":[87,21,88,53],"5145":[91,25,92,50],"5153":[99,29,100,61],"5161":[109,37,110,69],"5169":[112,37,113,69],"5177":[108,103,115,34],"5185":[108,103,115,34],"5193":[102,72,116,30],"5201":[102,72,116,30],"5209":[98,95,117,26],"5217":[98,95,117,26],"5225":[90,64,118,22],"5233":[90,64,118,22],"5241":[86,87,119,18],"5249":[86,87,119,18],"5257":[78,56,120,14],"5265":[78,56,120,14],"5273":[75,53,121,10],"5281":[75,53,121,10],"5289":[71,75,122,6],"5297":[71,75,122,6],"5305":[63,24,123,2],"5313":[63,24,123,2],"5321":[127,9,130,10],"5329":[126,5,131,6],"5337":[126,5,131,6],"5345":[132,5,133,33],"5353":[124,22,134,2],"5361":[124,22,134,2],"5369":[137,5,138,37],"5377":[142,13,144,14],"5385":[140,138,145,10],"5393":[140,138,145,10],"5401":[139,5,146,6],"5409":[139,5,146,6],"5417":[135,33,147,2],"5425":[135,33,147,2],"5433":[1,1,148,23],"5441":[1,1,148,23],"nBranches":62,"originalCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongoose/node_modules/mongodb/node_modules/mongodb-core/lib/auth/sspi.js","instrumentedCodeFileName":"/home/blake/ExpoSE/Targets/harvesterjs/node_modules/harvesterjs/node_modules/mongoose/node_modules/mongodb/node_modules/mongodb-core/lib/auth/sspi_jalangi_.js","code":"\"use strict\";\n\nvar f = require('util').format\n  , crypto = require('crypto')\n  , MongoError = require('../error');\n\nvar AuthSession = function(db, username, password, options) {\n  this.db = db;\n  this.username = username;\n  this.password = password;\n  this.options = options;\n}\n\nAuthSession.prototype.equal = function(session) {\n  return session.db == this.db \n    && session.username == this.username\n    && session.password == this.password;\n}\n\n// Kerberos class\nvar Kerberos = null;\nvar MongoAuthProcess = null;\n\n// Try to grab the Kerberos class\ntry {\n  Kerberos = require('kerberos').Kerberos\n  // Authentication process for Mongo\n  MongoAuthProcess = require('kerberos').processes.MongoAuthProcess\n} catch(err) {}\n\n/**\n * Creates a new SSPI authentication mechanism\n * @class\n * @return {SSPI} A cursor instance\n */\nvar SSPI = function() {\n  this.authStore = [];\n}\n\n/**\n * Authenticate\n * @method\n * @param {{Server}|{ReplSet}|{Mongos}} server Topology the authentication method is being called on\n * @param {Pool} pool Connection pool for this topology\n * @param {string} db Name of the database\n * @param {string} username Username\n * @param {string} password Password\n * @param {authResultCallback} callback The callback to return the result from the authentication\n * @return {object}\n */\nSSPI.prototype.auth = function(server, pool, db, username, password, options, callback) {\n  var self = this;\n  // We don't have the Kerberos library\n  if(Kerberos == null) return callback(new Error(\"Kerberos library is not installed\"));  \n  var gssapiServiceName = options['gssapiServiceName'] || 'mongodb';\n  // Get all the connections\n  var connections = pool.getAll();\n  // Total connections\n  var count = connections.length;\n  if(count == 0) return callback(null, null);\n\n  // Valid connections\n  var numberOfValidConnections = 0;\n  var credentialsValid = false;\n  var errorObject = null;\n\n  // For each connection we need to authenticate\n  while(connections.length > 0) {    \n    // Execute MongoCR\n    var execute = function(connection) {\n      // Start Auth process for a connection\n      SSIPAuthenticate(username, password, gssapiServiceName, server, connection, function(err, r) {\n        // Adjust count\n        count = count - 1;\n\n        // If we have an error\n        if(err) {\n          errorObject = err;\n        } else if(r && typeof r == 'object' && r.result['$err']) {\n          errorObject = r.result;\n        } else if(r && typeof r == 'object' && r.result['errmsg']) {\n          errorObject = r.result;\n        } else {\n          credentialsValid = true;\n          numberOfValidConnections = numberOfValidConnections + 1;\n        }\n\n        // We have authenticated all connections\n        if(count == 0 && numberOfValidConnections > 0) {\n          // Store the auth details\n          addAuthSession(self.authStore, new AuthSession(db, username, password, options));\n          // Return correct authentication\n          callback(null, true);\n        } else if(count == 0) {\n          if(errorObject == null) errorObject = new MongoError(f(\"failed to authenticate using mongocr\"));\n          callback(errorObject, false);\n        }\n      });\n    }\n\n    // Get the connection\n    execute(connections.shift());\n  }\n}\n\nvar SSIPAuthenticate = function(username, password, gssapiServiceName, server, connection, callback) {\n  // Build Authentication command to send to MongoDB\n  var command = {\n      saslStart: 1\n    , mechanism: 'GSSAPI'\n    , payload: ''\n    , autoAuthorize: 1\n  };\n\n  // Create authenticator\n  var mongo_auth_process = new MongoAuthProcess(connection.host, connection.port, gssapiServiceName);\n\n  // Execute first sasl step\n  server.command(\"$external.$cmd\"\n    , command\n    , { connection: connection }, function(err, r) {\n    if(err) return callback(err, false);    \n    var doc = r.result;\n\n    mongo_auth_process.init(username, password, function(err) {\n      if(err) return callback(err);\n\n      mongo_auth_process.transition(doc.payload, function(err, payload) {\n        if(err) return callback(err);\n\n        // Perform the next step against mongod\n        var command = {\n            saslContinue: 1\n          , conversationId: doc.conversationId\n          , payload: payload\n        };\n\n        // Execute the command\n        server.command(\"$external.$cmd\"\n          , command\n          , { connection: connection }, function(err, r) {\n          if(err) return callback(err, false);\n          var doc = r.result;\n\n          mongo_auth_process.transition(doc.payload, function(err, payload) {\n            if(err) return callback(err);\n\n            // Perform the next step against mongod\n            var command = {\n                saslContinue: 1\n              , conversationId: doc.conversationId\n              , payload: payload\n            };\n\n            // Execute the command\n            server.command(\"$external.$cmd\"\n              , command\n              , { connection: connection }, function(err, r) {\n              if(err) return callback(err, false);\n              var doc = r.result;\n              \n              mongo_auth_process.transition(doc.payload, function(err, payload) {\n                // Perform the next step against mongod\n                var command = {\n                    saslContinue: 1\n                  , conversationId: doc.conversationId\n                  , payload: payload\n                };\n\n                // Execute the command\n                server.command(\"$external.$cmd\"\n                  , command\n                  , { connection: connection }, function(err, r) {\n                  if(err) return callback(err, false);\n                  var doc = r.result;\n\n                  if(doc.done) return callback(null, true);\n                  callback(new Error(\"Authentication failed\"), false);\n                });        \n              });\n            });\n          });\n        });\n      });\n    });\n  });  \n}\n\n// Add to store only if it does not exist\nvar addAuthSession = function(authStore, session) {\n  var found = false;\n\n  for(var i = 0; i < authStore.length; i++) {\n    if(authStore[i].equal(session)) {\n      found = true;\n      break;\n    }\n  }\n\n  if(!found) authStore.push(session);\n}\n\n/**\n * Re authenticate pool\n * @method\n * @param {{Server}|{ReplSet}|{Mongos}} server Topology the authentication method is being called on\n * @param {Pool} pool Connection pool for this topology\n * @param {authResultCallback} callback The callback to return the result from the authentication\n * @return {object}\n */\nSSPI.prototype.reauthenticate = function(server, pool, callback) {\n  var count = this.authStore.length;\n  if(count == 0) return callback(null, null);\n  // Iterate over all the auth details stored\n  for(var i = 0; i < this.authStore.length; i++) {\n    this.auth(server, pool, this.authStore[i].db, this.authStore[i].username, this.authStore[i].password, this.authStore[i].options, function(err, r) {\n      count = count - 1;\n      // Done re-authenticating\n      if(count == 0) {\n        callback(null, null);\n      }\n    });\n  }\n}\n\n/**\n * This is a result from a authentication strategy\n *\n * @callback authResultCallback\n * @param {error} error An error object. Set to null if no error present\n * @param {boolean} result The result of the authentication process\n */\n\nmodule.exports = SSPI;"}